{"remainingRequest":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\component\\print.js","dependencies":[{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\component\\print.js","mtime":1616639586808},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616639573358},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1616639572994},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js","mtime":1616639576682}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJDOi9Vc2Vycy9cdTU0MzRcdTVFRkFcdTY2MEUvRGVza3RvcC9WaXN1YWxpemF0aW9uRXhjbGVfRGVtby9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIkM6L1VzZXJzL1x1NTQzNFx1NUVGQVx1NjYwRS9EZXNrdG9wL1Zpc3VhbGl6YXRpb25FeGNsZV9EZW1vL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiQzovVXNlcnMvXHU1NDM0XHU1RUZBXHU2NjBFL0Rlc2t0b3AvVmlzdWFsaXphdGlvbkV4Y2xlX0RlbW8vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CgovKiBnbG9iYWwgd2luZG93IGRvY3VtZW50ICovCmltcG9ydCB7IGggfSBmcm9tICcuL2VsZW1lbnQnOwppbXBvcnQgeyBjc3NQcmVmaXggfSBmcm9tICcuLi9jb25maWcnOwppbXBvcnQgQnV0dG9uIGZyb20gJy4vYnV0dG9uJzsKaW1wb3J0IHsgRHJhdyB9IGZyb20gJy4uL2NhbnZhcy9kcmF3JzsKaW1wb3J0IHsgcmVuZGVyQ2VsbCB9IGZyb20gJy4vdGFibGUnOwppbXBvcnQgeyB0IH0gZnJvbSAnLi4vbG9jYWxlL2xvY2FsZSc7IC8vIHJlc29sdXRpb246IDcyID0+IDU5NSB4IDg0MgovLyAxNTAgPT4gMTI0MCB4IDE3NTQKLy8gMjAwID0+IDE2NTQgeCAyMzM5Ci8vIDMwMCA9PiAyNDc5IHggMzUwOAovLyA5NiAqIGNtIC8gMi41NCAsIDk2ICogY20gLyAyLjU0Cgp2YXIgUEFHRVJfU0laRVMgPSBbWydBMycsIDExLjY5LCAxNi41NF0sIFsnQTQnLCA4LjI3LCAxMS42OV0sIFsnQTUnLCA1LjgzLCA4LjI3XSwgWydCNCcsIDkuODQsIDEzLjkwXSwgWydCNScsIDYuOTMsIDkuODRdXTsKdmFyIFBBR0VSX09SSUVOVEFUSU9OUyA9IFsnbGFuZHNjYXBlJywgJ3BvcnRyYWl0J107CgpmdW5jdGlvbiBpbmNoZXMycHgoaW5jKSB7CiAgcmV0dXJuIHBhcnNlSW50KDk2ICogaW5jLCAxMCk7Cn0KCmZ1bmN0aW9uIGJ0bkNsaWNrKHR5cGUpIHsKICBpZiAodHlwZSA9PT0gJ2NhbmNlbCcpIHsKICAgIHRoaXMuZWwuaGlkZSgpOwogIH0gZWxzZSB7CiAgICB0aGlzLnRvUHJpbnQoKTsKICB9Cn0KCmZ1bmN0aW9uIHBhZ2VyU2l6ZUNoYW5nZShldnQpIHsKICB2YXIgcGFwZXIgPSB0aGlzLnBhcGVyOwogIHZhciB2YWx1ZSA9IGV2dC50YXJnZXQudmFsdWU7CiAgdmFyIHBzID0gUEFHRVJfU0laRVNbdmFsdWVdOwogIHBhcGVyLncgPSBpbmNoZXMycHgocHNbMV0pOwogIHBhcGVyLmggPSBpbmNoZXMycHgocHNbMl0pOyAvLyBjb25zb2xlLmxvZygncGFwZXI6JywgcHMsIHBhcGVyKTsKCiAgdGhpcy5wcmV2aWV3KCk7Cn0KCmZ1bmN0aW9uIHBhZ2VyT3JpZW50YXRpb25DaGFuZ2UoZXZ0KSB7CiAgdmFyIHBhcGVyID0gdGhpcy5wYXBlcjsKICB2YXIgdmFsdWUgPSBldnQudGFyZ2V0LnZhbHVlOwogIHZhciB2ID0gUEFHRVJfT1JJRU5UQVRJT05TW3ZhbHVlXTsKICBwYXBlci5vcmllbnRhdGlvbiA9IHY7CiAgdGhpcy5wcmV2aWV3KCk7Cn0KCnZhciBQcmludCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gUHJpbnQoZGF0YSkgewogICAgdmFyIF9oLCBfaDI7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFByaW50KTsKCiAgICB0aGlzLnBhcGVyID0gewogICAgICB3OiBpbmNoZXMycHgoUEFHRVJfU0laRVNbMF1bMV0pLAogICAgICBoOiBpbmNoZXMycHgoUEFHRVJfU0laRVNbMF1bMl0pLAogICAgICBwYWRkaW5nOiA1MCwKICAgICAgb3JpZW50YXRpb246IFBBR0VSX09SSUVOVEFUSU9OU1swXSwKCiAgICAgIGdldCB3aWR0aCgpIHsKICAgICAgICByZXR1cm4gdGhpcy5vcmllbnRhdGlvbiA9PT0gJ2xhbmRzY2FwZScgPyB0aGlzLmggOiB0aGlzLnc7CiAgICAgIH0sCgogICAgICBnZXQgaGVpZ2h0KCkgewogICAgICAgIHJldHVybiB0aGlzLm9yaWVudGF0aW9uID09PSAnbGFuZHNjYXBlJyA/IHRoaXMudyA6IHRoaXMuaDsKICAgICAgfQoKICAgIH07CiAgICB0aGlzLmRhdGEgPSBkYXRhOwogICAgdGhpcy5lbCA9IGgoJ2RpdicsICIiLmNvbmNhdChjc3NQcmVmaXgsICItcHJpbnQiKSkuY2hpbGRyZW4oaCgnZGl2JywgIiIuY29uY2F0KGNzc1ByZWZpeCwgIi1wcmludC1iYXIiKSkuY2hpbGRyZW4oaCgnZGl2JywgJy10aXRsZScpLmNoaWxkKCdQcmludCBzZXR0aW5ncycpLCBoKCdkaXYnLCAnLXJpZ2h0JykuY2hpbGRyZW4oaCgnZGl2JywgIiIuY29uY2F0KGNzc1ByZWZpeCwgIi1idXR0b25zIikpLmNoaWxkcmVuKG5ldyBCdXR0b24oJ2NhbmNlbCcpLm9uKCdjbGljaycsIGJ0bkNsaWNrLmJpbmQodGhpcywgJ2NhbmNlbCcpKSwgbmV3IEJ1dHRvbignbmV4dCcsICdwcmltYXJ5Jykub24oJ2NsaWNrJywgYnRuQ2xpY2suYmluZCh0aGlzLCAnbmV4dCcpKSkpKSwgaCgnZGl2JywgIiIuY29uY2F0KGNzc1ByZWZpeCwgIi1wcmludC1jb250ZW50IikpLmNoaWxkcmVuKHRoaXMuY29udGVudEVsID0gaCgnZGl2JywgJy1jb250ZW50JyksIGgoJ2RpdicsICctc2lkZXInKS5jaGlsZChoKCdmb3JtJywgJycpLmNoaWxkcmVuKGgoJ2ZpZWxkc2V0JywgJycpLmNoaWxkcmVuKGgoJ2xhYmVsJywgJycpLmNoaWxkKCIiLmNvbmNhdCh0KCdwcmludC5zaXplJykpKSwgKF9oID0gaCgnc2VsZWN0JywgJycpKS5jaGlsZHJlbi5hcHBseShfaCwgX3RvQ29uc3VtYWJsZUFycmF5KFBBR0VSX1NJWkVTLm1hcChmdW5jdGlvbiAoaXQsIGluZGV4KSB7CiAgICAgIHJldHVybiBoKCdvcHRpb24nLCAnJykuYXR0cigndmFsdWUnLCBpbmRleCkuY2hpbGQoIiIuY29uY2F0KGl0WzBdLCAiICggIikuY29uY2F0KGl0WzFdLCAiJyd4IikuY29uY2F0KGl0WzJdLCAiJycgKSIpKTsKICAgIH0pKSkub24oJ2NoYW5nZScsIHBhZ2VyU2l6ZUNoYW5nZS5iaW5kKHRoaXMpKSksIGgoJ2ZpZWxkc2V0JywgJycpLmNoaWxkcmVuKGgoJ2xhYmVsJywgJycpLmNoaWxkKCIiLmNvbmNhdCh0KCdwcmludC5vcmllbnRhdGlvbicpKSksIChfaDIgPSBoKCdzZWxlY3QnLCAnJykpLmNoaWxkcmVuLmFwcGx5KF9oMiwgX3RvQ29uc3VtYWJsZUFycmF5KFBBR0VSX09SSUVOVEFUSU9OUy5tYXAoZnVuY3Rpb24gKGl0LCBpbmRleCkgewogICAgICByZXR1cm4gaCgnb3B0aW9uJywgJycpLmF0dHIoJ3ZhbHVlJywgaW5kZXgpLmNoaWxkKCIiLmNvbmNhdCh0KCdwcmludC5vcmllbnRhdGlvbnMnKVtpbmRleF0pKTsKICAgIH0pKSkub24oJ2NoYW5nZScsIHBhZ2VyT3JpZW50YXRpb25DaGFuZ2UuYmluZCh0aGlzKSkpKSkpKS5oaWRlKCk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoUHJpbnQsIFt7CiAgICBrZXk6ICJyZXNldERhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2V0RGF0YShkYXRhKSB7CiAgICAgIHRoaXMuZGF0YSA9IGRhdGE7CiAgICB9CiAgfSwgewogICAga2V5OiAicHJldmlldyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcHJldmlldygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBkYXRhID0gdGhpcy5kYXRhLAogICAgICAgICAgcGFwZXIgPSB0aGlzLnBhcGVyOwogICAgICB2YXIgd2lkdGggPSBwYXBlci53aWR0aCwKICAgICAgICAgIGhlaWdodCA9IHBhcGVyLmhlaWdodCwKICAgICAgICAgIHBhZGRpbmcgPSBwYXBlci5wYWRkaW5nOwogICAgICB2YXIgaXdpZHRoID0gd2lkdGggLSBwYWRkaW5nICogMjsKICAgICAgdmFyIGloZWlnaHQgPSBoZWlnaHQgLSBwYWRkaW5nICogMjsKICAgICAgdmFyIGNyID0gZGF0YS5jb250ZW50UmFuZ2UoKTsKICAgICAgdmFyIHBhZ2VzID0gcGFyc2VJbnQoY3IuaCAvIGloZWlnaHQsIDEwKSArIDE7CiAgICAgIHZhciBzY2FsZSA9IGl3aWR0aCAvIGNyLnc7CiAgICAgIHZhciBsZWZ0ID0gcGFkZGluZzsKICAgICAgdmFyIHRvcCA9IHBhZGRpbmc7CgogICAgICBpZiAoc2NhbGUgPiAxKSB7CiAgICAgICAgbGVmdCArPSAoaXdpZHRoIC0gY3IudykgLyAyOwogICAgICB9CgogICAgICB2YXIgcmkgPSAwOwogICAgICB2YXIgeW9mZnNldCA9IDA7CiAgICAgIHRoaXMuY29udGVudEVsLmh0bWwoJycpOwogICAgICB0aGlzLmNhbnZhc2VzID0gW107CiAgICAgIHZhciBtVmlld1JhbmdlID0gewogICAgICAgIHNyaTogMCwKICAgICAgICBzY2k6IDAsCiAgICAgICAgZXJpOiAwLAogICAgICAgIGVjaTogMAogICAgICB9OwoKICAgICAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoaSkgewogICAgICAgIHZhciB0aCA9IDA7CiAgICAgICAgdmFyIHlvID0gMDsKICAgICAgICB2YXIgd3JhcCA9IGgoJ2RpdicsICIiLmNvbmNhdChjc3NQcmVmaXgsICItY2FudmFzLWNhcmQiKSk7CiAgICAgICAgdmFyIGNhbnZhcyA9IGgoJ2NhbnZhcycsICIiLmNvbmNhdChjc3NQcmVmaXgsICItY2FudmFzIikpOwoKICAgICAgICBfdGhpcy5jYW52YXNlcy5wdXNoKGNhbnZhcy5lbCk7CgogICAgICAgIHZhciBkcmF3ID0gbmV3IERyYXcoY2FudmFzLmVsLCB3aWR0aCwgaGVpZ2h0KTsgLy8gY2VsbC1jb250ZW50CgogICAgICAgIGRyYXcuc2F2ZSgpOwogICAgICAgIGRyYXcudHJhbnNsYXRlKGxlZnQsIHRvcCk7CiAgICAgICAgaWYgKHNjYWxlIDwgMSkgZHJhdy5zY2FsZShzY2FsZSwgc2NhbGUpOyAvLyBjb25zb2xlLmxvZygncmk6JywgcmksIGNyLmVyaSwgeW9mZnNldCk7CgogICAgICAgIGZvciAoOyByaSA8PSBjci5lcmk7IHJpICs9IDEpIHsKICAgICAgICAgIHZhciByaCA9IGRhdGEucm93cy5nZXRIZWlnaHQocmkpOwogICAgICAgICAgdGggKz0gcmg7CgogICAgICAgICAgaWYgKHRoIDwgaWhlaWdodCkgewogICAgICAgICAgICBmb3IgKHZhciBjaSA9IDA7IGNpIDw9IGNyLmVjaTsgY2kgKz0gMSkgewogICAgICAgICAgICAgIHJlbmRlckNlbGwoZHJhdywgZGF0YSwgcmksIGNpLCB5b2Zmc2V0KTsKICAgICAgICAgICAgICBtVmlld1JhbmdlLmVjaSA9IGNpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB5byA9IC0odGggLSByaCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgbVZpZXdSYW5nZS5lcmkgPSByaTsKICAgICAgICBkcmF3LnJlc3RvcmUoKTsgLy8gbWVyZ2UtY2VsbAoKICAgICAgICBkcmF3LnNhdmUoKTsKICAgICAgICBkcmF3LnRyYW5zbGF0ZShsZWZ0LCB0b3ApOwogICAgICAgIGlmIChzY2FsZSA8IDEpIGRyYXcuc2NhbGUoc2NhbGUsIHNjYWxlKTsKICAgICAgICB2YXIgeW9mID0geW9mZnNldDsKICAgICAgICBkYXRhLmVhY2hNZXJnZXNJblZpZXcobVZpZXdSYW5nZSwgZnVuY3Rpb24gKF9yZWYpIHsKICAgICAgICAgIHZhciBzcmkgPSBfcmVmLnNyaSwKICAgICAgICAgICAgICBzY2kgPSBfcmVmLnNjaTsKICAgICAgICAgIHJlbmRlckNlbGwoZHJhdywgZGF0YSwgc3JpLCBzY2ksIHlvZik7CiAgICAgICAgfSk7CiAgICAgICAgZHJhdy5yZXN0b3JlKCk7CiAgICAgICAgbVZpZXdSYW5nZS5zcmkgPSBtVmlld1JhbmdlLmVyaTsKICAgICAgICBtVmlld1JhbmdlLnNjaSA9IG1WaWV3UmFuZ2UuZWNpOwogICAgICAgIHlvZmZzZXQgKz0geW87CgogICAgICAgIF90aGlzLmNvbnRlbnRFbC5jaGlsZChoKCdkaXYnLCAiIi5jb25jYXQoY3NzUHJlZml4LCAiLWNhbnZhcy1jYXJkLXdyYXBlciIpKS5jaGlsZCh3cmFwLmNoaWxkKGNhbnZhcykpKTsKICAgICAgfTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFnZXM7IGkgKz0gMSkgewogICAgICAgIF9sb29wKGkpOwogICAgICB9CgogICAgICB0aGlzLmVsLnNob3coKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ0b1ByaW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0b1ByaW50KCkgewogICAgICB0aGlzLmVsLmhpZGUoKTsKICAgICAgdmFyIHBhcGVyID0gdGhpcy5wYXBlcjsKICAgICAgdmFyIGlmcmFtZSA9IGgoJ2lmcmFtZScsICcnKS5oaWRlKCk7CiAgICAgIHZhciBlbCA9IGlmcmFtZS5lbDsKICAgICAgd2luZG93LmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWwpOwogICAgICB2YXIgY29udGVudFdpbmRvdyA9IGVsLmNvbnRlbnRXaW5kb3c7CiAgICAgIHZhciBpZG9jID0gY29udGVudFdpbmRvdy5kb2N1bWVudDsKICAgICAgdmFyIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICAgICAgc3R5bGUuaW5uZXJIVE1MID0gIlxuICAgICAgQHBhZ2UgeyBzaXplOiAiLmNvbmNhdChwYXBlci53aWR0aCwgInB4ICIpLmNvbmNhdChwYXBlci5oZWlnaHQsICJweDsgfTtcbiAgICAgIGNhbnZhcyB7XG4gICAgICAgIHBhZ2UtYnJlYWstYmVmb3JlOiBhdXRvOyAgICAgICAgXG4gICAgICAgIHBhZ2UtYnJlYWstYWZ0ZXI6IGFsd2F5cztcbiAgICAgICAgaW1hZ2UtcmVuZGVyaW5nOiBwaXhlbGF0ZWQ7XG4gICAgICB9O1xuICAgICIpOwogICAgICBpZG9jLmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpOwogICAgICB0aGlzLmNhbnZhc2VzLmZvckVhY2goZnVuY3Rpb24gKGl0KSB7CiAgICAgICAgdmFyIGNuID0gaXQuY2xvbmVOb2RlKGZhbHNlKTsKICAgICAgICB2YXIgY3R4ID0gY24uZ2V0Q29udGV4dCgnMmQnKTsgLy8gY3R4LmltYWdlU21vb3RoaW5nRW5hYmxlZCA9IHRydWU7CgogICAgICAgIGN0eC5kcmF3SW1hZ2UoaXQsIDAsIDApOwogICAgICAgIGlkb2MuYm9keS5hcHBlbmRDaGlsZChjbik7CiAgICAgIH0pOwogICAgICBjb250ZW50V2luZG93LnByaW50KCk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gUHJpbnQ7Cn0oKTsKCmV4cG9ydCB7IFByaW50IGFzIGRlZmF1bHQgfTs="},{"version":3,"sources":["C:/Users/吴建明/Desktop/VisualizationExcle_Demo/src/components/x-spreadsheet/component/print.js"],"names":["h","cssPrefix","Button","Draw","renderCell","t","PAGER_SIZES","PAGER_ORIENTATIONS","inches2px","inc","parseInt","btnClick","type","el","hide","toPrint","pagerSizeChange","evt","paper","value","target","ps","w","preview","pagerOrientationChange","v","orientation","Print","data","padding","width","height","children","child","on","bind","contentEl","map","it","index","attr","iwidth","iheight","cr","contentRange","pages","scale","left","top","ri","yoffset","html","canvases","mViewRange","sri","sci","eri","eci","i","th","yo","wrap","canvas","push","draw","save","translate","rh","rows","getHeight","ci","restore","yof","eachMergesInView","show","iframe","window","document","body","appendChild","contentWindow","idoc","style","createElement","innerHTML","head","forEach","cn","cloneNode","ctx","getContext","drawImage","print"],"mappings":"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","sourcesContent":["/* global window document */\r\nimport { h } from './element';\r\nimport { cssPrefix } from '../config';\r\nimport Button from './button';\r\nimport { Draw } from '../canvas/draw';\r\nimport { renderCell } from './table';\r\nimport { t } from '../locale/locale';\r\n\r\n// resolution: 72 => 595 x 842\r\n// 150 => 1240 x 1754\r\n// 200 => 1654 x 2339\r\n// 300 => 2479 x 3508\r\n// 96 * cm / 2.54 , 96 * cm / 2.54\r\n\r\nconst PAGER_SIZES = [\r\n  ['A3', 11.69, 16.54],\r\n  ['A4', 8.27, 11.69],\r\n  ['A5', 5.83, 8.27],\r\n  ['B4', 9.84, 13.90],\r\n  ['B5', 6.93, 9.84],\r\n];\r\n\r\nconst PAGER_ORIENTATIONS = ['landscape', 'portrait'];\r\n\r\nfunction inches2px(inc) {\r\n  return parseInt(96 * inc, 10);\r\n}\r\n\r\nfunction btnClick(type) {\r\n  if (type === 'cancel') {\r\n    this.el.hide();\r\n  } else {\r\n    this.toPrint();\r\n  }\r\n}\r\n\r\nfunction pagerSizeChange(evt) {\r\n  const { paper } = this;\r\n  const { value } = evt.target;\r\n  const ps = PAGER_SIZES[value];\r\n  paper.w = inches2px(ps[1]);\r\n  paper.h = inches2px(ps[2]);\r\n  // console.log('paper:', ps, paper);\r\n  this.preview();\r\n}\r\nfunction pagerOrientationChange(evt) {\r\n  const { paper } = this;\r\n  const { value } = evt.target;\r\n  const v = PAGER_ORIENTATIONS[value];\r\n  paper.orientation = v;\r\n  this.preview();\r\n}\r\n\r\nexport default class Print {\r\n  constructor(data) {\r\n    this.paper = {\r\n      w: inches2px(PAGER_SIZES[0][1]),\r\n      h: inches2px(PAGER_SIZES[0][2]),\r\n      padding: 50,\r\n      orientation: PAGER_ORIENTATIONS[0],\r\n      get width() {\r\n        return this.orientation === 'landscape' ? this.h : this.w;\r\n      },\r\n      get height() {\r\n        return this.orientation === 'landscape' ? this.w : this.h;\r\n      },\r\n    };\r\n    this.data = data;\r\n    this.el = h('div', `${cssPrefix}-print`)\r\n      .children(\r\n        h('div', `${cssPrefix}-print-bar`)\r\n          .children(\r\n            h('div', '-title').child('Print settings'),\r\n            h('div', '-right').children(\r\n              h('div', `${cssPrefix}-buttons`).children(\r\n                new Button('cancel').on('click', btnClick.bind(this, 'cancel')),\r\n                new Button('next', 'primary').on('click', btnClick.bind(this, 'next')),\r\n              ),\r\n            ),\r\n          ),\r\n        h('div', `${cssPrefix}-print-content`)\r\n          .children(\r\n            this.contentEl = h('div', '-content'),\r\n            h('div', '-sider').child(\r\n              h('form', '').children(\r\n                h('fieldset', '').children(\r\n                  h('label', '').child(`${t('print.size')}`),\r\n                  h('select', '').children(\r\n                    ...PAGER_SIZES.map((it, index) => h('option', '').attr('value', index).child(`${it[0]} ( ${it[1]}''x${it[2]}'' )`)),\r\n                  ).on('change', pagerSizeChange.bind(this)),\r\n                ),\r\n                h('fieldset', '').children(\r\n                  h('label', '').child(`${t('print.orientation')}`),\r\n                  h('select', '').children(\r\n                    ...PAGER_ORIENTATIONS.map((it, index) => h('option', '').attr('value', index).child(`${t('print.orientations')[index]}`)),\r\n                  ).on('change', pagerOrientationChange.bind(this)),\r\n                ),\r\n              ),\r\n            ),\r\n          ),\r\n      ).hide();\r\n  }\r\n\r\n  resetData(data) {\r\n    this.data = data;\r\n  }\r\n\r\n  preview() {\r\n    const { data, paper } = this;\r\n    const { width, height, padding } = paper;\r\n    const iwidth = width - padding * 2;\r\n    const iheight = height - padding * 2;\r\n    const cr = data.contentRange();\r\n    const pages = parseInt(cr.h / iheight, 10) + 1;\r\n    const scale = iwidth / cr.w;\r\n    let left = padding;\r\n    const top = padding;\r\n    if (scale > 1) {\r\n      left += (iwidth - cr.w) / 2;\r\n    }\r\n    let ri = 0;\r\n    let yoffset = 0;\r\n    this.contentEl.html('');\r\n    this.canvases = [];\r\n    const mViewRange = {\r\n      sri: 0,\r\n      sci: 0,\r\n      eri: 0,\r\n      eci: 0,\r\n    };\r\n    for (let i = 0; i < pages; i += 1) {\r\n      let th = 0;\r\n      let yo = 0;\r\n      const wrap = h('div', `${cssPrefix}-canvas-card`);\r\n      const canvas = h('canvas', `${cssPrefix}-canvas`);\r\n      this.canvases.push(canvas.el);\r\n      const draw = new Draw(canvas.el, width, height);\r\n      // cell-content\r\n      draw.save();\r\n      draw.translate(left, top);\r\n      if (scale < 1) draw.scale(scale, scale);\r\n      // console.log('ri:', ri, cr.eri, yoffset);\r\n      for (; ri <= cr.eri; ri += 1) {\r\n        const rh = data.rows.getHeight(ri);\r\n        th += rh;\r\n        if (th < iheight) {\r\n          for (let ci = 0; ci <= cr.eci; ci += 1) {\r\n            renderCell(draw, data, ri, ci, yoffset);\r\n            mViewRange.eci = ci;\r\n          }\r\n        } else {\r\n          yo = -(th - rh);\r\n          break;\r\n        }\r\n      }\r\n      mViewRange.eri = ri;\r\n      draw.restore();\r\n      // merge-cell\r\n      draw.save();\r\n      draw.translate(left, top);\r\n      if (scale < 1) draw.scale(scale, scale);\r\n      const yof = yoffset;\r\n      data.eachMergesInView(mViewRange, ({ sri, sci }) => {\r\n        renderCell(draw, data, sri, sci, yof);\r\n      });\r\n      draw.restore();\r\n\r\n      mViewRange.sri = mViewRange.eri;\r\n      mViewRange.sci = mViewRange.eci;\r\n      yoffset += yo;\r\n      this.contentEl.child(h('div', `${cssPrefix}-canvas-card-wraper`).child(wrap.child(canvas)));\r\n    }\r\n    this.el.show();\r\n  }\r\n\r\n  toPrint() {\r\n    this.el.hide();\r\n    const { paper } = this;\r\n    const iframe = h('iframe', '').hide();\r\n    const { el } = iframe;\r\n    window.document.body.appendChild(el);\r\n    const { contentWindow } = el;\r\n    const idoc = contentWindow.document;\r\n    const style = document.createElement('style');\r\n    style.innerHTML = `\r\n      @page { size: ${paper.width}px ${paper.height}px; };\r\n      canvas {\r\n        page-break-before: auto;        \r\n        page-break-after: always;\r\n        image-rendering: pixelated;\r\n      };\r\n    `;\r\n    idoc.head.appendChild(style);\r\n    this.canvases.forEach((it) => {\r\n      const cn = it.cloneNode(false);\r\n      const ctx = cn.getContext('2d');\r\n      // ctx.imageSmoothingEnabled = true;\r\n      ctx.drawImage(it, 0, 0);\r\n      idoc.body.appendChild(cn);\r\n    });\r\n    contentWindow.print();\r\n  }\r\n}\r\n"]}]}