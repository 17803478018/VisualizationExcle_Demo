{"remainingRequest":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\component\\bottombar.js","dependencies":[{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\component\\bottombar.js","mtime":1616639586796},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616639573358},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1616639572994},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js","mtime":1616639576682}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIkM6L1VzZXJzL1x1NTQzNFx1NUVGQVx1NjYwRS9EZXNrdG9wL1Zpc3VhbGl6YXRpb25FeGNsZV9EZW1vL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9zbGljZWRUb0FycmF5IjsKaW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJDOi9Vc2Vycy9cdTU0MzRcdTVFRkFcdTY2MEUvRGVza3RvcC9WaXN1YWxpemF0aW9uRXhjbGVfRGVtby9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIkM6L1VzZXJzL1x1NTQzNFx1NUVGQVx1NjYwRS9EZXNrdG9wL1Zpc3VhbGl6YXRpb25FeGNsZV9EZW1vL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiQzovVXNlcnMvXHU1NDM0XHU1RUZBXHU2NjBFL0Rlc2t0b3AvVmlzdWFsaXphdGlvbkV4Y2xlX0RlbW8vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9pbmhlcml0cyBmcm9tICJDOi9Vc2Vycy9cdTU0MzRcdTVFRkFcdTY2MEUvRGVza3RvcC9WaXN1YWxpemF0aW9uRXhjbGVfRGVtby9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vaW5oZXJpdHMiOwppbXBvcnQgX2NyZWF0ZVN1cGVyIGZyb20gIkM6L1VzZXJzL1x1NTQzNFx1NUVGQVx1NjYwRS9EZXNrdG9wL1Zpc3VhbGl6YXRpb25FeGNsZV9EZW1vL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVTdXBlciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQtaW5kZXguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0IHsgaCB9IGZyb20gJy4vZWxlbWVudCc7CmltcG9ydCB7IGJpbmRDbGlja291dHNpZGUsIHVuYmluZENsaWNrb3V0c2lkZSB9IGZyb20gJy4vZXZlbnQnOwppbXBvcnQgeyBjc3NQcmVmaXggfSBmcm9tICcuLi9jb25maWcnOwppbXBvcnQgSWNvbiBmcm9tICcuL2ljb24nOwppbXBvcnQgRm9ybUlucHV0IGZyb20gJy4vZm9ybV9pbnB1dCc7CmltcG9ydCBEcm9wZG93biBmcm9tICcuL2Ryb3Bkb3duJzsKaW1wb3J0IHsgeHRvYXN0IH0gZnJvbSAnLi9tZXNzYWdlJzsKaW1wb3J0IHsgdGYgfSBmcm9tICcuLi9sb2NhbGUvbG9jYWxlJzsKCnZhciBEcm9wZG93bk1vcmUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Ecm9wZG93bikgewogIF9pbmhlcml0cyhEcm9wZG93bk1vcmUsIF9Ecm9wZG93bik7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoRHJvcGRvd25Nb3JlKTsKCiAgZnVuY3Rpb24gRHJvcGRvd25Nb3JlKGNsaWNrKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERyb3Bkb3duTW9yZSk7CgogICAgdmFyIGljb24gPSBuZXcgSWNvbignZWxsaXBzaXMnKTsKICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgaWNvbiwgJ2F1dG8nLCBmYWxzZSwgJ3RvcC1sZWZ0Jyk7CiAgICBfdGhpcy5jb250ZW50Q2xpY2sgPSBjbGljazsKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhEcm9wZG93bk1vcmUsIFt7CiAgICBrZXk6ICJyZXNldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzZXQoaXRlbXMpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgZWxlcyA9IGl0ZW1zLm1hcChmdW5jdGlvbiAoaXQsIGkpIHsKICAgICAgICByZXR1cm4gaCgnZGl2JywgIiIuY29uY2F0KGNzc1ByZWZpeCwgIi1pdGVtIikpLmNzcygnd2lkdGgnLCAnMTUwcHgnKS5jc3MoJ2ZvbnQtd2VpZ2h0JywgJ25vcm1hbCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzMi5jb250ZW50Q2xpY2soaSk7CgogICAgICAgICAgX3RoaXMyLmhpZGUoKTsKICAgICAgICB9KS5jaGlsZChpdCk7CiAgICAgIH0pOwogICAgICB0aGlzLnNldENvbnRlbnRDaGlsZHJlbi5hcHBseSh0aGlzLCBfdG9Db25zdW1hYmxlQXJyYXkoZWxlcykpOwogICAgfQogIH0sIHsKICAgIGtleTogInNldFRpdGxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRUaXRsZSgpIHt9CiAgfV0pOwoKICByZXR1cm4gRHJvcGRvd25Nb3JlOwp9KERyb3Bkb3duKTsKCnZhciBtZW51SXRlbXMgPSBbewogIGtleTogJ2RlbGV0ZScsCiAgdGl0bGU6IHRmKCdjb250ZXh0bWVudS5kZWxldGVTaGVldCcpCn1dOwoKZnVuY3Rpb24gYnVpbGRNZW51SXRlbShpdGVtKSB7CiAgdmFyIF90aGlzMyA9IHRoaXM7CgogIHJldHVybiBoKCdkaXYnLCAiIi5jb25jYXQoY3NzUHJlZml4LCAiLWl0ZW0iKSkuY2hpbGQoaXRlbS50aXRsZSgpKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICBfdGhpczMuaXRlbUNsaWNrKGl0ZW0ua2V5KTsKCiAgICBfdGhpczMuaGlkZSgpOwogIH0pOwp9CgpmdW5jdGlvbiBidWlsZE1lbnUoKSB7CiAgdmFyIF90aGlzNCA9IHRoaXM7CgogIHJldHVybiBtZW51SXRlbXMubWFwKGZ1bmN0aW9uIChpdCkgewogICAgcmV0dXJuIGJ1aWxkTWVudUl0ZW0uY2FsbChfdGhpczQsIGl0KTsKICB9KTsKfQoKdmFyIENvbnRleHRNZW51ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBDb250ZXh0TWVudSgpIHsKICAgIHZhciBfaCRjc3M7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENvbnRleHRNZW51KTsKCiAgICB0aGlzLmVsID0gKF9oJGNzcyA9IGgoJ2RpdicsICIiLmNvbmNhdChjc3NQcmVmaXgsICItY29udGV4dG1lbnUiKSkuY3NzKCd3aWR0aCcsICcxNjBweCcpKS5jaGlsZHJlbi5hcHBseShfaCRjc3MsIF90b0NvbnN1bWFibGVBcnJheShidWlsZE1lbnUuY2FsbCh0aGlzKSkpLmhpZGUoKTsKCiAgICB0aGlzLml0ZW1DbGljayA9IGZ1bmN0aW9uICgpIHt9OwogIH0KCiAgX2NyZWF0ZUNsYXNzKENvbnRleHRNZW51LCBbewogICAga2V5OiAiaGlkZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGlkZSgpIHsKICAgICAgdmFyIGVsID0gdGhpcy5lbDsKICAgICAgZWwuaGlkZSgpOwogICAgICB1bmJpbmRDbGlja291dHNpZGUoZWwpOwogICAgfQogIH0sIHsKICAgIGtleTogInNldE9mZnNldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0T2Zmc2V0KG9mZnNldCkgewogICAgICB2YXIgZWwgPSB0aGlzLmVsOwogICAgICBlbC5vZmZzZXQob2Zmc2V0KTsKICAgICAgZWwuc2hvdygpOwogICAgICBiaW5kQ2xpY2tvdXRzaWRlKGVsKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBDb250ZXh0TWVudTsKfSgpOwoKdmFyIEJvdHRvbWJhciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQm90dG9tYmFyKCkgewogICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgdmFyIGFkZEZ1bmMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZ1bmN0aW9uICgpIHt9OwogICAgdmFyIHN3YXBGdW5jID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmdW5jdGlvbiAoKSB7fTsKICAgIHZhciBkZWxldGVGdW5jID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBmdW5jdGlvbiAoKSB7fTsKICAgIHZhciB1cGRhdGVGdW5jID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmdW5jdGlvbiAoKSB7fTsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQm90dG9tYmFyKTsKCiAgICB0aGlzLnN3YXBGdW5jID0gc3dhcEZ1bmM7CiAgICB0aGlzLnVwZGF0ZUZ1bmMgPSB1cGRhdGVGdW5jOwogICAgdGhpcy5kYXRhTmFtZXMgPSBbXTsKICAgIHRoaXMuYWN0aXZlRWwgPSBudWxsOwogICAgdGhpcy5kZWxldGVFbCA9IG51bGw7CiAgICB0aGlzLml0ZW1zID0gW107CiAgICB0aGlzLm1vcmVFbCA9IG5ldyBEcm9wZG93bk1vcmUoZnVuY3Rpb24gKGkpIHsKICAgICAgX3RoaXM1LmNsaWNrU3dhcDIoX3RoaXM1Lml0ZW1zW2ldKTsKICAgIH0pOwogICAgdGhpcy5jb250ZXh0TWVudSA9IG5ldyBDb250ZXh0TWVudSgpOwogICAgdGhpcy5jb250ZXh0TWVudS5pdGVtQ2xpY2sgPSBkZWxldGVGdW5jOwogICAgdGhpcy5lbCA9IGgoJ2RpdicsICIiLmNvbmNhdChjc3NQcmVmaXgsICItYm90dG9tYmFyIikpLmNoaWxkcmVuKHRoaXMuY29udGV4dE1lbnUuZWwsIHRoaXMubWVudUVsID0gaCgndWwnLCAiIi5jb25jYXQoY3NzUHJlZml4LCAiLW1lbnUiKSkuY2hpbGQoaCgnbGknLCAnJykuY2hpbGRyZW4obmV3IEljb24oJ2FkZCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHsKICAgICAgYWRkRnVuYygpOwogICAgfSksIGgoJ3NwYW4nLCAnJykuY2hpbGQodGhpcy5tb3JlRWwpKSkpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEJvdHRvbWJhciwgW3sKICAgIGtleTogImFkZEl0ZW0iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZEl0ZW0obmFtZSwgYWN0aXZlKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgdGhpcy5kYXRhTmFtZXMucHVzaChuYW1lKTsKICAgICAgdmFyIGl0ZW0gPSBoKCdsaScsIGFjdGl2ZSA/ICdhY3RpdmUnIDogJycpLmNoaWxkKG5hbWUpOwogICAgICBpdGVtLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczYuY2xpY2tTd2FwMihpdGVtKTsKICAgICAgfSkub24oJ2NvbnRleHRtZW51JywgZnVuY3Rpb24gKGV2dCkgewogICAgICAgIHZhciBfZXZ0JHRhcmdldCA9IGV2dC50YXJnZXQsCiAgICAgICAgICAgIG9mZnNldExlZnQgPSBfZXZ0JHRhcmdldC5vZmZzZXRMZWZ0LAogICAgICAgICAgICBvZmZzZXRIZWlnaHQgPSBfZXZ0JHRhcmdldC5vZmZzZXRIZWlnaHQ7CgogICAgICAgIF90aGlzNi5jb250ZXh0TWVudS5zZXRPZmZzZXQoewogICAgICAgICAgbGVmdDogb2Zmc2V0TGVmdCwKICAgICAgICAgIGJvdHRvbTogb2Zmc2V0SGVpZ2h0ICsgMQogICAgICAgIH0pOwoKICAgICAgICBfdGhpczYuZGVsZXRlRWwgPSBpdGVtOwogICAgICB9KS5vbignZGJsY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIHYgPSBpdGVtLmh0bWwoKTsKICAgICAgICB2YXIgaW5wdXQgPSBuZXcgRm9ybUlucHV0KCdhdXRvJywgJycpOwogICAgICAgIGlucHV0LnZhbCh2KTsKICAgICAgICBpbnB1dC5pbnB1dC5vbignYmx1cicsIGZ1bmN0aW9uIChfcmVmKSB7CiAgICAgICAgICB2YXIgdGFyZ2V0ID0gX3JlZi50YXJnZXQ7CiAgICAgICAgICB2YXIgdmFsdWUgPSB0YXJnZXQudmFsdWU7CgogICAgICAgICAgdmFyIG5pbmRleCA9IF90aGlzNi5kYXRhTmFtZXMuZmluZEluZGV4KGZ1bmN0aW9uIChpdCkgewogICAgICAgICAgICByZXR1cm4gaXQgPT09IHY7CiAgICAgICAgICB9KTsKCiAgICAgICAgICBfdGhpczYucmVuYW1lSXRlbShuaW5kZXgsIHZhbHVlKTsKICAgICAgICAgIC8qDQogICAgICAgICAgdGhpcy5kYXRhTmFtZXMuc3BsaWNlKG5pbmRleCwgMSwgdmFsdWUpOw0KICAgICAgICAgIHRoaXMubW9yZUVsLnJlc2V0KHRoaXMuZGF0YU5hbWVzKTsNCiAgICAgICAgICBpdGVtLmh0bWwoJycpLmNoaWxkKHZhbHVlKTsNCiAgICAgICAgICB0aGlzLnVwZGF0ZUZ1bmMobmluZGV4LCB2YWx1ZSk7DQogICAgICAgICAgKi8KCiAgICAgICAgfSk7CiAgICAgICAgaXRlbS5odG1sKCcnKS5jaGlsZChpbnB1dC5lbCk7CiAgICAgICAgaW5wdXQuZm9jdXMoKTsKICAgICAgfSk7CgogICAgICBpZiAoYWN0aXZlKSB7CiAgICAgICAgdGhpcy5jbGlja1N3YXAoaXRlbSk7CiAgICAgIH0KCiAgICAgIHRoaXMuaXRlbXMucHVzaChpdGVtKTsKICAgICAgdGhpcy5tZW51RWwuY2hpbGQoaXRlbSk7CiAgICAgIHRoaXMubW9yZUVsLnJlc2V0KHRoaXMuZGF0YU5hbWVzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5hbWVJdGVtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5hbWVJdGVtKGluZGV4LCB2YWx1ZSkgewogICAgICB0aGlzLmRhdGFOYW1lcy5zcGxpY2UoaW5kZXgsIDEsIHZhbHVlKTsKICAgICAgdGhpcy5tb3JlRWwucmVzZXQodGhpcy5kYXRhTmFtZXMpOwogICAgICB0aGlzLml0ZW1zW2luZGV4XS5odG1sKCcnKS5jaGlsZCh2YWx1ZSk7CiAgICAgIHRoaXMudXBkYXRlRnVuYyhpbmRleCwgdmFsdWUpOwogICAgfQogIH0sIHsKICAgIGtleTogImNsZWFyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhcigpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CgogICAgICB0aGlzLml0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0KSB7CiAgICAgICAgX3RoaXM3Lm1lbnVFbC5yZW1vdmVDaGlsZChpdC5lbCk7CiAgICAgIH0pOwogICAgICB0aGlzLml0ZW1zID0gW107CiAgICAgIHRoaXMuZGF0YU5hbWVzID0gW107CiAgICAgIHRoaXMubW9yZUVsLnJlc2V0KHRoaXMuZGF0YU5hbWVzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkZWxldGVJdGVtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkZWxldGVJdGVtKCkgewogICAgICB2YXIgYWN0aXZlRWwgPSB0aGlzLmFjdGl2ZUVsLAogICAgICAgICAgZGVsZXRlRWwgPSB0aGlzLmRlbGV0ZUVsOwoKICAgICAgaWYgKHRoaXMuaXRlbXMubGVuZ3RoID4gMSkgewogICAgICAgIHZhciBpbmRleCA9IHRoaXMuaXRlbXMuZmluZEluZGV4KGZ1bmN0aW9uIChpdCkgewogICAgICAgICAgcmV0dXJuIGl0ID09PSBkZWxldGVFbDsKICAgICAgICB9KTsKICAgICAgICB0aGlzLml0ZW1zLnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgdGhpcy5kYXRhTmFtZXMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgICB0aGlzLm1lbnVFbC5yZW1vdmVDaGlsZChkZWxldGVFbC5lbCk7CiAgICAgICAgdGhpcy5tb3JlRWwucmVzZXQodGhpcy5kYXRhTmFtZXMpOwoKICAgICAgICBpZiAoYWN0aXZlRWwgPT09IGRlbGV0ZUVsKSB7CiAgICAgICAgICB2YXIgX3RoaXMkaXRlbXMgPSBfc2xpY2VkVG9BcnJheSh0aGlzLml0ZW1zLCAxKSwKICAgICAgICAgICAgICBmID0gX3RoaXMkaXRlbXNbMF07CgogICAgICAgICAgdGhpcy5hY3RpdmVFbCA9IGY7CiAgICAgICAgICB0aGlzLmFjdGl2ZUVsLnRvZ2dsZSgpOwogICAgICAgICAgcmV0dXJuIFtpbmRleCwgMF07CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gW2luZGV4LCAtMV07CiAgICAgIH0KCiAgICAgIHJldHVybiBbLTFdOwogICAgfQogIH0sIHsKICAgIGtleTogImNsaWNrU3dhcDIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNsaWNrU3dhcDIoaXRlbSkgewogICAgICB2YXIgaW5kZXggPSB0aGlzLml0ZW1zLmZpbmRJbmRleChmdW5jdGlvbiAoaXQpIHsKICAgICAgICByZXR1cm4gaXQgPT09IGl0ZW07CiAgICAgIH0pOwogICAgICB0aGlzLmNsaWNrU3dhcChpdGVtKTsKICAgICAgdGhpcy5hY3RpdmVFbC50b2dnbGUoKTsKICAgICAgdGhpcy5zd2FwRnVuYyhpbmRleCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2xpY2tTd2FwIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGlja1N3YXAoaXRlbSkgewogICAgICBpZiAodGhpcy5hY3RpdmVFbCAhPT0gbnVsbCkgewogICAgICAgIHRoaXMuYWN0aXZlRWwudG9nZ2xlKCk7CiAgICAgIH0KCiAgICAgIHRoaXMuYWN0aXZlRWwgPSBpdGVtOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEJvdHRvbWJhcjsKfSgpOwoKZXhwb3J0IHsgQm90dG9tYmFyIGFzIGRlZmF1bHQgfTs="},{"version":3,"sources":["C:/Users/吴建明/Desktop/VisualizationExcle_Demo/src/components/x-spreadsheet/component/bottombar.js"],"names":["h","bindClickoutside","unbindClickoutside","cssPrefix","Icon","FormInput","Dropdown","xtoast","tf","DropdownMore","click","icon","contentClick","items","eles","map","it","i","css","on","hide","child","setContentChildren","menuItems","key","title","buildMenuItem","item","itemClick","buildMenu","call","ContextMenu","el","children","offset","show","Bottombar","addFunc","swapFunc","deleteFunc","updateFunc","dataNames","activeEl","deleteEl","moreEl","clickSwap2","contextMenu","menuEl","name","active","push","evt","target","offsetLeft","offsetHeight","setOffset","left","bottom","v","html","input","val","value","nindex","findIndex","renameItem","focus","clickSwap","reset","index","splice","forEach","removeChild","length","f","toggle"],"mappings":"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","sourcesContent":["import { h } from './element';\r\nimport { bindClickoutside, unbindClickoutside } from './event';\r\nimport { cssPrefix } from '../config';\r\nimport Icon from './icon';\r\nimport FormInput from './form_input';\r\nimport Dropdown from './dropdown';\r\nimport { xtoast } from './message';\r\nimport { tf } from '../locale/locale';\r\n\r\nclass DropdownMore extends Dropdown {\r\n  constructor(click) {\r\n    const icon = new Icon('ellipsis');\r\n    super(icon, 'auto', false, 'top-left');\r\n    this.contentClick = click;\r\n  }\r\n\r\n  reset(items) {\r\n    const eles = items.map((it, i) => h('div', `${cssPrefix}-item`)\r\n      .css('width', '150px')\r\n      .css('font-weight', 'normal')\r\n      .on('click', () => {\r\n        this.contentClick(i);\r\n        this.hide();\r\n      })\r\n      .child(it));\r\n    this.setContentChildren(...eles);\r\n  }\r\n\r\n  setTitle() {}\r\n}\r\n\r\nconst menuItems = [\r\n  { key: 'delete', title: tf('contextmenu.deleteSheet') },\r\n];\r\n\r\nfunction buildMenuItem(item) {\r\n  return h('div', `${cssPrefix}-item`)\r\n    .child(item.title())\r\n    .on('click', () => {\r\n      this.itemClick(item.key);\r\n      this.hide();\r\n    });\r\n}\r\n\r\nfunction buildMenu() {\r\n  return menuItems.map(it => buildMenuItem.call(this, it));\r\n}\r\n\r\nclass ContextMenu {\r\n  constructor() {\r\n    this.el = h('div', `${cssPrefix}-contextmenu`)\r\n      .css('width', '160px')\r\n      .children(...buildMenu.call(this))\r\n      .hide();\r\n    this.itemClick = () => {};\r\n  }\r\n\r\n  hide() {\r\n    const { el } = this;\r\n    el.hide();\r\n    unbindClickoutside(el);\r\n  }\r\n\r\n  setOffset(offset) {\r\n    const { el } = this;\r\n    el.offset(offset);\r\n    el.show();\r\n    bindClickoutside(el);\r\n  }\r\n}\r\n\r\nexport default class Bottombar {\r\n  constructor(addFunc = () => {},\r\n    swapFunc = () => {},\r\n    deleteFunc = () => {},\r\n    updateFunc = () => {}) {\r\n    this.swapFunc = swapFunc;\r\n    this.updateFunc = updateFunc;\r\n    this.dataNames = [];\r\n    this.activeEl = null;\r\n    this.deleteEl = null;\r\n    this.items = [];\r\n    this.moreEl = new DropdownMore((i) => {\r\n      this.clickSwap2(this.items[i]);\r\n    });\r\n    this.contextMenu = new ContextMenu();\r\n    this.contextMenu.itemClick = deleteFunc;\r\n    this.el = h('div', `${cssPrefix}-bottombar`).children(\r\n      this.contextMenu.el,\r\n      this.menuEl = h('ul', `${cssPrefix}-menu`).child(\r\n        h('li', '').children(\r\n          new Icon('add').on('click', () => {\r\n            addFunc();\r\n          }),\r\n          h('span', '').child(this.moreEl),\r\n        ),\r\n      ),\r\n    );\r\n  }\r\n\r\n  addItem(name, active) {\r\n    this.dataNames.push(name);\r\n    const item = h('li', active ? 'active' : '').child(name);\r\n    item.on('click', () => {\r\n      this.clickSwap2(item);\r\n    }).on('contextmenu', (evt) => {\r\n      const { offsetLeft, offsetHeight } = evt.target;\r\n      this.contextMenu.setOffset({ left: offsetLeft, bottom: offsetHeight + 1 });\r\n      this.deleteEl = item;\r\n    }).on('dblclick', () => {\r\n      const v = item.html();\r\n      const input = new FormInput('auto', '');\r\n      input.val(v);\r\n      input.input.on('blur', ({ target }) => {\r\n        const { value } = target;\r\n        const nindex = this.dataNames.findIndex(it => it === v);\r\n        this.renameItem(nindex, value);\r\n        /*\r\n        this.dataNames.splice(nindex, 1, value);\r\n        this.moreEl.reset(this.dataNames);\r\n        item.html('').child(value);\r\n        this.updateFunc(nindex, value);\r\n        */\r\n      });\r\n      item.html('').child(input.el);\r\n      input.focus();\r\n    });\r\n    if (active) {\r\n      this.clickSwap(item);\r\n    }\r\n    this.items.push(item);\r\n    this.menuEl.child(item);\r\n    this.moreEl.reset(this.dataNames);\r\n  }\r\n\r\n  renameItem(index, value) {\r\n    this.dataNames.splice(index, 1, value);\r\n    this.moreEl.reset(this.dataNames);\r\n    this.items[index].html('').child(value);\r\n    this.updateFunc(index, value);\r\n  }\r\n\r\n  clear() {\r\n    this.items.forEach((it) => {\r\n      this.menuEl.removeChild(it.el);\r\n    });\r\n    this.items = [];\r\n    this.dataNames = [];\r\n    this.moreEl.reset(this.dataNames);\r\n  }\r\n\r\n  deleteItem() {\r\n    const { activeEl, deleteEl } = this;\r\n    if (this.items.length > 1) {\r\n      const index = this.items.findIndex(it => it === deleteEl);\r\n      this.items.splice(index, 1);\r\n      this.dataNames.splice(index, 1);\r\n      this.menuEl.removeChild(deleteEl.el);\r\n      this.moreEl.reset(this.dataNames);\r\n      if (activeEl === deleteEl) {\r\n        const [f] = this.items;\r\n        this.activeEl = f;\r\n        this.activeEl.toggle();\r\n        return [index, 0];\r\n      }\r\n      return [index, -1];\r\n    }\r\n    return [-1];\r\n  }\r\n\r\n  clickSwap2(item) {\r\n    const index = this.items.findIndex(it => it === item);\r\n    this.clickSwap(item);\r\n    this.activeEl.toggle();\r\n    this.swapFunc(index);\r\n  }\r\n\r\n  clickSwap(item) {\r\n    if (this.activeEl !== null) {\r\n      this.activeEl.toggle();\r\n    }\r\n    this.activeEl = item;\r\n  }\r\n}\r\n"]}]}