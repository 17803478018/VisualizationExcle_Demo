{"remainingRequest":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\index.js","dependencies":[{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\index.js","mtime":1615364198226},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615364186494},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1615364186192},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js","mtime":1615364189991}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIkM6L1VzZXJzL1x1NTQzNFx1NUVGQVx1NjYwRS9EZXNrdG9wL1Zpc3VhbGl6YXRpb25FeGNsZV9EZW1vL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9zbGljZWRUb0FycmF5IjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJDOi9Vc2Vycy9cdTU0MzRcdTVFRkFcdTY2MEUvRGVza3RvcC9WaXN1YWxpemF0aW9uRXhjbGVfRGVtby9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkM6L1VzZXJzL1x1NTQzNFx1NUVGQVx1NjYwRS9EZXNrdG9wL1Zpc3VhbGl6YXRpb25FeGNsZV9EZW1vL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwovLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVkZWNsYXJlCgovKiBnbG9iYWwgd2luZG93LCBkb2N1bWVudCAqLwppbXBvcnQgeyBoIH0gZnJvbSAnLi9jb21wb25lbnQvZWxlbWVudCc7CmltcG9ydCBEYXRhUHJveHkgZnJvbSAnLi9jb3JlL2RhdGFfcHJveHknOwppbXBvcnQgU2hlZXQgZnJvbSAnLi9jb21wb25lbnQvc2hlZXQnOwppbXBvcnQgQm90dG9tYmFyIGZyb20gJy4vY29tcG9uZW50L2JvdHRvbWJhcic7CmltcG9ydCB7IGNzc1ByZWZpeCB9IGZyb20gJy4vY29uZmlnJzsKaW1wb3J0IHsgbG9jYWxlIGFzIF9sb2NhbGUgfSBmcm9tICcuL2xvY2FsZS9sb2NhbGUnOwppbXBvcnQgJy4vaW5kZXgubGVzcyc7Cgp2YXIgU3ByZWFkc2hlZXQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFNwcmVhZHNoZWV0KHNlbGVjdG9ycykgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNwcmVhZHNoZWV0KTsKCiAgICB2YXIgdGFyZ2V0RWwgPSBzZWxlY3RvcnM7CiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zOwogICAgdGhpcy5zaGVldEluZGV4ID0gMTsKICAgIHRoaXMuZGF0YXMgPSBbXTsKCiAgICBpZiAodHlwZW9mIHNlbGVjdG9ycyA9PT0gJ3N0cmluZycpIHsKICAgICAgdGFyZ2V0RWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycyk7CiAgICB9CgogICAgdGhpcy5ib3R0b21iYXIgPSBuZXcgQm90dG9tYmFyKGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGQgPSBfdGhpcy5hZGRTaGVldCgpOwoKICAgICAgX3RoaXMuc2hlZXQucmVzZXREYXRhKGQpOwogICAgfSwgZnVuY3Rpb24gKGluZGV4KSB7CiAgICAgIHZhciBkID0gX3RoaXMuZGF0YXNbaW5kZXhdOwoKICAgICAgX3RoaXMuc2hlZXQucmVzZXREYXRhKGQpOwogICAgfSwgZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5kZWxldGVTaGVldCgpOwogICAgfSwgZnVuY3Rpb24gKGluZGV4LCB2YWx1ZSkgewogICAgICBfdGhpcy5kYXRhc1tpbmRleF0ubmFtZSA9IHZhbHVlOwogICAgfSk7CiAgICB0aGlzLmRhdGEgPSB0aGlzLmFkZFNoZWV0KCk7CiAgICB2YXIgcm9vdEVsID0gaCgnZGl2JywgIiIuY29uY2F0KGNzc1ByZWZpeCkpLm9uKCdjb250ZXh0bWVudScsIGZ1bmN0aW9uIChldnQpIHsKICAgICAgcmV0dXJuIGV2dC5wcmV2ZW50RGVmYXVsdCgpOwogICAgfSk7IC8vIGNyZWF0ZSBjYW52YXMgZWxlbWVudAoKICAgIHRhcmdldEVsLmFwcGVuZENoaWxkKHJvb3RFbC5lbCk7CiAgICB0aGlzLnNoZWV0ID0gbmV3IFNoZWV0KHJvb3RFbCwgdGhpcy5kYXRhKTsKICAgIHJvb3RFbC5jaGlsZCh0aGlzLmJvdHRvbWJhci5lbCk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoU3ByZWFkc2hlZXQsIFt7CiAgICBrZXk6ICJhZGRTaGVldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkU2hlZXQobmFtZSkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBhY3RpdmUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHRydWU7CiAgICAgIHZhciBuID0gbmFtZSB8fCAic2hlZXQiLmNvbmNhdCh0aGlzLnNoZWV0SW5kZXgpOwogICAgICB2YXIgZCA9IG5ldyBEYXRhUHJveHkobiwgdGhpcy5vcHRpb25zKTsKCiAgICAgIGQuY2hhbmdlID0gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfdGhpczIkc2hlZXQ7CgogICAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgICAgICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTsKICAgICAgICB9CgogICAgICAgIChfdGhpczIkc2hlZXQgPSBfdGhpczIuc2hlZXQpLnRyaWdnZXIuYXBwbHkoX3RoaXMyJHNoZWV0LCBbJ2NoYW5nZSddLmNvbmNhdChhcmdzKSk7CiAgICAgIH07CgogICAgICB0aGlzLmRhdGFzLnB1c2goZCk7IC8vIGNvbnNvbGUubG9nKCdkOicsIG4sIGQsIHRoaXMuZGF0YXMpOwoKICAgICAgdGhpcy5ib3R0b21iYXIuYWRkSXRlbShuLCBhY3RpdmUpOwogICAgICB0aGlzLnNoZWV0SW5kZXggKz0gMTsKICAgICAgcmV0dXJuIGQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGVsZXRlU2hlZXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRlbGV0ZVNoZWV0KCkgewogICAgICB2YXIgX3RoaXMkYm90dG9tYmFyJGRlbGV0ID0gdGhpcy5ib3R0b21iYXIuZGVsZXRlSXRlbSgpLAogICAgICAgICAgX3RoaXMkYm90dG9tYmFyJGRlbGV0MiA9IF9zbGljZWRUb0FycmF5KF90aGlzJGJvdHRvbWJhciRkZWxldCwgMiksCiAgICAgICAgICBvbGRJbmRleCA9IF90aGlzJGJvdHRvbWJhciRkZWxldDJbMF0sCiAgICAgICAgICBuaW5kZXggPSBfdGhpcyRib3R0b21iYXIkZGVsZXQyWzFdOwoKICAgICAgaWYgKG9sZEluZGV4ID49IDApIHsKICAgICAgICB0aGlzLmRhdGFzLnNwbGljZShvbGRJbmRleCwgMSk7CiAgICAgICAgaWYgKG5pbmRleCA+PSAwKSB0aGlzLnNoZWV0LnJlc2V0RGF0YSh0aGlzLmRhdGFzW25pbmRleF0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAibG9hZERhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWREYXRhKGRhdGEpIHsKICAgICAgdmFyIGRzID0gQXJyYXkuaXNBcnJheShkYXRhKSA/IGRhdGEgOiBbZGF0YV07CiAgICAgIHRoaXMuYm90dG9tYmFyLmNsZWFyKCk7CiAgICAgIHRoaXMuZGF0YXMgPSBbXTsKCiAgICAgIGlmIChkcy5sZW5ndGggPiAwKSB7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkcy5sZW5ndGg7IGkgKz0gMSkgewogICAgICAgICAgdmFyIGl0ID0gZHNbaV07CiAgICAgICAgICB2YXIgbmQgPSB0aGlzLmFkZFNoZWV0KGl0Lm5hbWUsIGkgPT09IDApOwogICAgICAgICAgbmQuc2V0RGF0YShpdCk7CgogICAgICAgICAgaWYgKGkgPT09IDApIHsKICAgICAgICAgICAgdGhpcy5zaGVldC5yZXNldERhdGEobmQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0RGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGF0YSgpIHsKICAgICAgcmV0dXJuIHRoaXMuZGF0YXMubWFwKGZ1bmN0aW9uIChpdCkgewogICAgICAgIHJldHVybiBpdC5nZXREYXRhKCk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImNlbGxUZXh0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjZWxsVGV4dChyaSwgY2ksIHRleHQpIHsKICAgICAgdmFyIHNoZWV0SW5kZXggPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IDA7CiAgICAgIHRoaXMuZGF0YXNbc2hlZXRJbmRleF0uc2V0Q2VsbFRleHQocmksIGNpLCB0ZXh0LCAnZmluaXNoZWQnKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2VsbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2VsbChyaSwgY2kpIHsKICAgICAgdmFyIHNoZWV0SW5kZXggPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IDA7CiAgICAgIHJldHVybiB0aGlzLmRhdGFzW3NoZWV0SW5kZXhdLmdldENlbGwocmksIGNpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjZWxsU3R5bGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNlbGxTdHlsZShyaSwgY2kpIHsKICAgICAgdmFyIHNoZWV0SW5kZXggPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IDA7CiAgICAgIHJldHVybiB0aGlzLmRhdGFzW3NoZWV0SW5kZXhdLmdldENlbGxTdHlsZShyaSwgY2kpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlUmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZVJlbmRlcigpIHsKICAgICAgdGhpcy5zaGVldC50b29sYmFyLmNoYW5nZSgpOwogICAgICB0aGlzLnNoZWV0LnRhYmxlLnJlbmRlcih0cnVlKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgfSwgewogICAga2V5OiAib24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uKGV2ZW50TmFtZSwgZnVuYykgewogICAgICB0aGlzLnNoZWV0Lm9uKGV2ZW50TmFtZSwgZnVuYyk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH0sIHsKICAgIGtleTogInZhbGlkYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB2YWxpZGF0ZSgpIHsKICAgICAgdmFyIHZhbGlkYXRpb25zID0gdGhpcy5kYXRhLnZhbGlkYXRpb25zOwogICAgICByZXR1cm4gdmFsaWRhdGlvbnMuZXJyb3JzLnNpemUgPD0gMDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjaGFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNoYW5nZShjYikgewogICAgICB0aGlzLnNoZWV0Lm9uKCdjaGFuZ2UnLCBjYik7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogIH1dLCBbewogICAga2V5OiAibG9jYWxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsb2NhbGUobGFuZywgbWVzc2FnZSkgewogICAgICBfbG9jYWxlKGxhbmcsIG1lc3NhZ2UpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFNwcmVhZHNoZWV0Owp9KCk7Cgp2YXIgc3ByZWFkc2hlZXQgPSBmdW5jdGlvbiBzcHJlYWRzaGVldChlbCkgewogIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTsKICByZXR1cm4gbmV3IFNwcmVhZHNoZWV0KGVsLCBvcHRpb25zKTsKfTsKCmlmICh3aW5kb3cpIHsKICB3aW5kb3cueF9zcHJlYWRzaGVldCA9IHNwcmVhZHNoZWV0OwoKICB3aW5kb3cueF9zcHJlYWRzaGVldC5sb2NhbGUgPSBmdW5jdGlvbiAobGFuZywgbWVzc2FnZSkgewogICAgcmV0dXJuIF9sb2NhbGUobGFuZywgbWVzc2FnZSk7CiAgfTsKfQoKZXhwb3J0IGRlZmF1bHQgU3ByZWFkc2hlZXQ7CmV4cG9ydCB7IHNwcmVhZHNoZWV0IH07"},{"version":3,"sources":["C:/Users/吴建明/Desktop/VisualizationExcle_Demo/src/components/x-spreadsheet/index.js"],"names":["h","DataProxy","Sheet","Bottombar","cssPrefix","locale","Spreadsheet","selectors","options","targetEl","sheetIndex","datas","document","querySelector","bottombar","d","addSheet","sheet","resetData","index","deleteSheet","value","name","data","rootEl","on","evt","preventDefault","appendChild","el","child","active","n","change","args","trigger","push","addItem","deleteItem","oldIndex","nindex","splice","ds","Array","isArray","clear","length","i","it","nd","setData","map","getData","ri","ci","text","setCellText","getCell","getCellStyle","toolbar","table","render","eventName","func","validations","errors","size","cb","lang","message","spreadsheet","window","x_spreadsheet"],"mappings":"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","sourcesContent":["// eslint-disable-next-line no-redeclare\r\n/* global window, document */\r\nimport {\r\n  h\r\n} from './component/element';\r\nimport DataProxy from './core/data_proxy';\r\nimport Sheet from './component/sheet';\r\nimport Bottombar from './component/bottombar';\r\nimport {\r\n  cssPrefix\r\n} from './config';\r\nimport {\r\n  locale\r\n} from './locale/locale';\r\nimport './index.less';\r\n\r\n\r\nclass Spreadsheet {\r\n  constructor(selectors, options = {}) {\r\n    let targetEl = selectors;\r\n    this.options = options;\r\n    this.sheetIndex = 1;\r\n    this.datas = [];\r\n    if (typeof selectors === 'string') {\r\n      targetEl = document.querySelector(selectors);\r\n    }\r\n    this.bottombar = new Bottombar(() => {\r\n      const d = this.addSheet();\r\n      this.sheet.resetData(d);\r\n    }, (index) => {\r\n      const d = this.datas[index];\r\n      this.sheet.resetData(d);\r\n    }, () => {\r\n      this.deleteSheet();\r\n    }, (index, value) => {\r\n      this.datas[index].name = value;\r\n    });\r\n    this.data = this.addSheet();\r\n    const rootEl = h('div', `${cssPrefix}`)\r\n      .on('contextmenu', evt => evt.preventDefault());\r\n    // create canvas element\r\n    targetEl.appendChild(rootEl.el);\r\n    this.sheet = new Sheet(rootEl, this.data);\r\n    rootEl.child(this.bottombar.el);\r\n  }\r\n\r\n  addSheet(name, active = true) {\r\n    const n = name || `sheet${this.sheetIndex}`;\r\n    const d = new DataProxy(n, this.options);\r\n    d.change = (...args) => {\r\n      this.sheet.trigger('change', ...args);\r\n    };\r\n    this.datas.push(d);\r\n    // console.log('d:', n, d, this.datas);\r\n    this.bottombar.addItem(n, active);\r\n    this.sheetIndex += 1;\r\n    return d;\r\n  }\r\n\r\n  deleteSheet() {\r\n    const [oldIndex, nindex] = this.bottombar.deleteItem();\r\n    if (oldIndex >= 0) {\r\n      this.datas.splice(oldIndex, 1);\r\n      if (nindex >= 0) this.sheet.resetData(this.datas[nindex]);\r\n    }\r\n  }\r\n\r\n  loadData(data) {\r\n    const ds = Array.isArray(data) ? data : [data];\r\n    this.bottombar.clear();\r\n    this.datas = [];\r\n    if (ds.length > 0) {\r\n      for (let i = 0; i < ds.length; i += 1) {\r\n        const it = ds[i];\r\n        const nd = this.addSheet(it.name, i === 0);\r\n        nd.setData(it);\r\n        if (i === 0) {\r\n          this.sheet.resetData(nd);\r\n        }\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  getData() {\r\n    return this.datas.map(it => it.getData());\r\n  }\r\n\r\n  cellText(ri, ci, text, sheetIndex = 0) {\r\n    this.datas[sheetIndex].setCellText(ri, ci, text, 'finished');\r\n    return this;\r\n  }\r\n\r\n  cell(ri, ci, sheetIndex = 0) {\r\n    return this.datas[sheetIndex].getCell(ri, ci);\r\n  }\r\n\r\n  cellStyle(ri, ci, sheetIndex = 0) {\r\n    return this.datas[sheetIndex].getCellStyle(ri, ci);\r\n  }\r\n\r\n  reRender() {\r\n    this.sheet.toolbar.change()\r\n    this.sheet.table.render(true);\r\n    return this;\r\n  }\r\n\r\n  on(eventName, func) {\r\n    this.sheet.on(eventName, func);\r\n    return this;\r\n  }\r\n\r\n  validate() {\r\n    const {\r\n      validations\r\n    } = this.data;\r\n    return validations.errors.size <= 0;\r\n  }\r\n\r\n  change(cb) {\r\n    this.sheet.on('change', cb);\r\n    return this;\r\n  }\r\n\r\n  static locale(lang, message) {\r\n    locale(lang, message);\r\n  }\r\n}\r\n\r\nconst spreadsheet = (el, options = {}) => new Spreadsheet(el, options);\r\n\r\nif (window) {\r\n  window.x_spreadsheet = spreadsheet;\r\n  window.x_spreadsheet.locale = (lang, message) => locale(lang, message);\r\n}\r\n\r\nexport default Spreadsheet;\r\nexport {\r\n  spreadsheet,\r\n};\r\n"]}]}