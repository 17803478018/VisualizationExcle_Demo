{"remainingRequest":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js!D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\代码\\del_demo\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\core\\cell_range.js","dependencies":[{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\core\\cell_range.js","mtime":1614915429358},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596536485880},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1606828682259},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js","mtime":1603719226989}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIkQ6L1x1NEVFM1x1NzgwMS9kZWxfZGVtby9WaXN1YWxpemF0aW9uRXhjbGVfRGVtby9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheSI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiRDovXHU0RUUzXHU3ODAxL2RlbF9kZW1vL1Zpc3VhbGl6YXRpb25FeGNsZV9EZW1vL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiRDovXHU0RUUzXHU3ODAxL2RlbF9kZW1vL1Zpc3VhbGl6YXRpb25FeGNsZV9EZW1vL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIjsKaW1wb3J0IHsgeHkyZXhwciwgZXhwcjJ4eSB9IGZyb20gJy4vYWxwaGFiZXQnOwoKdmFyIENlbGxSYW5nZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQ2VsbFJhbmdlKHNyaSwgc2NpLCBlcmksIGVjaSkgewogICAgdmFyIHcgPSBhcmd1bWVudHMubGVuZ3RoID4gNCAmJiBhcmd1bWVudHNbNF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s0XSA6IDA7CiAgICB2YXIgaCA9IGFyZ3VtZW50cy5sZW5ndGggPiA1ICYmIGFyZ3VtZW50c1s1XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzVdIDogMDsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ2VsbFJhbmdlKTsKCiAgICB0aGlzLnNyaSA9IHNyaTsKICAgIHRoaXMuc2NpID0gc2NpOwogICAgdGhpcy5lcmkgPSBlcmk7CiAgICB0aGlzLmVjaSA9IGVjaTsKICAgIHRoaXMudyA9IHc7CiAgICB0aGlzLmggPSBoOwogIH0KCiAgX2NyZWF0ZUNsYXNzKENlbGxSYW5nZSwgW3sKICAgIGtleTogInNldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0KHNyaSwgc2NpLCBlcmksIGVjaSkgewogICAgICB0aGlzLnNyaSA9IHNyaTsKICAgICAgdGhpcy5zY2kgPSBzY2k7CiAgICAgIHRoaXMuZXJpID0gZXJpOwogICAgICB0aGlzLmVjaSA9IGVjaTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtdWx0aXBsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbXVsdGlwbGUoKSB7CiAgICAgIHJldHVybiB0aGlzLmVyaSAtIHRoaXMuc3JpID4gMCB8fCB0aGlzLmVjaSAtIHRoaXMuc2NpID4gMDsKICAgIH0gLy8gY2VsbC1pbmRleDogcmksIGNpCiAgICAvLyBjZWxsLXJlZjogQTEwCgogIH0sIHsKICAgIGtleTogImluY2x1ZGVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbmNsdWRlcygpIHsKICAgICAgdmFyIHJpID0gMCwKICAgICAgICAgIGNpID0gMDsKCiAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07CiAgICAgIH0KCiAgICAgIGlmIChhcmdzLmxlbmd0aCA9PT0gMSkgewogICAgICAgIHZhciBfZXhwcjJ4eSA9IGV4cHIyeHkoYXJnc1swXSk7CgogICAgICAgIHZhciBfZXhwcjJ4eTIgPSBfc2xpY2VkVG9BcnJheShfZXhwcjJ4eSwgMik7CgogICAgICAgIGNpID0gX2V4cHIyeHkyWzBdOwogICAgICAgIHJpID0gX2V4cHIyeHkyWzFdOwogICAgICB9IGVsc2UgaWYgKGFyZ3MubGVuZ3RoID09PSAyKSB7CiAgICAgICAgcmkgPSBhcmdzWzBdOwogICAgICAgIGNpID0gYXJnc1sxXTsKICAgICAgfQoKICAgICAgdmFyIHNyaSA9IHRoaXMuc3JpLAogICAgICAgICAgc2NpID0gdGhpcy5zY2ksCiAgICAgICAgICBlcmkgPSB0aGlzLmVyaSwKICAgICAgICAgIGVjaSA9IHRoaXMuZWNpOwogICAgICByZXR1cm4gc3JpIDw9IHJpICYmIHJpIDw9IGVyaSAmJiBzY2kgPD0gY2kgJiYgY2kgPD0gZWNpOwogICAgfQogIH0sIHsKICAgIGtleTogImVhY2giLAogICAgdmFsdWU6IGZ1bmN0aW9uIGVhY2goY2IpIHsKICAgICAgdmFyIHJvd0ZpbHRlciA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9OwogICAgICB2YXIgc3JpID0gdGhpcy5zcmksCiAgICAgICAgICBzY2kgPSB0aGlzLnNjaSwKICAgICAgICAgIGVyaSA9IHRoaXMuZXJpLAogICAgICAgICAgZWNpID0gdGhpcy5lY2k7CgogICAgICBmb3IgKHZhciBpID0gc3JpOyBpIDw9IGVyaTsgaSArPSAxKSB7CiAgICAgICAgaWYgKHJvd0ZpbHRlcihpKSkgewogICAgICAgICAgZm9yICh2YXIgaiA9IHNjaTsgaiA8PSBlY2k7IGogKz0gMSkgewogICAgICAgICAgICBjYihpLCBqKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb250YWlucyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29udGFpbnMob3RoZXIpIHsKICAgICAgcmV0dXJuIHRoaXMuc3JpIDw9IG90aGVyLnNyaSAmJiB0aGlzLnNjaSA8PSBvdGhlci5zY2kgJiYgdGhpcy5lcmkgPj0gb3RoZXIuZXJpICYmIHRoaXMuZWNpID49IG90aGVyLmVjaTsKICAgIH0gLy8gd2l0aGluCgogIH0sIHsKICAgIGtleTogIndpdGhpbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gd2l0aGluKG90aGVyKSB7CiAgICAgIHJldHVybiB0aGlzLnNyaSA+PSBvdGhlci5zcmkgJiYgdGhpcy5zY2kgPj0gb3RoZXIuc2NpICYmIHRoaXMuZXJpIDw9IG90aGVyLmVyaSAmJiB0aGlzLmVjaSA8PSBvdGhlci5lY2k7CiAgICB9IC8vIGRpc2pvaW50CgogIH0sIHsKICAgIGtleTogImRpc2pvaW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNqb2ludChvdGhlcikgewogICAgICByZXR1cm4gdGhpcy5zcmkgPiBvdGhlci5lcmkgfHwgdGhpcy5zY2kgPiBvdGhlci5lY2kgfHwgb3RoZXIuc3JpID4gdGhpcy5lcmkgfHwgb3RoZXIuc2NpID4gdGhpcy5lY2k7CiAgICB9IC8vIGludGVyc2VjdHMKCiAgfSwgewogICAga2V5OiAiaW50ZXJzZWN0cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW50ZXJzZWN0cyhvdGhlcikgewogICAgICByZXR1cm4gdGhpcy5zcmkgPD0gb3RoZXIuZXJpICYmIHRoaXMuc2NpIDw9IG90aGVyLmVjaSAmJiBvdGhlci5zcmkgPD0gdGhpcy5lcmkgJiYgb3RoZXIuc2NpIDw9IHRoaXMuZWNpOwogICAgfSAvLyB1bmlvbgoKICB9LCB7CiAgICBrZXk6ICJ1bmlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdW5pb24ob3RoZXIpIHsKICAgICAgdmFyIHNyaSA9IHRoaXMuc3JpLAogICAgICAgICAgc2NpID0gdGhpcy5zY2ksCiAgICAgICAgICBlcmkgPSB0aGlzLmVyaSwKICAgICAgICAgIGVjaSA9IHRoaXMuZWNpOwogICAgICByZXR1cm4gbmV3IENlbGxSYW5nZShvdGhlci5zcmkgPCBzcmkgPyBvdGhlci5zcmkgOiBzcmksIG90aGVyLnNjaSA8IHNjaSA/IG90aGVyLnNjaSA6IHNjaSwgb3RoZXIuZXJpID4gZXJpID8gb3RoZXIuZXJpIDogZXJpLCBvdGhlci5lY2kgPiBlY2kgPyBvdGhlci5lY2kgOiBlY2kpOwogICAgfSAvLyBpbnRlcnNlY3Rpb24KICAgIC8vIGludGVyc2VjdGlvbihvdGhlcikge30KICAgIC8vIFJldHVybnMgQXJyYXk8Q2VsbFJhbmdlPiB0aGF0IHJlcHJlc2VudHMgdGhhdCBwYXJ0IG9mIHRoaXMgdGhhdCBkb2VzIG5vdCBpbnRlcnNlY3Qgd2l0aCBvdGhlcgogICAgLy8gZGlmZmVyZW5jZQoKICB9LCB7CiAgICBrZXk6ICJkaWZmZXJlbmNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkaWZmZXJlbmNlKG90aGVyKSB7CiAgICAgIHZhciByZXQgPSBbXTsKCiAgICAgIHZhciBhZGRSZXQgPSBmdW5jdGlvbiBhZGRSZXQoc3JpLCBzY2ksIGVyaSwgZWNpKSB7CiAgICAgICAgcmV0LnB1c2gobmV3IENlbGxSYW5nZShzcmksIHNjaSwgZXJpLCBlY2kpKTsKICAgICAgfTsKCiAgICAgIHZhciBzcmkgPSB0aGlzLnNyaSwKICAgICAgICAgIHNjaSA9IHRoaXMuc2NpLAogICAgICAgICAgZXJpID0gdGhpcy5lcmksCiAgICAgICAgICBlY2kgPSB0aGlzLmVjaTsKICAgICAgdmFyIGRzciA9IG90aGVyLnNyaSAtIHNyaTsKICAgICAgdmFyIGRzYyA9IG90aGVyLnNjaSAtIHNjaTsKICAgICAgdmFyIGRlciA9IGVyaSAtIG90aGVyLmVyaTsKICAgICAgdmFyIGRlYyA9IGVjaSAtIG90aGVyLmVjaTsKCiAgICAgIGlmIChkc3IgPiAwKSB7CiAgICAgICAgYWRkUmV0KHNyaSwgc2NpLCBvdGhlci5zcmkgLSAxLCBlY2kpOwoKICAgICAgICBpZiAoZGVyID4gMCkgewogICAgICAgICAgYWRkUmV0KG90aGVyLmVyaSArIDEsIHNjaSwgZXJpLCBlY2kpOwoKICAgICAgICAgIGlmIChkc2MgPiAwKSB7CiAgICAgICAgICAgIGFkZFJldChvdGhlci5zcmksIHNjaSwgb3RoZXIuZXJpLCBvdGhlci5zY2kgLSAxKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZGVjID4gMCkgewogICAgICAgICAgICBhZGRSZXQob3RoZXIuc3JpLCBvdGhlci5lY2kgKyAxLCBvdGhlci5lcmksIGVjaSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChkc2MgPiAwKSB7CiAgICAgICAgICAgIGFkZFJldChvdGhlci5zcmksIHNjaSwgZXJpLCBvdGhlci5zY2kgLSAxKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoZGVjID4gMCkgewogICAgICAgICAgICBhZGRSZXQob3RoZXIuc3JpLCBvdGhlci5lY2kgKyAxLCBlcmksIGVjaSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGRlciA+IDApIHsKICAgICAgICBhZGRSZXQob3RoZXIuZXJpICsgMSwgc2NpLCBlcmksIGVjaSk7CgogICAgICAgIGlmIChkc2MgPiAwKSB7CiAgICAgICAgICBhZGRSZXQoc3JpLCBzY2ksIG90aGVyLmVyaSwgb3RoZXIuc2NpIC0gMSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoZGVjID4gMCkgewogICAgICAgICAgYWRkUmV0KHNyaSwgb3RoZXIuZWNpICsgMSwgb3RoZXIuZXJpLCBlY2kpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGRzYyA+IDApIHsKICAgICAgICBhZGRSZXQoc3JpLCBzY2ksIGVyaSwgb3RoZXIuc2NpIC0gMSk7CgogICAgICAgIGlmIChkZWMgPiAwKSB7CiAgICAgICAgICBhZGRSZXQoc3JpLCBvdGhlci5lcmkgKyAxLCBlcmksIGVjaSk7CgogICAgICAgICAgaWYgKGRzciA+IDApIHsKICAgICAgICAgICAgYWRkUmV0KHNyaSwgb3RoZXIuc2NpLCBvdGhlci5zcmkgLSAxLCBvdGhlci5lY2kpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChkZXIgPiAwKSB7CiAgICAgICAgICAgIGFkZFJldChvdGhlci5zcmkgKyAxLCBvdGhlci5zY2ksIGVyaSwgb3RoZXIuZWNpKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKGRzciA+IDApIHsKICAgICAgICAgICAgYWRkUmV0KHNyaSwgb3RoZXIuc2NpLCBvdGhlci5zcmkgLSAxLCBlY2kpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChkZXIgPiAwKSB7CiAgICAgICAgICAgIGFkZFJldChvdGhlci5zcmkgKyAxLCBvdGhlci5zY2ksIGVyaSwgZWNpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoZGVjID4gMCkgewogICAgICAgIGFkZFJldChlcmksIG90aGVyLmVjaSArIDEsIGVyaSwgZWNpKTsKCiAgICAgICAgaWYgKGRzciA+IDApIHsKICAgICAgICAgIGFkZFJldChzcmksIHNjaSwgb3RoZXIuc3JpIC0gMSwgb3RoZXIuZWNpKTsKICAgICAgICB9CgogICAgICAgIGlmIChkZXIgPiAwKSB7CiAgICAgICAgICBhZGRSZXQob3RoZXIuZXJpICsgMSwgc2NpLCBlcmksIG90aGVyLmVjaSk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gcmV0OwogICAgfQogIH0sIHsKICAgIGtleTogInNpemUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNpemUoKSB7CiAgICAgIHJldHVybiBbdGhpcy5lcmkgLSB0aGlzLnNyaSArIDEsIHRoaXMuZWNpIC0gdGhpcy5zY2kgKyAxXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ0b1N0cmluZyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdG9TdHJpbmcoKSB7CiAgICAgIHZhciBzcmkgPSB0aGlzLnNyaSwKICAgICAgICAgIHNjaSA9IHRoaXMuc2NpLAogICAgICAgICAgZXJpID0gdGhpcy5lcmksCiAgICAgICAgICBlY2kgPSB0aGlzLmVjaTsKICAgICAgdmFyIHJlZiA9IHh5MmV4cHIoc2NpLCBzcmkpOwoKICAgICAgaWYgKHRoaXMubXVsdGlwbGUoKSkgewogICAgICAgIHJlZiA9ICIiLmNvbmNhdChyZWYsICI6IikuY29uY2F0KHh5MmV4cHIoZWNpLCBlcmkpKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlZjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbG9uZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7CiAgICAgIHZhciBzcmkgPSB0aGlzLnNyaSwKICAgICAgICAgIHNjaSA9IHRoaXMuc2NpLAogICAgICAgICAgZXJpID0gdGhpcy5lcmksCiAgICAgICAgICBlY2kgPSB0aGlzLmVjaSwKICAgICAgICAgIHcgPSB0aGlzLncsCiAgICAgICAgICBoID0gdGhpcy5oOwogICAgICByZXR1cm4gbmV3IENlbGxSYW5nZShzcmksIHNjaSwgZXJpLCBlY2ksIHcsIGgpOwogICAgfQogICAgLyoNCiAgICB0b0pTT04oKSB7DQogICAgICByZXR1cm4gdGhpcy50b1N0cmluZygpOw0KICAgIH0NCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJlcXVhbHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGVxdWFscyhvdGhlcikgewogICAgICByZXR1cm4gdGhpcy5lcmkgPT09IG90aGVyLmVyaSAmJiB0aGlzLmVjaSA9PT0gb3RoZXIuZWNpICYmIHRoaXMuc3JpID09PSBvdGhlci5zcmkgJiYgdGhpcy5zY2kgPT09IG90aGVyLnNjaTsKICAgIH0KICB9XSwgW3sKICAgIGtleTogInZhbHVlT2YiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHZhbHVlT2YocmVmKSB7CiAgICAgIC8vIEIxOkI4LCBCMSA9PiAxIHggMSBjZWxsIHJhbmdlCiAgICAgIHZhciByZWZzID0gcmVmLnNwbGl0KCc6Jyk7CgogICAgICB2YXIgX2V4cHIyeHkzID0gZXhwcjJ4eShyZWZzWzBdKSwKICAgICAgICAgIF9leHByMnh5NCA9IF9zbGljZWRUb0FycmF5KF9leHByMnh5MywgMiksCiAgICAgICAgICBzY2kgPSBfZXhwcjJ4eTRbMF0sCiAgICAgICAgICBzcmkgPSBfZXhwcjJ4eTRbMV07CgogICAgICB2YXIgZXJpID0gc3JpLAogICAgICAgICAgZWNpID0gc2NpOwoKICAgICAgaWYgKHJlZnMubGVuZ3RoID4gMSkgewogICAgICAgIHZhciBfZXhwcjJ4eTUgPSBleHByMnh5KHJlZnNbMV0pOwoKICAgICAgICB2YXIgX2V4cHIyeHk2ID0gX3NsaWNlZFRvQXJyYXkoX2V4cHIyeHk1LCAyKTsKCiAgICAgICAgZWNpID0gX2V4cHIyeHk2WzBdOwogICAgICAgIGVyaSA9IF9leHByMnh5NlsxXTsKICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBDZWxsUmFuZ2Uoc3JpLCBzY2ksIGVyaSwgZWNpKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBDZWxsUmFuZ2U7Cn0oKTsKCmV4cG9ydCBkZWZhdWx0IENlbGxSYW5nZTsKZXhwb3J0IHsgQ2VsbFJhbmdlIH07"},{"version":3,"sources":["D:/代码/del_demo/VisualizationExcle_Demo/src/components/x-spreadsheet/core/cell_range.js"],"names":["xy2expr","expr2xy","CellRange","sri","sci","eri","eci","w","h","ri","ci","args","length","cb","rowFilter","i","j","other","ret","addRet","push","dsr","dsc","der","dec","ref","multiple","refs","split"],"mappings":"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","sourcesContent":["import { xy2expr, expr2xy } from './alphabet';\r\n\r\nclass CellRange {\r\n  constructor(sri, sci, eri, eci, w = 0, h = 0) {\r\n    this.sri = sri;\r\n    this.sci = sci;\r\n    this.eri = eri;\r\n    this.eci = eci;\r\n    this.w = w;\r\n    this.h = h;\r\n  }\r\n\r\n  set(sri, sci, eri, eci) {\r\n    this.sri = sri;\r\n    this.sci = sci;\r\n    this.eri = eri;\r\n    this.eci = eci;\r\n  }\r\n\r\n  multiple() {\r\n    return this.eri - this.sri > 0 || this.eci - this.sci > 0;\r\n  }\r\n\r\n  // cell-index: ri, ci\r\n  // cell-ref: A10\r\n  includes(...args) {\r\n    let [ri, ci] = [0, 0];\r\n    if (args.length === 1) {\r\n      [ci, ri] = expr2xy(args[0]);\r\n    } else if (args.length === 2) {\r\n      [ri, ci] = args;\r\n    }\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    return sri <= ri && ri <= eri && sci <= ci && ci <= eci;\r\n  }\r\n\r\n  each(cb, rowFilter = () => true) {\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    for (let i = sri; i <= eri; i += 1) {\r\n      if (rowFilter(i)) {\r\n        for (let j = sci; j <= eci; j += 1) {\r\n          cb(i, j);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  contains(other) {\r\n    return this.sri <= other.sri\r\n      && this.sci <= other.sci\r\n      && this.eri >= other.eri\r\n      && this.eci >= other.eci;\r\n  }\r\n\r\n  // within\r\n  within(other) {\r\n    return this.sri >= other.sri\r\n      && this.sci >= other.sci\r\n      && this.eri <= other.eri\r\n      && this.eci <= other.eci;\r\n  }\r\n\r\n  // disjoint\r\n  disjoint(other) {\r\n    return this.sri > other.eri\r\n      || this.sci > other.eci\r\n      || other.sri > this.eri\r\n      || other.sci > this.eci;\r\n  }\r\n\r\n  // intersects\r\n  intersects(other) {\r\n    return this.sri <= other.eri\r\n      && this.sci <= other.eci\r\n      && other.sri <= this.eri\r\n      && other.sci <= this.eci;\r\n  }\r\n\r\n  // union\r\n  union(other) {\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    return new CellRange(\r\n      other.sri < sri ? other.sri : sri,\r\n      other.sci < sci ? other.sci : sci,\r\n      other.eri > eri ? other.eri : eri,\r\n      other.eci > eci ? other.eci : eci,\r\n    );\r\n  }\r\n\r\n  // intersection\r\n  // intersection(other) {}\r\n\r\n  // Returns Array<CellRange> that represents that part of this that does not intersect with other\r\n  // difference\r\n  difference(other) {\r\n    const ret = [];\r\n    const addRet = (sri, sci, eri, eci) => {\r\n      ret.push(new CellRange(sri, sci, eri, eci));\r\n    };\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    const dsr = other.sri - sri;\r\n    const dsc = other.sci - sci;\r\n    const der = eri - other.eri;\r\n    const dec = eci - other.eci;\r\n    if (dsr > 0) {\r\n      addRet(sri, sci, other.sri - 1, eci);\r\n      if (der > 0) {\r\n        addRet(other.eri + 1, sci, eri, eci);\r\n        if (dsc > 0) {\r\n          addRet(other.sri, sci, other.eri, other.sci - 1);\r\n        }\r\n        if (dec > 0) {\r\n          addRet(other.sri, other.eci + 1, other.eri, eci);\r\n        }\r\n      } else {\r\n        if (dsc > 0) {\r\n          addRet(other.sri, sci, eri, other.sci - 1);\r\n        }\r\n        if (dec > 0) {\r\n          addRet(other.sri, other.eci + 1, eri, eci);\r\n        }\r\n      }\r\n    } else if (der > 0) {\r\n      addRet(other.eri + 1, sci, eri, eci);\r\n      if (dsc > 0) {\r\n        addRet(sri, sci, other.eri, other.sci - 1);\r\n      }\r\n      if (dec > 0) {\r\n        addRet(sri, other.eci + 1, other.eri, eci);\r\n      }\r\n    }\r\n    if (dsc > 0) {\r\n      addRet(sri, sci, eri, other.sci - 1);\r\n      if (dec > 0) {\r\n        addRet(sri, other.eri + 1, eri, eci);\r\n        if (dsr > 0) {\r\n          addRet(sri, other.sci, other.sri - 1, other.eci);\r\n        }\r\n        if (der > 0) {\r\n          addRet(other.sri + 1, other.sci, eri, other.eci);\r\n        }\r\n      } else {\r\n        if (dsr > 0) {\r\n          addRet(sri, other.sci, other.sri - 1, eci);\r\n        }\r\n        if (der > 0) {\r\n          addRet(other.sri + 1, other.sci, eri, eci);\r\n        }\r\n      }\r\n    } else if (dec > 0) {\r\n      addRet(eri, other.eci + 1, eri, eci);\r\n      if (dsr > 0) {\r\n        addRet(sri, sci, other.sri - 1, other.eci);\r\n      }\r\n      if (der > 0) {\r\n        addRet(other.eri + 1, sci, eri, other.eci);\r\n      }\r\n    }\r\n    return ret;\r\n  }\r\n\r\n  size() {\r\n    return [\r\n      this.eri - this.sri + 1,\r\n      this.eci - this.sci + 1,\r\n    ];\r\n  }\r\n\r\n  toString() {\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = this;\r\n    let ref = xy2expr(sci, sri);\r\n    if (this.multiple()) {\r\n      ref = `${ref}:${xy2expr(eci, eri)}`;\r\n    }\r\n    return ref;\r\n  }\r\n\r\n  clone() {\r\n    const {\r\n      sri, sci, eri, eci, w, h,\r\n    } = this;\r\n    return new CellRange(sri, sci, eri, eci, w, h);\r\n  }\r\n\r\n  /*\r\n  toJSON() {\r\n    return this.toString();\r\n  }\r\n  */\r\n\r\n  equals(other) {\r\n    return this.eri === other.eri\r\n      && this.eci === other.eci\r\n      && this.sri === other.sri\r\n      && this.sci === other.sci;\r\n  }\r\n\r\n  static valueOf(ref) {\r\n    // B1:B8, B1 => 1 x 1 cell range\r\n    const refs = ref.split(':');\r\n    const [sci, sri] = expr2xy(refs[0]);\r\n    let [eri, eci] = [sri, sci];\r\n    if (refs.length > 1) {\r\n      [eci, eri] = expr2xy(refs[1]);\r\n    }\r\n    return new CellRange(sri, sci, eri, eci);\r\n  }\r\n}\r\n\r\nexport default CellRange;\r\n\r\nexport {\r\n  CellRange,\r\n};\r\n"]}]}