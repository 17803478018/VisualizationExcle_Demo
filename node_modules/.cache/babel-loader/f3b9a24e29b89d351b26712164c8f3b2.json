{"remainingRequest":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\component\\toolbar\\index.js","dependencies":[{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\component\\toolbar\\index.js","mtime":1616639586822},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616639573358},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1616639572994},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js","mtime":1616639576682}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJDOi9Vc2Vycy9cdTU0MzRcdTVFRkFcdTY2MEUvRGVza3RvcC9WaXN1YWxpemF0aW9uRXhjbGVfRGVtby9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkM6L1VzZXJzL1x1NTQzNFx1NUVGQVx1NjYwRS9EZXNrdG9wL1Zpc3VhbGl6YXRpb25FeGNsZV9EZW1vL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCBfc2xpY2VkVG9BcnJheSBmcm9tICJDOi9Vc2Vycy9cdTU0MzRcdTVFRkFcdTY2MEUvRGVza3RvcC9WaXN1YWxpemF0aW9uRXhjbGVfRGVtby9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmJvbGQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRhbGljcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zdHJpa2UuanMiOwoKLyogZ2xvYmFsIHdpbmRvdyAqLwppbXBvcnQgQWxpZ24gZnJvbSAnLi9hbGlnbic7CmltcG9ydCBWYWxpZ24gZnJvbSAnLi92YWxpZ24nOwppbXBvcnQgQXV0b2ZpbHRlciBmcm9tICcuL2F1dG9maWx0ZXInOwppbXBvcnQgQm9sZCBmcm9tICcuL2JvbGQnOwppbXBvcnQgSXRhbGljIGZyb20gJy4vaXRhbGljJzsKaW1wb3J0IFN0cmlrZSBmcm9tICcuL3N0cmlrZSc7CmltcG9ydCBVbmRlcmxpbmUgZnJvbSAnLi91bmRlcmxpbmUnOwppbXBvcnQgQm9yZGVyIGZyb20gJy4vYm9yZGVyJzsKaW1wb3J0IENsZWFyZm9ybWF0IGZyb20gJy4vY2xlYXJmb3JtYXQnOwppbXBvcnQgUGFpbnRmb3JtYXQgZnJvbSAnLi9wYWludGZvcm1hdCc7CmltcG9ydCBUZXh0Q29sb3IgZnJvbSAnLi90ZXh0X2NvbG9yJzsKaW1wb3J0IEZpbGxDb2xvciBmcm9tICcuL2ZpbGxfY29sb3InOwppbXBvcnQgRm9udFNpemUgZnJvbSAnLi9mb250X3NpemUnOwppbXBvcnQgRm9udCBmcm9tICcuL2ZvbnQnOwppbXBvcnQgRm9ybWF0IGZyb20gJy4vZm9ybWF0JzsKaW1wb3J0IEZvcm11bGEgZnJvbSAnLi9mb3JtdWxhJzsKaW1wb3J0IEZyZWV6ZSBmcm9tICcuL2ZyZWV6ZSc7CmltcG9ydCBNZXJnZSBmcm9tICcuL21lcmdlJzsKaW1wb3J0IFJlZG8gZnJvbSAnLi9yZWRvJzsKaW1wb3J0IFVuZG8gZnJvbSAnLi91bmRvJzsKaW1wb3J0IFByaW50IGZyb20gJy4vcHJpbnQnOwppbXBvcnQgVGV4dHdyYXAgZnJvbSAnLi90ZXh0d3JhcCc7CmltcG9ydCBNb3JlIGZyb20gJy4vbW9yZSc7CmltcG9ydCB7IGggfSBmcm9tICcuLi9lbGVtZW50JzsKaW1wb3J0IHsgY3NzUHJlZml4IH0gZnJvbSAnLi4vLi4vY29uZmlnJzsKaW1wb3J0IHsgYmluZCB9IGZyb20gJy4uL2V2ZW50JzsKCmZ1bmN0aW9uIGJ1aWxkRGl2aWRlcigpIHsKICByZXR1cm4gaCgnZGl2JywgIiIuY29uY2F0KGNzc1ByZWZpeCwgIi10b29sYmFyLWRpdmlkZXIiKSk7Cn0KCmZ1bmN0aW9uIGluaXRCdG5zMigpIHsKICB2YXIgX3RoaXMgPSB0aGlzOwoKICB0aGlzLmJ0bnMyID0gW107CiAgdGhpcy5pdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdCkgewogICAgaWYgKEFycmF5LmlzQXJyYXkoaXQpKSB7CiAgICAgIGl0LmZvckVhY2goZnVuY3Rpb24gKF9yZWYpIHsKICAgICAgICB2YXIgZWwgPSBfcmVmLmVsOwogICAgICAgIHZhciByZWN0ID0gZWwuYm94KCk7CgogICAgICAgIHZhciBfZWwkY29tcHV0ZWRTdHlsZSA9IGVsLmNvbXB1dGVkU3R5bGUoKSwKICAgICAgICAgICAgbWFyZ2luTGVmdCA9IF9lbCRjb21wdXRlZFN0eWxlLm1hcmdpbkxlZnQsCiAgICAgICAgICAgIG1hcmdpblJpZ2h0ID0gX2VsJGNvbXB1dGVkU3R5bGUubWFyZ2luUmlnaHQ7CgogICAgICAgIF90aGlzLmJ0bnMyLnB1c2goW2VsLCByZWN0LndpZHRoICsgcGFyc2VJbnQobWFyZ2luTGVmdCwgMTApICsgcGFyc2VJbnQobWFyZ2luUmlnaHQsIDEwKV0pOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIHZhciByZWN0ID0gaXQuYm94KCk7CgogICAgICB2YXIgX2l0JGNvbXB1dGVkU3R5bGUgPSBpdC5jb21wdXRlZFN0eWxlKCksCiAgICAgICAgICBtYXJnaW5MZWZ0ID0gX2l0JGNvbXB1dGVkU3R5bGUubWFyZ2luTGVmdCwKICAgICAgICAgIG1hcmdpblJpZ2h0ID0gX2l0JGNvbXB1dGVkU3R5bGUubWFyZ2luUmlnaHQ7CgogICAgICBfdGhpcy5idG5zMi5wdXNoKFtpdCwgcmVjdC53aWR0aCArIHBhcnNlSW50KG1hcmdpbkxlZnQsIDEwKSArIHBhcnNlSW50KG1hcmdpblJpZ2h0LCAxMCldKTsKICAgIH0KICB9KTsKfQoKZnVuY3Rpb24gbW9yZVJlc2l6ZSgpIHsKICB2YXIgX2J0bnMkaHRtbCwgX21vcmVCdG5zJGh0bWw7CgogIHZhciBlbCA9IHRoaXMuZWwsCiAgICAgIGJ0bnMgPSB0aGlzLmJ0bnMsCiAgICAgIG1vcmVFbCA9IHRoaXMubW9yZUVsLAogICAgICBidG5zMiA9IHRoaXMuYnRuczI7CiAgdmFyIF9tb3JlRWwkZGQgPSBtb3JlRWwuZGQsCiAgICAgIG1vcmVCdG5zID0gX21vcmVFbCRkZC5tb3JlQnRucywKICAgICAgY29udGVudEVsID0gX21vcmVFbCRkZC5jb250ZW50RWw7CiAgZWwuY3NzKCd3aWR0aCcsICIiLmNvbmNhdCh0aGlzLndpZHRoRm4oKSAtIDYwLCAicHgiKSk7CiAgdmFyIGVsQm94ID0gZWwuYm94KCk7CiAgdmFyIHN1bVdpZHRoID0gMTYwOwogIHZhciBzdW1XaWR0aDIgPSAxMjsKICB2YXIgbGlzdDEgPSBbXTsKICB2YXIgbGlzdDIgPSBbXTsKICBidG5zMi5mb3JFYWNoKGZ1bmN0aW9uIChfcmVmMiwgaW5kZXgpIHsKICAgIHZhciBfcmVmMyA9IF9zbGljZWRUb0FycmF5KF9yZWYyLCAyKSwKICAgICAgICBpdCA9IF9yZWYzWzBdLAogICAgICAgIHcgPSBfcmVmM1sxXTsKCiAgICBzdW1XaWR0aCArPSB3OwoKICAgIGlmIChpbmRleCA9PT0gYnRuczIubGVuZ3RoIC0gMSB8fCBzdW1XaWR0aCA8IGVsQm94LndpZHRoKSB7CiAgICAgIGxpc3QxLnB1c2goaXQpOwogICAgfSBlbHNlIHsKICAgICAgc3VtV2lkdGgyICs9IHc7CiAgICAgIGxpc3QyLnB1c2goaXQpOwogICAgfQogIH0pOwoKICAoX2J0bnMkaHRtbCA9IGJ0bnMuaHRtbCgnJykpLmNoaWxkcmVuLmFwcGx5KF9idG5zJGh0bWwsIGxpc3QxKTsKCiAgKF9tb3JlQnRucyRodG1sID0gbW9yZUJ0bnMuaHRtbCgnJykpLmNoaWxkcmVuLmFwcGx5KF9tb3JlQnRucyRodG1sLCBsaXN0Mik7CgogIGNvbnRlbnRFbC5jc3MoJ3dpZHRoJywgIiIuY29uY2F0KHN1bVdpZHRoMiwgInB4IikpOwoKICBpZiAobGlzdDIubGVuZ3RoID4gMCkgewogICAgbW9yZUVsLnNob3coKTsKICB9IGVsc2UgewogICAgbW9yZUVsLmhpZGUoKTsKICB9Cn0KCnZhciBUb29sYmFyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBUb29sYmFyKGRhdGEsIHdpZHRoRm4pIHsKICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgIHZhciBpc0hpZGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IGZhbHNlOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUb29sYmFyKTsKCiAgICB0aGlzLmRhdGEgPSBkYXRhOwoKICAgIHRoaXMuY2hhbmdlID0gZnVuY3Rpb24gKCkge307CgogICAgdGhpcy53aWR0aEZuID0gd2lkdGhGbjsKICAgIHRoaXMuaXNIaWRlID0gaXNIaWRlOwogICAgdmFyIHN0eWxlID0gZGF0YS5kZWZhdWx0U3R5bGUoKTsKICAgIHRoaXMuaXRlbXMgPSBbW3RoaXMudW5kb0VsID0gbmV3IFVuZG8oKSwgdGhpcy5yZWRvRWwgPSBuZXcgUmVkbygpLCBuZXcgUHJpbnQoKSwgdGhpcy5wYWludGZvcm1hdEVsID0gbmV3IFBhaW50Zm9ybWF0KCksIHRoaXMuY2xlYXJmb3JtYXRFbCA9IG5ldyBDbGVhcmZvcm1hdCgpXSwgYnVpbGREaXZpZGVyKCksIFt0aGlzLmZvcm1hdEVsID0gbmV3IEZvcm1hdCgpXSwgYnVpbGREaXZpZGVyKCksIFt0aGlzLmZvbnRFbCA9IG5ldyBGb250KCksIHRoaXMuZm9udFNpemVFbCA9IG5ldyBGb250U2l6ZSgpXSwgYnVpbGREaXZpZGVyKCksIFt0aGlzLmJvbGRFbCA9IG5ldyBCb2xkKCksIHRoaXMuaXRhbGljRWwgPSBuZXcgSXRhbGljKCksIHRoaXMudW5kZXJsaW5lRWwgPSBuZXcgVW5kZXJsaW5lKCksIHRoaXMuc3RyaWtlRWwgPSBuZXcgU3RyaWtlKCksIHRoaXMudGV4dENvbG9yRWwgPSBuZXcgVGV4dENvbG9yKHN0eWxlLmNvbG9yKV0sIGJ1aWxkRGl2aWRlcigpLCBbdGhpcy5maWxsQ29sb3JFbCA9IG5ldyBGaWxsQ29sb3Ioc3R5bGUuYmdjb2xvciksIHRoaXMuYm9yZGVyRWwgPSBuZXcgQm9yZGVyKCksIHRoaXMubWVyZ2VFbCA9IG5ldyBNZXJnZSgpXSwgYnVpbGREaXZpZGVyKCksIFt0aGlzLmFsaWduRWwgPSBuZXcgQWxpZ24oc3R5bGUuYWxpZ24pLCB0aGlzLnZhbGlnbkVsID0gbmV3IFZhbGlnbihzdHlsZS52YWxpZ24pLCB0aGlzLnRleHR3cmFwRWwgPSBuZXcgVGV4dHdyYXAoKV0sIGJ1aWxkRGl2aWRlcigpLCBbdGhpcy5mcmVlemVFbCA9IG5ldyBGcmVlemUoKSwgdGhpcy5hdXRvZmlsdGVyRWwgPSBuZXcgQXV0b2ZpbHRlcigpLCB0aGlzLmZvcm11bGFFbCA9IG5ldyBGb3JtdWxhKCksIHRoaXMubW9yZUVsID0gbmV3IE1vcmUoKV1dOwogICAgdGhpcy5lbCA9IGgoJ2RpdicsICIiLmNvbmNhdChjc3NQcmVmaXgsICItdG9vbGJhciIpKTsKICAgIHRoaXMuYnRucyA9IGgoJ2RpdicsICIiLmNvbmNhdChjc3NQcmVmaXgsICItdG9vbGJhci1idG5zIikpOwogICAgdGhpcy5pdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdCkgewogICAgICBpZiAoQXJyYXkuaXNBcnJheShpdCkpIHsKICAgICAgICBpdC5mb3JFYWNoKGZ1bmN0aW9uIChpKSB7CiAgICAgICAgICBfdGhpczIuYnRucy5jaGlsZChpLmVsKTsKCiAgICAgICAgICBpLmNoYW5nZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgX3RoaXMyLmNoYW5nZS5hcHBseShfdGhpczIsIGFyZ3VtZW50cyk7CiAgICAgICAgICB9OwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIF90aGlzMi5idG5zLmNoaWxkKGl0LmVsKTsKICAgICAgfQogICAgfSk7CiAgICB0aGlzLmVsLmNoaWxkKHRoaXMuYnRucyk7CgogICAgaWYgKGlzSGlkZSkgewogICAgICB0aGlzLmVsLmhpZGUoKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucmVzZXQoKTsKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgaW5pdEJ0bnMyLmNhbGwoX3RoaXMyKTsKICAgICAgICBtb3JlUmVzaXplLmNhbGwoX3RoaXMyKTsKICAgICAgfSwgMCk7CiAgICAgIGJpbmQod2luZG93LCAncmVzaXplJywgZnVuY3Rpb24gKCkgewogICAgICAgIG1vcmVSZXNpemUuY2FsbChfdGhpczIpOwogICAgICB9KTsKICAgIH0KICB9CgogIF9jcmVhdGVDbGFzcyhUb29sYmFyLCBbewogICAga2V5OiAicGFpbnRmb3JtYXRBY3RpdmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHBhaW50Zm9ybWF0QWN0aXZlKCkgewogICAgICByZXR1cm4gdGhpcy5wYWludGZvcm1hdEVsLmFjdGl2ZSgpOwogICAgfQogIH0sIHsKICAgIGtleTogInBhaW50Zm9ybWF0VG9nZ2xlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwYWludGZvcm1hdFRvZ2dsZSgpIHsKICAgICAgdGhpcy5wYWludGZvcm1hdEVsLnRvZ2dsZSgpOwogICAgfQogIH0sIHsKICAgIGtleTogInRyaWdnZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRyaWdnZXIodHlwZSkgewogICAgICB0aGlzWyIiLmNvbmNhdCh0eXBlLCAiRWwiKV0uY2xpY2soKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZXNldERhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2V0RGF0YShkYXRhKSB7CiAgICAgIHRoaXMuZGF0YSA9IGRhdGE7CiAgICAgIHRoaXMucmVzZXQoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZXNldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzZXQoKSB7CiAgICAgIGlmICh0aGlzLmlzSGlkZSkgcmV0dXJuOwogICAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTsKICAgICAgdmFyIHN0eWxlID0gZGF0YS5nZXRTZWxlY3RlZENlbGxTdHlsZSgpOyAvLyBjb25zb2xlLmxvZygnY2FuVW5kbzonLCBkYXRhLmNhblVuZG8oKSk7CgogICAgICB0aGlzLnVuZG9FbC5zZXRTdGF0ZSghZGF0YS5jYW5VbmRvKCkpOwogICAgICB0aGlzLnJlZG9FbC5zZXRTdGF0ZSghZGF0YS5jYW5SZWRvKCkpOwogICAgICB0aGlzLm1lcmdlRWwuc2V0U3RhdGUoZGF0YS5jYW5Vbm1lcmdlKCksICFkYXRhLnNlbGVjdG9yLm11bHRpcGxlKCkpOwogICAgICB0aGlzLmF1dG9maWx0ZXJFbC5zZXRTdGF0ZSghZGF0YS5jYW5BdXRvZmlsdGVyKCkpOyAvLyB0aGlzLm1lcmdlRWwuZGlzYWJsZWQoKTsKICAgICAgLy8gY29uc29sZS5sb2coJ3NlbGVjdGVkQ2VsbDonLCBzdHlsZSwgY2VsbCk7CgogICAgICB2YXIgZm9udCA9IHN0eWxlLmZvbnQsCiAgICAgICAgICBmb3JtYXQgPSBzdHlsZS5mb3JtYXQ7CiAgICAgIHRoaXMuZm9ybWF0RWwuc2V0U3RhdGUoZm9ybWF0KTsKICAgICAgdGhpcy5mb250RWwuc2V0U3RhdGUoZm9udC5uYW1lKTsKICAgICAgdGhpcy5mb250U2l6ZUVsLnNldFN0YXRlKGZvbnQuc2l6ZSk7CiAgICAgIHRoaXMuYm9sZEVsLnNldFN0YXRlKGZvbnQuYm9sZCk7CiAgICAgIHRoaXMuaXRhbGljRWwuc2V0U3RhdGUoZm9udC5pdGFsaWMpOwogICAgICB0aGlzLnVuZGVybGluZUVsLnNldFN0YXRlKHN0eWxlLnVuZGVybGluZSk7CiAgICAgIHRoaXMuc3RyaWtlRWwuc2V0U3RhdGUoc3R5bGUuc3RyaWtlKTsKICAgICAgdGhpcy50ZXh0Q29sb3JFbC5zZXRTdGF0ZShzdHlsZS5jb2xvcik7CiAgICAgIHRoaXMuZmlsbENvbG9yRWwuc2V0U3RhdGUoc3R5bGUuYmdjb2xvcik7CiAgICAgIHRoaXMuYWxpZ25FbC5zZXRTdGF0ZShzdHlsZS5hbGlnbik7CiAgICAgIHRoaXMudmFsaWduRWwuc2V0U3RhdGUoc3R5bGUudmFsaWduKTsKICAgICAgdGhpcy50ZXh0d3JhcEVsLnNldFN0YXRlKHN0eWxlLnRleHR3cmFwKTsgLy8gY29uc29sZS5sb2coJ2ZyZWV6ZSBpcyBBY3RpdmU6JywgZGF0YS5mcmVlemVJc0FjdGl2ZSgpKTsKCiAgICAgIHRoaXMuZnJlZXplRWwuc2V0U3RhdGUoZGF0YS5mcmVlemVJc0FjdGl2ZSgpKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBUb29sYmFyOwp9KCk7CgpleHBvcnQgeyBUb29sYmFyIGFzIGRlZmF1bHQgfTs="},{"version":3,"sources":["C:/Users/吴建明/Desktop/VisualizationExcle_Demo/src/components/x-spreadsheet/component/toolbar/index.js"],"names":["Align","Valign","Autofilter","Bold","Italic","Strike","Underline","Border","Clearformat","Paintformat","TextColor","FillColor","FontSize","Font","Format","Formula","Freeze","Merge","Redo","Undo","Print","Textwrap","More","h","cssPrefix","bind","buildDivider","initBtns2","btns2","items","forEach","it","Array","isArray","el","rect","box","computedStyle","marginLeft","marginRight","push","width","parseInt","moreResize","btns","moreEl","dd","moreBtns","contentEl","css","widthFn","elBox","sumWidth","sumWidth2","list1","list2","index","w","length","html","children","show","hide","Toolbar","data","isHide","change","style","defaultStyle","undoEl","redoEl","paintformatEl","clearformatEl","formatEl","fontEl","fontSizeEl","boldEl","italicEl","underlineEl","strikeEl","textColorEl","color","fillColorEl","bgcolor","borderEl","mergeEl","alignEl","align","valignEl","valign","textwrapEl","freezeEl","autofilterEl","formulaEl","i","child","reset","setTimeout","call","window","active","toggle","type","click","getSelectedCellStyle","setState","canUndo","canRedo","canUnmerge","selector","multiple","canAutofilter","font","format","name","size","bold","italic","underline","strike","textwrap","freezeIsActive"],"mappings":"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","sourcesContent":["/* global window */\r\n\r\nimport Align from './align';\r\nimport Valign from './valign';\r\nimport Autofilter from './autofilter';\r\nimport Bold from './bold';\r\nimport Italic from './italic';\r\nimport Strike from './strike';\r\nimport Underline from './underline';\r\nimport Border from './border';\r\nimport Clearformat from './clearformat';\r\nimport Paintformat from './paintformat';\r\nimport TextColor from './text_color';\r\nimport FillColor from './fill_color';\r\nimport FontSize from './font_size';\r\nimport Font from './font';\r\nimport Format from './format';\r\nimport Formula from './formula';\r\nimport Freeze from './freeze';\r\nimport Merge from './merge';\r\nimport Redo from './redo';\r\nimport Undo from './undo';\r\nimport Print from './print';\r\nimport Textwrap from './textwrap';\r\nimport More from './more';\r\n\r\nimport { h } from '../element';\r\nimport { cssPrefix } from '../../config';\r\nimport { bind } from '../event';\r\n\r\nfunction buildDivider() {\r\n  return h('div', `${cssPrefix}-toolbar-divider`);\r\n}\r\n\r\nfunction initBtns2() {\r\n  this.btns2 = [];\r\n  this.items.forEach((it) => {\r\n    if (Array.isArray(it)) {\r\n      it.forEach(({ el }) => {\r\n        const rect = el.box();\r\n        const { marginLeft, marginRight } = el.computedStyle();\r\n        this.btns2.push([el, rect.width + parseInt(marginLeft, 10) + parseInt(marginRight, 10)]);\r\n      });\r\n    } else {\r\n      const rect = it.box();\r\n      const { marginLeft, marginRight } = it.computedStyle();\r\n      this.btns2.push([it, rect.width + parseInt(marginLeft, 10) + parseInt(marginRight, 10)]);\r\n    }\r\n  });\r\n}\r\n\r\nfunction moreResize() {\r\n  const {\r\n    el, btns, moreEl, btns2,\r\n  } = this;\r\n  const { moreBtns, contentEl } = moreEl.dd;\r\n  el.css('width', `${this.widthFn() - 60}px`);\r\n  const elBox = el.box();\r\n\r\n  let sumWidth = 160;\r\n  let sumWidth2 = 12;\r\n  const list1 = [];\r\n  const list2 = [];\r\n  btns2.forEach(([it, w], index) => {\r\n    sumWidth += w;\r\n    if (index === btns2.length - 1 || sumWidth < elBox.width) {\r\n      list1.push(it);\r\n    } else {\r\n      sumWidth2 += w;\r\n      list2.push(it);\r\n    }\r\n  });\r\n  btns.html('').children(...list1);\r\n  moreBtns.html('').children(...list2);\r\n  contentEl.css('width', `${sumWidth2}px`);\r\n  if (list2.length > 0) {\r\n    moreEl.show();\r\n  } else {\r\n    moreEl.hide();\r\n  }\r\n}\r\n\r\nexport default class Toolbar {\r\n  constructor(data, widthFn, isHide = false) {\r\n    this.data = data;\r\n    this.change = () => {};\r\n    this.widthFn = widthFn;\r\n    this.isHide = isHide;\r\n    const style = data.defaultStyle();\r\n    this.items = [\r\n      [\r\n        this.undoEl = new Undo(),\r\n        this.redoEl = new Redo(),\r\n        new Print(),\r\n        this.paintformatEl = new Paintformat(),\r\n        this.clearformatEl = new Clearformat(),\r\n      ],\r\n      buildDivider(),\r\n      [\r\n        this.formatEl = new Format(),\r\n      ],\r\n      buildDivider(),\r\n      [\r\n        this.fontEl = new Font(),\r\n        this.fontSizeEl = new FontSize(),\r\n      ],\r\n      buildDivider(),\r\n      [\r\n        this.boldEl = new Bold(),\r\n        this.italicEl = new Italic(),\r\n        this.underlineEl = new Underline(),\r\n        this.strikeEl = new Strike(),\r\n        this.textColorEl = new TextColor(style.color),\r\n      ],\r\n      buildDivider(),\r\n      [\r\n        this.fillColorEl = new FillColor(style.bgcolor),\r\n        this.borderEl = new Border(),\r\n        this.mergeEl = new Merge(),\r\n      ],\r\n      buildDivider(),\r\n      [\r\n        this.alignEl = new Align(style.align),\r\n        this.valignEl = new Valign(style.valign),\r\n        this.textwrapEl = new Textwrap(),\r\n      ],\r\n      buildDivider(),\r\n      [\r\n        this.freezeEl = new Freeze(),\r\n        this.autofilterEl = new Autofilter(),\r\n        this.formulaEl = new Formula(),\r\n        this.moreEl = new More(),\r\n      ],\r\n    ];\r\n\r\n    this.el = h('div', `${cssPrefix}-toolbar`);\r\n    this.btns = h('div', `${cssPrefix}-toolbar-btns`);\r\n\r\n    this.items.forEach((it) => {\r\n      if (Array.isArray(it)) {\r\n        it.forEach((i) => {\r\n          this.btns.child(i.el);\r\n          i.change = (...args) => {\r\n            this.change(...args);\r\n          };\r\n        });\r\n      } else {\r\n        this.btns.child(it.el);\r\n      }\r\n    });\r\n\r\n    this.el.child(this.btns);\r\n    if (isHide) {\r\n      this.el.hide();\r\n    } else {\r\n      this.reset();\r\n      setTimeout(() => {\r\n        initBtns2.call(this);\r\n        moreResize.call(this);\r\n      }, 0);\r\n      bind(window, 'resize', () => {\r\n        moreResize.call(this);\r\n      });\r\n    }\r\n  }\r\n\r\n  paintformatActive() {\r\n    return this.paintformatEl.active();\r\n  }\r\n\r\n  paintformatToggle() {\r\n    this.paintformatEl.toggle();\r\n  }\r\n\r\n  trigger(type) {\r\n    this[`${type}El`].click();\r\n  }\r\n\r\n  resetData(data) {\r\n    this.data = data;\r\n    this.reset();\r\n  }\r\n\r\n  reset() {\r\n    if (this.isHide) return;\r\n    const { data } = this;\r\n    const style = data.getSelectedCellStyle();\r\n    // console.log('canUndo:', data.canUndo());\r\n    this.undoEl.setState(!data.canUndo());\r\n    this.redoEl.setState(!data.canRedo());\r\n    this.mergeEl.setState(data.canUnmerge(), !data.selector.multiple());\r\n    this.autofilterEl.setState(!data.canAutofilter());\r\n    // this.mergeEl.disabled();\r\n    // console.log('selectedCell:', style, cell);\r\n    const { font, format } = style;\r\n    this.formatEl.setState(format);\r\n    this.fontEl.setState(font.name);\r\n    this.fontSizeEl.setState(font.size);\r\n    this.boldEl.setState(font.bold);\r\n    this.italicEl.setState(font.italic);\r\n    this.underlineEl.setState(style.underline);\r\n    this.strikeEl.setState(style.strike);\r\n    this.textColorEl.setState(style.color);\r\n    this.fillColorEl.setState(style.bgcolor);\r\n    this.alignEl.setState(style.align);\r\n    this.valignEl.setState(style.valign);\r\n    this.textwrapEl.setState(style.textwrap);\r\n    // console.log('freeze is Active:', data.freezeIsActive());\r\n    this.freezeEl.setState(data.freezeIsActive());\r\n  }\r\n}\r\n"]}]}