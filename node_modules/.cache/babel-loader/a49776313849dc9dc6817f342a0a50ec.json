{"remainingRequest":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js!D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!D:\\代码\\del_demo\\VisualizationExcle_Demo\\src\\components\\TestExcel.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\src\\components\\TestExcel.vue","mtime":1614915429323},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596536485880},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1606828682259},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596536485880},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1609812452630}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkQ6L1x1NEVFM1x1NzgwMS9kZWxfZGVtby9WaXN1YWxpemF0aW9uRXhjbGVfRGVtby9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgU3ByZWFkc2hlZXQgZnJvbSAnQC9jb21wb25lbnRzL3gtc3ByZWFkc2hlZXQnOwppbXBvcnQgWFN0eWxlIGZyb20gJ3hsc3gtc3R5bGUnOwppbXBvcnQgRXhjaGFuZ2UgZnJvbSAnQC91dGlsL3hsc3gtZXhjaGFuZ2UnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlRlc3RFeGNlbCIsCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF90aGlzLmluc3RhbnRpYXRlU2hlZXQoKTsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSk7CiAgICB9KSkoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHJlcXVlc3RFeGNsZVN0cmVhbTogZnVuY3Rpb24gcmVxdWVzdEV4Y2xlU3RyZWFtKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGF4aW9zKHsKICAgICAgICBtZXRob2Q6ICdnZXQnLAogICAgICAgIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9leGNlbEV4cG9ydCcsCiAgICAgICAgcmVzcG9uc2VUeXBlOiAnYmxvYicKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgdmFyIHNlbGYgPSBfdGhpczI7CiAgICAgICAgdmFyIHJlc3VsdCA9IHJlcy5kYXRhOwogICAgICAgIGNvbnNvbGUubG9nKCdyZXN1bHQnLCByZXN1bHQpOyAvLyBkZWJ1Z2dlcgoKICAgICAgICBfdGhpczIuZmxvYkZpbGVTaXplID0gcmVzdWx0LnNpemUgfHwgMDsKCiAgICAgICAgaWYgKHJlc3VsdCBpbnN0YW5jZW9mIEJsb2IpIHsKICAgICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwoKICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICB2YXIgZGF0YSA9IGUudGFyZ2V0LnJlc3VsdDsKICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7CgogICAgICAgICAgICBpZiAoZGF0YSkgewogICAgICAgICAgICAgIHZhciB3b3JrYm9vayA9IFhTdHlsZS5yZWFkKGRhdGEsIHsKICAgICAgICAgICAgICAgIHR5cGU6ICJiaW5hcnkiLAogICAgICAgICAgICAgICAgY2VsbFN0eWxlczogdHJ1ZQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHZhciBvdXQgPSBFeGNoYW5nZS5zdG94KHdvcmtib29rKTsKICAgICAgICAgICAgICBzZWxmLnNldFhzaGVldERhdGEob3V0KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBzZWxmLnNldFhzaGVldERhdGEoW10pOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwoKICAgICAgICAgIHJlYWRlci5yZWFkQXNCaW5hcnlTdHJpbmcocmVzdWx0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc2VsZi5zZXRYc2hlZXREYXRhKFtdKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOiuvue9rnhzaGVldCDmlbDmja4KICAgIHNldFhzaGVldERhdGE6IGZ1bmN0aW9uIHNldFhzaGVldERhdGEob3V0KSB7CiAgICAgIHRoaXMuc2hlZXQubG9hZERhdGEob3V0KTsKCiAgICAgIGlmIChvdXQubGVuZ3RoKSB7CiAgICAgICAgdmFyIGNvbExlbiA9IE9iamVjdC5rZXlzKG91dFswXS5yb3dzWzBdLmNlbGxzKS5sZW5ndGggfHwgMTA7IC8vIGxldCBjb2xMZW4gPSB0aGlzLmdldFRhYmxlQ29sTGVuKG91dCkgfHwgMTA7CgogICAgICAgIHZhciByb3dMZW4gPSBPYmplY3Qua2V5cyhvdXRbMF0ucm93cykubGVuZ3RoIHx8IDEwOwogICAgICAgIHRoaXMuc2hlZXQuc2hlZXQuZGF0YS5yb3dzLmxlbiA9IHJvd0xlbjsKICAgICAgICB0aGlzLnNoZWV0LnNoZWV0LmRhdGEuY29scy5sZW4gPSBjb2xMZW47CiAgICAgICAgdGhpcy5zaGVldC5yZVJlbmRlcigpOwogICAgICB9CiAgICB9LAogICAgLy8g5a6e5L6L5YyWIHhzaGVldAogICAgaW5zdGFudGlhdGVTaGVldDogZnVuY3Rpb24gaW5zdGFudGlhdGVTaGVldCgpIHsKICAgICAgdmFyIHF1ZXJ5TGlzdEhlaWdodCA9IDA7CiAgICAgIGlmICh0aGlzLiRyZWZzLnF1ZXJ5TGlzdCkgcXVlcnlMaXN0SGVpZ2h0ID0gdGhpcy4kcmVmcy5xdWVyeUxpc3QuJGVsLm9mZnNldEhlaWdodCB8fCAwOwogICAgICB0aGlzLnNoZWV0ID0gbmV3IFNwcmVhZHNoZWV0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ4c3MtZGVtbyIpLCB7CiAgICAgICAgbW9kZTogInJlYWQiLAogICAgICAgIC8vIGVkaXQgfCByZWFkCiAgICAgICAgc2hvd1Rvb2xiYXI6IGZhbHNlLAogICAgICAgIHNob3dHcmlkOiBmYWxzZSwKICAgICAgICBzaG93Q29udGV4dG1lbnU6IGZhbHNlLAogICAgICAgIHZpZXc6IHsKICAgICAgICAgIGhlaWdodDogZnVuY3Rpb24gaGVpZ2h0KCkgewogICAgICAgICAgICByZXR1cm4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCAtIDE4MCAtIHF1ZXJ5TGlzdEhlaWdodDsKICAgICAgICAgIH0sCiAgICAgICAgICB3aWR0aDogZnVuY3Rpb24gd2lkdGgoKSB7CiAgICAgICAgICAgIHJldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggLSAzMDA7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICByb3c6IHsKICAgICAgICAgIGhlaWdodDogMjUsCiAgICAgICAgICBsZW46IDEwMAogICAgICAgIH0sCiAgICAgICAgY29sOiB7CiAgICAgICAgICBsZW46IDE2LAogICAgICAgICAgd2lkdGg6IDEwMCwKICAgICAgICAgIGluZGV4V2lkdGg6IDYwLAogICAgICAgICAgbWluV2lkdGg6IDYwCiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["D:\\代码\\del_demo\\VisualizationExcle_Demo\\src\\components\\TestExcel.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div>\r\n    <button class=\"btn\" @click=\"requestExcleStream\">测试</button>\r\n    <div class=\"content\">\r\n      <div id=\"xss-demo\" />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport Spreadsheet from '@/components/x-spreadsheet';\r\nimport XStyle from 'xlsx-style';\r\nimport Exchange from '@/util/xlsx-exchange';\r\nexport default {\r\n  name: \"TestExcel\",\r\n  async mounted() {\r\n    this.instantiateSheet();\r\n  },\r\n  methods: {\r\n    requestExcleStream() {\r\n      axios({\r\n        method: 'get',\r\n        url: 'http://localhost:3000/excelExport',\r\n        responseType: 'blob'\r\n      }).then((res) => {\r\n        const self = this\r\n        const result = res.data\r\n        console.log('result', result)\r\n        // debugger\r\n        this.flobFileSize = result.size || 0;\r\n        if (result instanceof Blob) {\r\n          var reader = new FileReader();\r\n          reader.onload = function (e) {\r\n            let data = e.target.result;\r\n            console.log(data)\r\n            if (data) {\r\n              let workbook = XStyle.read(data, { type: \"binary\", cellStyles: true });\r\n              let out = Exchange.stox(workbook);\r\n              self.setXsheetData(out)\r\n            } else {\r\n              self.setXsheetData([])\r\n            }\r\n          };\r\n          reader.readAsBinaryString(result);\r\n        } else {\r\n          self.setXsheetData([])\r\n        }\r\n      })\r\n    },\r\n    // 设置xsheet 数据\r\n    setXsheetData(out) {\r\n      this.sheet.loadData(out);\r\n      if (out.length) {\r\n        let colLen = Object.keys(out[0].rows[0].cells).length || 10;\r\n        // let colLen = this.getTableColLen(out) || 10;\r\n        let rowLen = Object.keys(out[0].rows).length || 10;\r\n        this.sheet.sheet.data.rows.len = rowLen;\r\n        this.sheet.sheet.data.cols.len = colLen;\r\n        this.sheet.reRender();\r\n      }\r\n    },\r\n    // 实例化 xsheet\r\n    instantiateSheet() {\r\n      let queryListHeight = 0;\r\n      if (this.$refs.queryList)\r\n        queryListHeight = this.$refs.queryList.$el.offsetHeight || 0;\r\n      this.sheet = new Spreadsheet(document.getElementById(\"xss-demo\"), {\r\n        mode: \"read\", // edit | read\r\n        showToolbar: false,\r\n        showGrid: false,\r\n        showContextmenu: false,\r\n        view: {\r\n          height: () =>\r\n            document.documentElement.clientHeight - 180 - queryListHeight,\r\n          width: () => document.documentElement.clientWidth - 300,\r\n        },\r\n        row: {\r\n          height: 25,\r\n          len: 100,\r\n        },\r\n        col: {\r\n          len: 16,\r\n          width: 100,\r\n          indexWidth: 60,\r\n          minWidth: 60,\r\n        },\r\n      });\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.btn {\r\n  width: 100px;\r\n  height: 36px;\r\n  cursor: pointer;\r\n}\r\n</style>"],"sourceRoot":""}]}