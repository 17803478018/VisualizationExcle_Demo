{"remainingRequest":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\util\\xlsx-exchange\\exchange.js","dependencies":[{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\util\\xlsx-exchange\\exchange.js","mtime":1616639586847},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616639573358},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1616639572994},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js","mtime":1616639576682}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbGwuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5ib2xkLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0IFhMU1ggZnJvbSAneGxzeCc7CnZhciBFeGNoYW5nZSA9IHsKICAvL2V4Y2VsIC0+IGRhdGEKICBzdG94OiBmdW5jdGlvbiBzdG94KHdiKSB7CiAgICB2YXIgb3V0ID0gW107CiAgICB3Yi5TaGVldE5hbWVzLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgdmFyIG8gPSB7CiAgICAgICAgbmFtZTogbmFtZSwKICAgICAgICByb3dzOiB7fSwKICAgICAgICBjb2xzOiB7fSwKICAgICAgICBtZXJnZXM6IFtdLAogICAgICAgIHN0eWxlczogW10KICAgICAgfTsKICAgICAgdmFyIHdzID0gd2IuU2hlZXRzW25hbWVdOwogICAgICBjb25zb2xlLmxvZygnbmFtZSA6Pj4gJywgbmFtZSk7CiAgICAgIHdzWychY29scyddICYmIGNvbnNvbGUubG9nKCd3c1sgOj4+ICcsIHdzKTsKICAgICAgdmFyIGFvYSA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbih3cywgewogICAgICAgIHJhdzogdHJ1ZSwKICAgICAgICByYXdOdW1iZXJzOiBmYWxzZSwKICAgICAgICBoZWFkZXI6IDEKICAgICAgfSk7IC8v6I635Y+WY2VsbOWGheWuuQoKICAgICAgdmFyIHN0eWxlSW5kZXggPSAwOwogICAgICBhb2EuZm9yRWFjaChmdW5jdGlvbiAociwgaSkgewogICAgICAgIHZhciBjZWxscyA9IHt9OwogICAgICAgIHIuZm9yRWFjaChmdW5jdGlvbiAoYywgaikgewogICAgICAgICAgdmFyIGNlbGxJbmRleCA9IFhMU1gudXRpbHMuZW5jb2RlX2NlbGwoewogICAgICAgICAgICBjOiBqLAogICAgICAgICAgICByOiBpCiAgICAgICAgICB9KTsKICAgICAgICAgIGNlbGxzW2pdID0gewogICAgICAgICAgICB0ZXh0OiBjCiAgICAgICAgICB9OwoKICAgICAgICAgIGlmICh3c1tjZWxsSW5kZXhdICYmIHdzW2NlbGxJbmRleF1bJ3MnXSkgewogICAgICAgICAgICB2YXIgY2VsbHN0eWxlID0gd3NbY2VsbEluZGV4XVsncyddOwogICAgICAgICAgICB2YXIgb0NlbGxzdHlsZSA9IHt9OyAvL+Whq+WFhQoKICAgICAgICAgICAgaWYgKGNlbGxzdHlsZVsnZmlsbCddKSB7CiAgICAgICAgICAgICAgdmFyIGJnYXJnYiA9IGNlbGxzdHlsZVsnZmlsbCddWydmZ0NvbG9yJ11bJ3JnYiddOwoKICAgICAgICAgICAgICBpZiAoYmdhcmdiICYmIGJnYXJnYi5sZW5ndGggPT0gNikgewogICAgICAgICAgICAgICAgb0NlbGxzdHlsZS5iZ2NvbG9yID0gJyMnICsgYmdhcmdiOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAoYmdhcmdiICYmIGJnYXJnYi5sZW5ndGggPT0gOCkgewogICAgICAgICAgICAgICAgb0NlbGxzdHlsZS5iZ2NvbG9yID0gJyMnICsgYmdhcmdiLnNsaWNlKDIpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSAvL+Wtl+S9kwoKCiAgICAgICAgICAgIGlmIChjZWxsc3R5bGVbJ2ZvbnQnXSkgewogICAgICAgICAgICAgIG9DZWxsc3R5bGUuZm9udCA9IHsKICAgICAgICAgICAgICAgIGJvbGQ6IGNlbGxzdHlsZVsnZm9udCddWydib2xkJ10gfHwgZmFsc2UsCiAgICAgICAgICAgICAgICBzaXplOiBjZWxsc3R5bGVbJ2ZvbnQnXVsnc3onXSB8fCAxMQogICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgIGlmIChjZWxsc3R5bGVbJ2ZvbnQnXVsnY29sb3InXSkgewogICAgICAgICAgICAgICAgdmFyIGZjYXJnYiA9IGNlbGxzdHlsZVsnZm9udCddWydjb2xvciddWydyZ2InXTsKCiAgICAgICAgICAgICAgICBpZiAoZmNhcmdiICYmIGZjYXJnYi5sZW5ndGggPT0gNikgewogICAgICAgICAgICAgICAgICBpZiAoZmNhcmdiID09ICcwMDAwMDAnKSB7CiAgICAgICAgICAgICAgICAgICAgb0NlbGxzdHlsZS5jb2xvciA9ICcjRkZGRkZGJzsKICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmY2FyZ2IgPT0gJ0ZGRkZGRicpIHsKICAgICAgICAgICAgICAgICAgICBvQ2VsbHN0eWxlLmNvbG9yID0gJyMwMDAwMDAnOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIG9DZWxsc3R5bGUuY29sb3IgPSAnIycgKyBmY2FyZ2I7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZmNhcmdiICYmIGZjYXJnYi5sZW5ndGggPT0gOCkgewogICAgICAgICAgICAgICAgICBvQ2VsbHN0eWxlLmNvbG9yID0gJyMnICsgZmNhcmdiLnNsaWNlKDIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSAvL+i+ueahhgoKCiAgICAgICAgICAgIGlmIChjZWxsc3R5bGVbJ2JvcmRlciddKSB7CiAgICAgICAgICAgICAgb0NlbGxzdHlsZS5ib3JkZXIgPSB7fTsKCiAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGNlbGxzdHlsZVsnYm9yZGVyJ10pIHsKICAgICAgICAgICAgICAgIGlmIChjZWxsc3R5bGVbJ2JvcmRlciddW2tleV1bJ2NvbG9yJ10pIHsKICAgICAgICAgICAgICAgICAgdmFyIGJyYXJnYiA9IGNlbGxzdHlsZVsnYm9yZGVyJ11ba2V5XVsnY29sb3InXVsncmdiJ107CgogICAgICAgICAgICAgICAgICBpZiAoYmdhcmdiICYmIGJnYXJnYi5sZW5ndGggPT0gNikgewogICAgICAgICAgICAgICAgICAgIHZhciBvYnJhcmdiID0gYnJhcmdiID8gJyMnICsgYnJhcmdiIDogIiMwMDAwMDAiOwogICAgICAgICAgICAgICAgICAgIG9DZWxsc3R5bGUuYm9yZGVyW2tleV0gPSBbY2VsbHN0eWxlWydib3JkZXInXVtrZXldWydzdHlsZSddLCBvYnJhcmdiXTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChiZ2FyZ2IgJiYgYmdhcmdiLmxlbmd0aCA9PSA4KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIF9vYnJhcmdiID0gYnJhcmdiID8gJyMnICsgYnJhcmdiLnNsaWNlKDIpIDogIiMwMDAwMDAiOwoKICAgICAgICAgICAgICAgICAgICBvQ2VsbHN0eWxlLmJvcmRlcltrZXldID0gW2NlbGxzdHlsZVsnYm9yZGVyJ11ba2V5XVsnc3R5bGUnXSwgX29icmFyZ2JdOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIG9DZWxsc3R5bGUuYm9yZGVyW2tleV0gPSBicmFyZ2IgPyBbJ3RoaW4nLCAiIi5jb25jYXQoYnJhcmdiLnNsaWNlKDIpKV0gOiBbJ3RoaW4nLCAnIzAwMCddOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IC8v5a+56b2QCgoKICAgICAgICAgICAgaWYgKGNlbGxzdHlsZVsnYWxpZ25tZW50J10pIHsKICAgICAgICAgICAgICB2YXIgYWxpZ24gPSBjZWxsc3R5bGVbJ2FsaWdubWVudCddWydob3Jpem9udGFsJ107CiAgICAgICAgICAgICAgb0NlbGxzdHlsZS5hbGlnbiA9IGFsaWduID8gYWxpZ24gOiAnY2VudGVyJzsKICAgICAgICAgICAgICB2YXIgdmFsaWduID0gY2VsbHN0eWxlWydhbGlnbm1lbnQnXVsndmVydGljYWwnXTsKICAgICAgICAgICAgICBvQ2VsbHN0eWxlLnZhbGlnbiA9ICF2YWxpZ24gfHwgdmFsaWduID09ICdjZW50ZXInID8gJ21pZGRsZScgOiB2YWxpZ247CiAgICAgICAgICAgIH0gLy8gIGVsc2UgewogICAgICAgICAgICAvLyAgIG9DZWxsc3R5bGUuYWxpZ24gPSAnY2VudGVyJwogICAgICAgICAgICAvLyAgIG9DZWxsc3R5bGUudmFsaWduID0gJ21pZGRsZScKICAgICAgICAgICAgLy8gfQoKCiAgICAgICAgICAgIGNlbGxzW2pdLnN0eWxlID0gc3R5bGVJbmRleDsKICAgICAgICAgICAgby5zdHlsZXNbc3R5bGVJbmRleF0gPSBvQ2VsbHN0eWxlOwogICAgICAgICAgICBzdHlsZUluZGV4Kys7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjZWxsc1tqXS5zdHlsZSA9IHN0eWxlSW5kZXg7CiAgICAgICAgICAgIG8uc3R5bGVzW3N0eWxlSW5kZXhdID0gewogICAgICAgICAgICAgIGFsaWduOiAnY2VudGVyJywKICAgICAgICAgICAgICB2YWxpZ246ICdtaWRkbGUnCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHN0eWxlSW5kZXgrKzsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBvLnJvd3NbaV0gPSB7CiAgICAgICAgICBjZWxsczogY2VsbHMKICAgICAgICB9OwogICAgICB9KTsgLy/ojrflj5blkIjlubbljZXlhYPmoLwKCiAgICAgIGlmICh3c1siIW1lcmdlcyJdKSB7CiAgICAgICAgdmFyIG1lcmdlcyA9IHdzWyIhbWVyZ2VzIl07CiAgICAgICAgbWVyZ2VzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIHZhciByTWVyZ2UgPSBpdGVtLmUuciAtIGl0ZW0ucy5yOwogICAgICAgICAgdmFyIGNNZXJnZSA9IGl0ZW0uZS5jIC0gaXRlbS5zLmM7CiAgICAgICAgICB2YXIgcmFuZ2UgPSBYTFNYLnV0aWxzLmVuY29kZV9yYW5nZShpdGVtKTsKCiAgICAgICAgICBpZiAoby5yb3dzW2l0ZW0ucy5yXVsiY2VsbHMiXVtpdGVtLnMuY10pIHsKICAgICAgICAgICAgby5yb3dzW2l0ZW0ucy5yXVsiY2VsbHMiXVtpdGVtLnMuY10ubWVyZ2UgPSBbck1lcmdlLCBjTWVyZ2VdOwogICAgICAgICAgICBvLm1lcmdlcy5wdXNoKHJhbmdlKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSAvL+iOt+WPluWIl+WuveW6pgoKCiAgICAgIGlmICh3c1siIWNvbHMiXSkgewogICAgICAgIHZhciBjb2xzID0gd3NbIiFjb2xzIl07CiAgICAgICAgY29scy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpbmRleCkgewogICAgICAgICAgby5jb2xzW2luZGV4XSA9IHt9OwogICAgICAgICAgby5jb2xzW2luZGV4XVsid2lkdGgiXSA9IGl0ZW0ud3B4OwogICAgICAgIH0pOwogICAgICB9CgogICAgICBvdXQucHVzaChvKTsKICAgIH0pOwogICAgcmV0dXJuIG91dDsKICB9LAogIC8vZGF0YSAtPiBleGNlbAogIHh0b3M6IGZ1bmN0aW9uIHh0b3Moc2RhdGEpIHsKICAgIHZhciBvdXQgPSBYTFNYLnV0aWxzLmJvb2tfbmV3KCk7CiAgICBzZGF0YS5mb3JFYWNoKGZ1bmN0aW9uICh4d3MpIHsKICAgICAgdmFyIGFvYSA9IFtbXV07CiAgICAgIHZhciByb3dvYmogPSB4d3Mucm93czsKCiAgICAgIGZvciAodmFyIHJpID0gMDsgcmkgPCByb3dvYmoubGVuOyArK3JpKSB7CiAgICAgICAgdmFyIHJvdyA9IHJvd29ialtyaV07CiAgICAgICAgaWYgKCFyb3cpIGNvbnRpbnVlOwogICAgICAgIGFvYVtyaV0gPSBbXTsKICAgICAgICBPYmplY3Qua2V5cyhyb3cuY2VsbHMpLmZvckVhY2goZnVuY3Rpb24gKGspIHsKICAgICAgICAgIHZhciBpZHggPSArazsKICAgICAgICAgIGlmIChpc05hTihpZHgpKSByZXR1cm47CiAgICAgICAgICBhb2FbcmldW2lkeF0gPSByb3cuY2VsbHNba10udGV4dDsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdmFyIHdzID0gWExTWC51dGlscy5hb2FfdG9fc2hlZXQoYW9hKTsKICAgICAgWExTWC51dGlscy5ib29rX2FwcGVuZF9zaGVldChvdXQsIHdzLCB4d3MubmFtZSk7CiAgICB9KTsKICAgIHJldHVybiBvdXQ7CiAgfQp9OwpleHBvcnQgZGVmYXVsdCBFeGNoYW5nZTs="},{"version":3,"sources":["C:/Users/吴建明/Desktop/VisualizationExcle_Demo/src/util/xlsx-exchange/exchange.js"],"names":["XLSX","Exchange","stox","wb","out","SheetNames","forEach","name","o","rows","cols","merges","styles","ws","Sheets","console","log","aoa","utils","sheet_to_json","raw","rawNumbers","header","styleIndex","r","i","cells","c","j","cellIndex","encode_cell","text","cellstyle","oCellstyle","bgargb","length","bgcolor","slice","font","bold","size","fcargb","color","border","key","brargb","obrargb","align","valign","style","item","rMerge","e","s","cMerge","range","encode_range","merge","push","index","wpx","xtos","sdata","book_new","xws","rowobj","ri","len","row","Object","keys","k","idx","isNaN","aoa_to_sheet","book_append_sheet"],"mappings":"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","sourcesContent":["import XLSX from 'xlsx'\r\nconst Exchange = {\r\n  //excel -> data\r\n  stox(wb) {\r\n    var out = [];\r\n    wb.SheetNames.forEach(function (name) {\r\n      var o = {\r\n        name: name,\r\n        rows: {},\r\n        cols: {},\r\n        merges: [],\r\n        styles: []\r\n      };\r\n      var ws = wb.Sheets[name];\r\n      console.log('name :>> ', name);\r\n      ws['!cols'] && console.log('ws[ :>> ', ws);\r\n      var aoa = XLSX.utils.sheet_to_json(ws, {\r\n        raw: true,\r\n        rawNumbers: false,\r\n        header: 1\r\n      });\r\n      //获取cell内容\r\n      let styleIndex = 0;\r\n      aoa.forEach(function (r, i) {\r\n        var cells = {};\r\n        r.forEach(function (c, j) {\r\n          let cellIndex = XLSX.utils.encode_cell({\r\n            c: j,\r\n            r: i\r\n          });\r\n          cells[j] = {\r\n            text: c\r\n          }\r\n\r\n          if (ws[cellIndex] && ws[cellIndex]['s']) {\r\n            let cellstyle = ws[cellIndex]['s'];\r\n            let oCellstyle = {};\r\n\r\n            //填充\r\n            if (cellstyle['fill']) {\r\n              var bgargb = cellstyle['fill']['fgColor']['rgb'];\r\n              if (bgargb && bgargb.length == 6) {\r\n                oCellstyle.bgcolor = '#' + bgargb;\r\n              } else if (bgargb && bgargb.length == 8) {\r\n                oCellstyle.bgcolor = '#' + bgargb.slice(2);\r\n              }\r\n            }\r\n            //字体\r\n            if (cellstyle['font']) {\r\n              oCellstyle.font = {\r\n                bold: cellstyle['font']['bold'] || false,\r\n                size: cellstyle['font']['sz'] || 11\r\n              }\r\n              if (cellstyle['font']['color']) {\r\n                var fcargb = cellstyle['font']['color']['rgb'];\r\n                if (fcargb && fcargb.length == 6) {\r\n                  if (fcargb == '000000') {\r\n                    oCellstyle.color = '#FFFFFF';\r\n                  } else if (fcargb == 'FFFFFF') {\r\n                    oCellstyle.color = '#000000';\r\n                  } else {\r\n                    oCellstyle.color = '#' + fcargb;\r\n                  }\r\n                } else if (fcargb && fcargb.length == 8) {\r\n                  oCellstyle.color = '#' + fcargb.slice(2);\r\n                }\r\n              }\r\n            }\r\n            //边框\r\n            if (cellstyle['border']) {\r\n              oCellstyle.border = {};\r\n              for (var key in cellstyle['border']) {\r\n                if (cellstyle['border'][key]['color']) {\r\n                  let brargb = cellstyle['border'][key]['color']['rgb'];\r\n                  if (bgargb && bgargb.length == 6) {\r\n                    let obrargb = brargb ? '#' + brargb : \"#000000\";\r\n                    oCellstyle.border[key] = [cellstyle['border'][key]['style'], obrargb];\r\n                  } else if (bgargb && bgargb.length == 8) {\r\n                    let obrargb = brargb ? '#' + brargb.slice(2) : \"#000000\";\r\n                    oCellstyle.border[key] = [cellstyle['border'][key]['style'], obrargb];\r\n                  } else {\r\n                    oCellstyle.border[key] = brargb ? ['thin', `${brargb.slice(2)}`] : ['thin', '#000']\r\n                  }\r\n                }\r\n              }\r\n            }\r\n            //对齐\r\n            if (cellstyle['alignment']) {\r\n              let align = cellstyle['alignment']['horizontal'];\r\n              oCellstyle.align = align ? align : 'center';\r\n              let valign = cellstyle['alignment']['vertical'];\r\n              oCellstyle.valign = (!valign || valign == 'center') ? 'middle' : valign;\r\n            }\r\n            //  else {\r\n            //   oCellstyle.align = 'center'\r\n            //   oCellstyle.valign = 'middle'\r\n            // }\r\n            cells[j].style = styleIndex;\r\n            o.styles[styleIndex] = oCellstyle;\r\n            styleIndex++;\r\n          } else {\r\n            cells[j].style = styleIndex;\r\n            o.styles[styleIndex] = {\r\n              align: 'center',\r\n              valign: 'middle',\r\n            }\r\n            styleIndex++;\r\n          }\r\n        });\r\n\r\n        o.rows[i] = {\r\n          cells: cells\r\n        };\r\n      });\r\n      //获取合并单元格\r\n      if (ws[\"!merges\"]) {\r\n        let merges = ws[\"!merges\"];\r\n        merges.forEach(item => {\r\n          let rMerge = item.e.r - item.s.r;\r\n          let cMerge = item.e.c - item.s.c;\r\n          let range = XLSX.utils.encode_range(item);\r\n          if (o.rows[item.s.r][\"cells\"][item.s.c]) {\r\n            o.rows[item.s.r][\"cells\"][item.s.c].merge = [rMerge, cMerge];\r\n            o.merges.push(range);\r\n          }\r\n        });\r\n      }\r\n      //获取列宽度\r\n      if (ws[\"!cols\"]) {\r\n        let cols = ws[\"!cols\"];\r\n        cols.forEach((item, index) => {\r\n          o.cols[index] = {};\r\n          o.cols[index][\"width\"] = item.wpx;\r\n        })\r\n      }\r\n\r\n      out.push(o);\r\n    });\r\n    return out;\r\n  },\r\n  //data -> excel\r\n  xtos(sdata) {\r\n    var out = XLSX.utils.book_new();\r\n    sdata.forEach(function (xws) {\r\n      var aoa = [\r\n        []\r\n      ];\r\n      var rowobj = xws.rows;\r\n      for (var ri = 0; ri < rowobj.len; ++ri) {\r\n        var row = rowobj[ri];\r\n        if (!row) continue;\r\n        aoa[ri] = [];\r\n        Object.keys(row.cells).forEach(function (k) {\r\n          var idx = +k;\r\n          if (isNaN(idx)) return;\r\n          aoa[ri][idx] = row.cells[k].text;\r\n        });\r\n      }\r\n      var ws = XLSX.utils.aoa_to_sheet(aoa);\r\n      XLSX.utils.book_append_sheet(out, ws, xws.name);\r\n    });\r\n    return out;\r\n  },\r\n}\r\n\r\nexport default Exchange;\r\n"]}]}