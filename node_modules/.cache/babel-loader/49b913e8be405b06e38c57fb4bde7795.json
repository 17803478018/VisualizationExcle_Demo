{"remainingRequest":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js!D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\代码\\del_demo\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\component\\contextmenu.js","dependencies":[{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\component\\contextmenu.js","mtime":1614915429331},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596536485880},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1606828682259},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js","mtime":1603719226989}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJEOi9cdTRFRTNcdTc4MDEvZGVsX2RlbW8vVmlzdWFsaXphdGlvbkV4Y2xlX0RlbW8vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5IjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJEOi9cdTRFRTNcdTc4MDEvZGVsX2RlbW8vVmlzdWFsaXphdGlvbkV4Y2xlX0RlbW8vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJEOi9cdTRFRTNcdTc4MDEvZGVsX2RlbW8vVmlzdWFsaXphdGlvbkV4Y2xlX0RlbW8vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0IHsgaCB9IGZyb20gJy4vZWxlbWVudCc7CmltcG9ydCB7IGJpbmRDbGlja291dHNpZGUsIHVuYmluZENsaWNrb3V0c2lkZSB9IGZyb20gJy4vZXZlbnQnOwppbXBvcnQgeyBjc3NQcmVmaXggfSBmcm9tICcuLi9jb25maWcnOwppbXBvcnQgeyB0ZiB9IGZyb20gJy4uL2xvY2FsZS9sb2NhbGUnOwp2YXIgbWVudUl0ZW1zID0gW3sKICBrZXk6ICdjb3B5JywKICB0aXRsZTogdGYoJ2NvbnRleHRtZW51LmNvcHknKSwKICBsYWJlbDogJ0N0cmwrQycKfSwgewogIGtleTogJ2N1dCcsCiAgdGl0bGU6IHRmKCdjb250ZXh0bWVudS5jdXQnKSwKICBsYWJlbDogJ0N0cmwrWCcKfSwgewogIGtleTogJ3Bhc3RlJywKICB0aXRsZTogdGYoJ2NvbnRleHRtZW51LnBhc3RlJyksCiAgbGFiZWw6ICdDdHJsK1YnCn0sIHsKICBrZXk6ICdwYXN0ZS12YWx1ZScsCiAgdGl0bGU6IHRmKCdjb250ZXh0bWVudS5wYXN0ZVZhbHVlJyksCiAgbGFiZWw6ICdDdHJsK1NoaWZ0K1YnCn0sIHsKICBrZXk6ICdwYXN0ZS1mb3JtYXQnLAogIHRpdGxlOiB0ZignY29udGV4dG1lbnUucGFzdGVGb3JtYXQnKSwKICBsYWJlbDogJ0N0cmwrQWx0K1YnCn0sIHsKICBrZXk6ICdkaXZpZGVyJwp9LCB7CiAga2V5OiAnaW5zZXJ0LXJvdycsCiAgdGl0bGU6IHRmKCdjb250ZXh0bWVudS5pbnNlcnRSb3cnKQp9LCB7CiAga2V5OiAnaW5zZXJ0LWNvbHVtbicsCiAgdGl0bGU6IHRmKCdjb250ZXh0bWVudS5pbnNlcnRDb2x1bW4nKQp9LCB7CiAga2V5OiAnZGl2aWRlcicKfSwgewogIGtleTogJ2RlbGV0ZS1yb3cnLAogIHRpdGxlOiB0ZignY29udGV4dG1lbnUuZGVsZXRlUm93JykKfSwgewogIGtleTogJ2RlbGV0ZS1jb2x1bW4nLAogIHRpdGxlOiB0ZignY29udGV4dG1lbnUuZGVsZXRlQ29sdW1uJykKfSwgewogIGtleTogJ2RlbGV0ZS1jZWxsLXRleHQnLAogIHRpdGxlOiB0ZignY29udGV4dG1lbnUuZGVsZXRlQ2VsbFRleHQnKQp9LCB7CiAga2V5OiAnaGlkZScsCiAgdGl0bGU6IHRmKCdjb250ZXh0bWVudS5oaWRlJykKfSwgewogIGtleTogJ2RpdmlkZXInCn0sIHsKICBrZXk6ICd2YWxpZGF0aW9uJywKICB0aXRsZTogdGYoJ2NvbnRleHRtZW51LnZhbGlkYXRpb24nKQp9LCB7CiAga2V5OiAnZGl2aWRlcicKfSwgewogIGtleTogJ2NlbGwtcHJpbnRhYmxlJywKICB0aXRsZTogdGYoJ2NvbnRleHRtZW51LmNlbGxwcmludGFibGUnKQp9LCB7CiAga2V5OiAnY2VsbC1ub24tcHJpbnRhYmxlJywKICB0aXRsZTogdGYoJ2NvbnRleHRtZW51LmNlbGxub25wcmludGFibGUnKQp9LCB7CiAga2V5OiAnZGl2aWRlcicKfSwgewogIGtleTogJ2NlbGwtZWRpdGFibGUnLAogIHRpdGxlOiB0ZignY29udGV4dG1lbnUuY2VsbGVkaXRhYmxlJykKfSwgewogIGtleTogJ2NlbGwtbm9uLWVkaXRhYmxlJywKICB0aXRsZTogdGYoJ2NvbnRleHRtZW51LmNlbGxub25lZGl0YWJsZScpCn1dOwoKZnVuY3Rpb24gYnVpbGRNZW51SXRlbShpdGVtKSB7CiAgdmFyIF90aGlzID0gdGhpczsKCiAgaWYgKGl0ZW0ua2V5ID09PSAnZGl2aWRlcicpIHsKICAgIHJldHVybiBoKCdkaXYnLCAiIi5jb25jYXQoY3NzUHJlZml4LCAiLWl0ZW0gZGl2aWRlciIpKTsKICB9CgogIHJldHVybiBoKCdkaXYnLCAiIi5jb25jYXQoY3NzUHJlZml4LCAiLWl0ZW0iKSkub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgX3RoaXMuaXRlbUNsaWNrKGl0ZW0ua2V5KTsKCiAgICBfdGhpcy5oaWRlKCk7CiAgfSkuY2hpbGRyZW4oaXRlbS50aXRsZSgpLCBoKCdkaXYnLCAnbGFiZWwnKS5jaGlsZChpdGVtLmxhYmVsIHx8ICcnKSk7Cn0KCmZ1bmN0aW9uIGJ1aWxkTWVudSgpIHsKICB2YXIgX3RoaXMyID0gdGhpczsKCiAgcmV0dXJuIG1lbnVJdGVtcy5tYXAoZnVuY3Rpb24gKGl0KSB7CiAgICByZXR1cm4gYnVpbGRNZW51SXRlbS5jYWxsKF90aGlzMiwgaXQpOwogIH0pOwp9Cgp2YXIgQ29udGV4dE1lbnUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIENvbnRleHRNZW51KHZpZXdGbikgewogICAgdmFyIF9oOwoKICAgIHZhciBpc0hpZGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb250ZXh0TWVudSk7CgogICAgdGhpcy5tZW51SXRlbXMgPSBidWlsZE1lbnUuY2FsbCh0aGlzKTsKICAgIHRoaXMuZWwgPSAoX2ggPSBoKCdkaXYnLCAiIi5jb25jYXQoY3NzUHJlZml4LCAiLWNvbnRleHRtZW51IikpKS5jaGlsZHJlbi5hcHBseShfaCwgX3RvQ29uc3VtYWJsZUFycmF5KHRoaXMubWVudUl0ZW1zKSkuaGlkZSgpOwogICAgdGhpcy52aWV3Rm4gPSB2aWV3Rm47CgogICAgdGhpcy5pdGVtQ2xpY2sgPSBmdW5jdGlvbiAoKSB7fTsKCiAgICB0aGlzLmlzSGlkZSA9IGlzSGlkZTsKICAgIHRoaXMuc2V0TW9kZSgncmFuZ2UnKTsKICB9IC8vIHJvdy1jb2w6IHRoZSB3aG9sZSByb3dzIG9yIHRoZSB3aG9sZSBjb2xzCiAgLy8gcmFuZ2U6IHNlbGVjdCByYW5nZQoKCiAgX2NyZWF0ZUNsYXNzKENvbnRleHRNZW51LCBbewogICAga2V5OiAic2V0TW9kZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0TW9kZShtb2RlKSB7CiAgICAgIHZhciBoaWRlRWwgPSB0aGlzLm1lbnVJdGVtc1sxMl07CgogICAgICBpZiAobW9kZSA9PT0gJ3Jvdy1jb2wnKSB7CiAgICAgICAgaGlkZUVsLnNob3coKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBoaWRlRWwuaGlkZSgpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiaGlkZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGlkZSgpIHsKICAgICAgdmFyIGVsID0gdGhpcy5lbDsKICAgICAgZWwuaGlkZSgpOwogICAgICB1bmJpbmRDbGlja291dHNpZGUoZWwpOwogICAgfQogIH0sIHsKICAgIGtleTogInNldFBvc2l0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRQb3NpdGlvbih4LCB5KSB7CiAgICAgIGlmICh0aGlzLmlzSGlkZSkgcmV0dXJuOwogICAgICB2YXIgZWwgPSB0aGlzLmVsOwoKICAgICAgdmFyIF9lbCRzaG93JG9mZnNldCA9IGVsLnNob3coKS5vZmZzZXQoKSwKICAgICAgICAgIHdpZHRoID0gX2VsJHNob3ckb2Zmc2V0LndpZHRoOwoKICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdGbigpOwogICAgICB2YXIgdmhmID0gdmlldy5oZWlnaHQgLyAyOwogICAgICB2YXIgbGVmdCA9IHg7CgogICAgICBpZiAodmlldy53aWR0aCAtIHggPD0gd2lkdGgpIHsKICAgICAgICBsZWZ0IC09IHdpZHRoOwogICAgICB9CgogICAgICBlbC5jc3MoJ2xlZnQnLCAiIi5jb25jYXQobGVmdCwgInB4IikpOwoKICAgICAgaWYgKHkgPiB2aGYpIHsKICAgICAgICBlbC5jc3MoJ2JvdHRvbScsICIiLmNvbmNhdCh2aWV3LmhlaWdodCAtIHksICJweCIpKS5jc3MoJ21heC1oZWlnaHQnLCAiIi5jb25jYXQoeSwgInB4IikpLmNzcygndG9wJywgJ2F1dG8nKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBlbC5jc3MoJ3RvcCcsICIiLmNvbmNhdCh5LCAicHgiKSkuY3NzKCdtYXgtaGVpZ2h0JywgIiIuY29uY2F0KHZpZXcuaGVpZ2h0IC0geSwgInB4IikpLmNzcygnYm90dG9tJywgJ2F1dG8nKTsKICAgICAgfQoKICAgICAgYmluZENsaWNrb3V0c2lkZShlbCk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gQ29udGV4dE1lbnU7Cn0oKTsKCmV4cG9ydCB7IENvbnRleHRNZW51IGFzIGRlZmF1bHQgfTs="},{"version":3,"sources":["D:/代码/del_demo/VisualizationExcle_Demo/src/components/x-spreadsheet/component/contextmenu.js"],"names":["h","bindClickoutside","unbindClickoutside","cssPrefix","tf","menuItems","key","title","label","buildMenuItem","item","on","itemClick","hide","children","child","buildMenu","map","it","call","ContextMenu","viewFn","isHide","el","setMode","mode","hideEl","show","x","y","offset","width","view","vhf","height","left","css"],"mappings":"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","sourcesContent":["import { h } from './element';\r\nimport { bindClickoutside, unbindClickoutside } from './event';\r\nimport { cssPrefix } from '../config';\r\nimport { tf } from '../locale/locale';\r\n\r\nconst menuItems = [\r\n  { key: 'copy', title: tf('contextmenu.copy'), label: 'Ctrl+C' },\r\n  { key: 'cut', title: tf('contextmenu.cut'), label: 'Ctrl+X' },\r\n  { key: 'paste', title: tf('contextmenu.paste'), label: 'Ctrl+V' },\r\n  { key: 'paste-value', title: tf('contextmenu.pasteValue'), label: 'Ctrl+Shift+V' },\r\n  { key: 'paste-format', title: tf('contextmenu.pasteFormat'), label: 'Ctrl+Alt+V' },\r\n  { key: 'divider' },\r\n  { key: 'insert-row', title: tf('contextmenu.insertRow') },\r\n  { key: 'insert-column', title: tf('contextmenu.insertColumn') },\r\n  { key: 'divider' },\r\n  { key: 'delete-row', title: tf('contextmenu.deleteRow') },\r\n  { key: 'delete-column', title: tf('contextmenu.deleteColumn') },\r\n  { key: 'delete-cell-text', title: tf('contextmenu.deleteCellText') },\r\n  { key: 'hide', title: tf('contextmenu.hide') },\r\n  { key: 'divider' },\r\n  { key: 'validation', title: tf('contextmenu.validation') },\r\n  { key: 'divider' },\r\n  { key: 'cell-printable', title: tf('contextmenu.cellprintable') },\r\n  { key: 'cell-non-printable', title: tf('contextmenu.cellnonprintable') },\r\n  { key: 'divider' },\r\n  { key: 'cell-editable', title: tf('contextmenu.celleditable') },\r\n  { key: 'cell-non-editable', title: tf('contextmenu.cellnoneditable') },\r\n];\r\n\r\nfunction buildMenuItem(item) {\r\n  if (item.key === 'divider') {\r\n    return h('div', `${cssPrefix}-item divider`);\r\n  }\r\n  return h('div', `${cssPrefix}-item`)\r\n    .on('click', () => {\r\n      this.itemClick(item.key);\r\n      this.hide();\r\n    })\r\n    .children(\r\n      item.title(),\r\n      h('div', 'label').child(item.label || ''),\r\n    );\r\n}\r\n\r\nfunction buildMenu() {\r\n  return menuItems.map(it => buildMenuItem.call(this, it));\r\n}\r\n\r\nexport default class ContextMenu {\r\n  constructor(viewFn, isHide = false) {\r\n    this.menuItems = buildMenu.call(this);\r\n    this.el = h('div', `${cssPrefix}-contextmenu`)\r\n      .children(...this.menuItems)\r\n      .hide();\r\n    this.viewFn = viewFn;\r\n    this.itemClick = () => {};\r\n    this.isHide = isHide;\r\n    this.setMode('range');\r\n  }\r\n\r\n  // row-col: the whole rows or the whole cols\r\n  // range: select range\r\n  setMode(mode) {\r\n    const hideEl = this.menuItems[12];\r\n    if (mode === 'row-col') {\r\n      hideEl.show();\r\n    } else {\r\n      hideEl.hide();\r\n    }\r\n  }\r\n\r\n  hide() {\r\n    const { el } = this;\r\n    el.hide();\r\n    unbindClickoutside(el);\r\n  }\r\n\r\n  setPosition(x, y) {\r\n    if (this.isHide) return;\r\n    const { el } = this;\r\n    const { width } = el.show().offset();\r\n    const view = this.viewFn();\r\n    const vhf = view.height / 2;\r\n    let left = x;\r\n    if (view.width - x <= width) {\r\n      left -= width;\r\n    }\r\n    el.css('left', `${left}px`);\r\n    if (y > vhf) {\r\n      el.css('bottom', `${view.height - y}px`)\r\n        .css('max-height', `${y}px`)\r\n        .css('top', 'auto');\r\n    } else {\r\n      el.css('top', `${y}px`)\r\n        .css('max-height', `${view.height - y}px`)\r\n        .css('bottom', 'auto');\r\n    }\r\n    bindClickoutside(el);\r\n  }\r\n}\r\n"]}]}