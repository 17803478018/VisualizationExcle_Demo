{"remainingRequest":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\core\\auto_filter.js","dependencies":[{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\core\\auto_filter.js","mtime":1616639586831},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616639573358},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1616639572994},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js","mtime":1616639576682}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJDOi9Vc2Vycy9cdTU0MzRcdTVFRkFcdTY2MEUvRGVza3RvcC9WaXN1YWxpemF0aW9uRXhjbGVfRGVtby9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkM6L1VzZXJzL1x1NTQzNFx1NUVGQVx1NjYwRS9EZXNrdG9wL1Zpc3VhbGl6YXRpb25FeGNsZV9EZW1vL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc2V0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgeyBDZWxsUmFuZ2UgfSBmcm9tICcuL2NlbGxfcmFuZ2UnOyAvLyBvcGVyYXRvcjogYWxsfGVxfG5lcXxndHxndGV8bHR8bHRlfGlufGJlCi8vIHZhbHVlOgovLyAgIGluID0+IFtdCi8vICAgYmUgPT4gW21pbiwgbWF4XQoKdmFyIEZpbHRlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gRmlsdGVyKGNpLCBvcGVyYXRvciwgdmFsdWUpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBGaWx0ZXIpOwoKICAgIHRoaXMuY2kgPSBjaTsKICAgIHRoaXMub3BlcmF0b3IgPSBvcGVyYXRvcjsKICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKICB9CgogIF9jcmVhdGVDbGFzcyhGaWx0ZXIsIFt7CiAgICBrZXk6ICJzZXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldChvcGVyYXRvciwgdmFsdWUpIHsKICAgICAgdGhpcy5vcGVyYXRvciA9IG9wZXJhdG9yOwogICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CiAgICB9CiAgfSwgewogICAga2V5OiAiaW5jbHVkZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGluY2x1ZGVzKHYpIHsKICAgICAgdmFyIG9wZXJhdG9yID0gdGhpcy5vcGVyYXRvciwKICAgICAgICAgIHZhbHVlID0gdGhpcy52YWx1ZTsKCiAgICAgIGlmIChvcGVyYXRvciA9PT0gJ2FsbCcpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgaWYgKG9wZXJhdG9yID09PSAnaW4nKSB7CiAgICAgICAgcmV0dXJuIHZhbHVlLmluY2x1ZGVzKHYpOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAidmxlbmd0aCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdmxlbmd0aCgpIHsKICAgICAgdmFyIG9wZXJhdG9yID0gdGhpcy5vcGVyYXRvciwKICAgICAgICAgIHZhbHVlID0gdGhpcy52YWx1ZTsKCiAgICAgIGlmIChvcGVyYXRvciA9PT0gJ2luJykgewogICAgICAgIHJldHVybiB2YWx1ZS5sZW5ndGg7CiAgICAgIH0KCiAgICAgIHJldHVybiAwOwogICAgfQogIH0sIHsKICAgIGtleTogImdldERhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERhdGEoKSB7CiAgICAgIHZhciBjaSA9IHRoaXMuY2ksCiAgICAgICAgICBvcGVyYXRvciA9IHRoaXMub3BlcmF0b3IsCiAgICAgICAgICB2YWx1ZSA9IHRoaXMudmFsdWU7CiAgICAgIHJldHVybiB7CiAgICAgICAgY2k6IGNpLAogICAgICAgIG9wZXJhdG9yOiBvcGVyYXRvciwKICAgICAgICB2YWx1ZTogdmFsdWUKICAgICAgfTsKICAgIH0KICB9XSk7CgogIHJldHVybiBGaWx0ZXI7Cn0oKTsKCnZhciBTb3J0ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBTb3J0KGNpLCBvcmRlcikgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNvcnQpOwoKICAgIHRoaXMuY2kgPSBjaTsKICAgIHRoaXMub3JkZXIgPSBvcmRlcjsKICB9CgogIF9jcmVhdGVDbGFzcyhTb3J0LCBbewogICAga2V5OiAiYXNjIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhc2MoKSB7CiAgICAgIHJldHVybiB0aGlzLm9yZGVyID09PSAnYXNjJzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkZXNjIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkZXNjKCkgewogICAgICByZXR1cm4gdGhpcy5vcmRlciA9PT0gJ2Rlc2MnOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFNvcnQ7Cn0oKTsKCnZhciBBdXRvRmlsdGVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBBdXRvRmlsdGVyKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEF1dG9GaWx0ZXIpOwoKICAgIHRoaXMucmVmID0gbnVsbDsKICAgIHRoaXMuZmlsdGVycyA9IFtdOwogICAgdGhpcy5zb3J0ID0gbnVsbDsKICB9CgogIF9jcmVhdGVDbGFzcyhBdXRvRmlsdGVyLCBbewogICAga2V5OiAic2V0RGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RGF0YShfcmVmKSB7CiAgICAgIHZhciByZWYgPSBfcmVmLnJlZiwKICAgICAgICAgIGZpbHRlcnMgPSBfcmVmLmZpbHRlcnMsCiAgICAgICAgICBzb3J0ID0gX3JlZi5zb3J0OwoKICAgICAgaWYgKHJlZiAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5yZWYgPSByZWY7CiAgICAgICAgdGhpcy5maWx0ZXJzID0gZmlsdGVycy5tYXAoZnVuY3Rpb24gKGl0KSB7CiAgICAgICAgICByZXR1cm4gbmV3IEZpbHRlcihpdC5jaSwgaXQub3BlcmF0b3IsIGl0LnZhbHVlKTsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKHNvcnQpIHsKICAgICAgICAgIHRoaXMuc29ydCA9IG5ldyBTb3J0KHNvcnQuY2ksIHNvcnQub3JkZXIpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImdldERhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERhdGEoKSB7CiAgICAgIGlmICh0aGlzLmFjdGl2ZSgpKSB7CiAgICAgICAgdmFyIHJlZiA9IHRoaXMucmVmLAogICAgICAgICAgICBmaWx0ZXJzID0gdGhpcy5maWx0ZXJzLAogICAgICAgICAgICBzb3J0ID0gdGhpcy5zb3J0OwogICAgICAgIHJldHVybiB7CiAgICAgICAgICByZWY6IHJlZiwKICAgICAgICAgIGZpbHRlcnM6IGZpbHRlcnMubWFwKGZ1bmN0aW9uIChpdCkgewogICAgICAgICAgICByZXR1cm4gaXQuZ2V0RGF0YSgpOwogICAgICAgICAgfSksCiAgICAgICAgICBzb3J0OiBzb3J0CiAgICAgICAgfTsKICAgICAgfQoKICAgICAgcmV0dXJuIHt9OwogICAgfQogIH0sIHsKICAgIGtleTogImFkZEZpbHRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkRmlsdGVyKGNpLCBvcGVyYXRvciwgdmFsdWUpIHsKICAgICAgdmFyIGZpbHRlciA9IHRoaXMuZ2V0RmlsdGVyKGNpKTsKCiAgICAgIGlmIChmaWx0ZXIgPT0gbnVsbCkgewogICAgICAgIHRoaXMuZmlsdGVycy5wdXNoKG5ldyBGaWx0ZXIoY2ksIG9wZXJhdG9yLCB2YWx1ZSkpOwogICAgICB9IGVsc2UgewogICAgICAgIGZpbHRlci5zZXQob3BlcmF0b3IsIHZhbHVlKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInNldFNvcnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFNvcnQoY2ksIG9yZGVyKSB7CiAgICAgIHRoaXMuc29ydCA9IG9yZGVyID8gbmV3IFNvcnQoY2ksIG9yZGVyKSA6IG51bGw7CiAgICB9CiAgfSwgewogICAga2V5OiAiaW5jbHVkZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGluY2x1ZGVzKHJpLCBjaSkgewogICAgICBpZiAodGhpcy5hY3RpdmUoKSkgewogICAgICAgIHJldHVybiB0aGlzLmhyYW5nZSgpLmluY2x1ZGVzKHJpLCBjaSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRTb3J0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTb3J0KGNpKSB7CiAgICAgIHZhciBzb3J0ID0gdGhpcy5zb3J0OwoKICAgICAgaWYgKHNvcnQgJiYgc29ydC5jaSA9PT0gY2kpIHsKICAgICAgICByZXR1cm4gc29ydDsKICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0RmlsdGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRGaWx0ZXIoY2kpIHsKICAgICAgdmFyIGZpbHRlcnMgPSB0aGlzLmZpbHRlcnM7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpbHRlcnMubGVuZ3RoOyBpICs9IDEpIHsKICAgICAgICBpZiAoZmlsdGVyc1tpXS5jaSA9PT0gY2kpIHsKICAgICAgICAgIHJldHVybiBmaWx0ZXJzW2ldOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfSwgewogICAga2V5OiAiZmlsdGVyZWRSb3dzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmaWx0ZXJlZFJvd3MoZ2V0Q2VsbCkgewogICAgICAvLyBjb25zdCBhcnkgPSBbXTsKICAgICAgLy8gbGV0IGxhc3RyaSA9IDA7CiAgICAgIHZhciByc2V0ID0gbmV3IFNldCgpOwogICAgICB2YXIgZnNldCA9IG5ldyBTZXQoKTsKCiAgICAgIGlmICh0aGlzLmFjdGl2ZSgpKSB7CiAgICAgICAgdmFyIF90aGlzJHJhbmdlID0gdGhpcy5yYW5nZSgpLAogICAgICAgICAgICBzcmkgPSBfdGhpcyRyYW5nZS5zcmksCiAgICAgICAgICAgIGVyaSA9IF90aGlzJHJhbmdlLmVyaTsKCiAgICAgICAgdmFyIGZpbHRlcnMgPSB0aGlzLmZpbHRlcnM7CgogICAgICAgIGZvciAodmFyIHJpID0gc3JpICsgMTsgcmkgPD0gZXJpOyByaSArPSAxKSB7CiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpbHRlcnMubGVuZ3RoOyBpICs9IDEpIHsKICAgICAgICAgICAgdmFyIGZpbHRlciA9IGZpbHRlcnNbaV07CiAgICAgICAgICAgIHZhciBjZWxsID0gZ2V0Q2VsbChyaSwgZmlsdGVyLmNpKTsKICAgICAgICAgICAgdmFyIGN0ZXh0ID0gY2VsbCA/IGNlbGwudGV4dCA6ICcnOwoKICAgICAgICAgICAgaWYgKCFmaWx0ZXIuaW5jbHVkZXMoY3RleHQpKSB7CiAgICAgICAgICAgICAgcnNldC5hZGQocmkpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGZzZXQuYWRkKHJpKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHsKICAgICAgICByc2V0OiByc2V0LAogICAgICAgIGZzZXQ6IGZzZXQKICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpdGVtcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaXRlbXMoY2ksIGdldENlbGwpIHsKICAgICAgdmFyIG0gPSB7fTsKCiAgICAgIGlmICh0aGlzLmFjdGl2ZSgpKSB7CiAgICAgICAgdmFyIF90aGlzJHJhbmdlMiA9IHRoaXMucmFuZ2UoKSwKICAgICAgICAgICAgc3JpID0gX3RoaXMkcmFuZ2UyLnNyaSwKICAgICAgICAgICAgZXJpID0gX3RoaXMkcmFuZ2UyLmVyaTsKCiAgICAgICAgZm9yICh2YXIgcmkgPSBzcmkgKyAxOyByaSA8PSBlcmk7IHJpICs9IDEpIHsKICAgICAgICAgIHZhciBjZWxsID0gZ2V0Q2VsbChyaSwgY2kpOwoKICAgICAgICAgIGlmIChjZWxsICE9PSBudWxsICYmICEvXlxzKiQvLnRlc3QoY2VsbC50ZXh0KSkgewogICAgICAgICAgICB2YXIga2V5ID0gY2VsbC50ZXh0OwogICAgICAgICAgICB2YXIgY250ID0gKG1ba2V5XSB8fCAwKSArIDE7CiAgICAgICAgICAgIG1ba2V5XSA9IGNudDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG1bJyddID0gKG1bJyddIHx8IDApICsgMTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBtOwogICAgfQogIH0sIHsKICAgIGtleTogInJhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByYW5nZSgpIHsKICAgICAgcmV0dXJuIENlbGxSYW5nZS52YWx1ZU9mKHRoaXMucmVmKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJocmFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhyYW5nZSgpIHsKICAgICAgdmFyIHIgPSB0aGlzLnJhbmdlKCk7CiAgICAgIHIuZXJpID0gci5zcmk7CiAgICAgIHJldHVybiByOwogICAgfQogIH0sIHsKICAgIGtleTogImNsZWFyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhcigpIHsKICAgICAgdGhpcy5yZWYgPSBudWxsOwogICAgICB0aGlzLmZpbHRlcnMgPSBbXTsKICAgICAgdGhpcy5zb3J0ID0gbnVsbDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhY3RpdmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFjdGl2ZSgpIHsKICAgICAgcmV0dXJuIHRoaXMucmVmICE9PSBudWxsOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEF1dG9GaWx0ZXI7Cn0oKTsKCmV4cG9ydCB7IEF1dG9GaWx0ZXIgYXMgZGVmYXVsdCB9Ow=="},{"version":3,"sources":["C:/Users/吴建明/Desktop/VisualizationExcle_Demo/src/components/x-spreadsheet/core/auto_filter.js"],"names":["CellRange","Filter","ci","operator","value","v","includes","length","Sort","order","AutoFilter","ref","filters","sort","map","it","active","getData","filter","getFilter","push","set","ri","hrange","i","getCell","rset","Set","fset","range","sri","eri","cell","ctext","text","add","m","test","key","cnt","valueOf","r"],"mappings":"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","sourcesContent":["import { CellRange } from './cell_range';\r\n// operator: all|eq|neq|gt|gte|lt|lte|in|be\r\n// value:\r\n//   in => []\r\n//   be => [min, max]\r\nclass Filter {\r\n  constructor(ci, operator, value) {\r\n    this.ci = ci;\r\n    this.operator = operator;\r\n    this.value = value;\r\n  }\r\n\r\n  set(operator, value) {\r\n    this.operator = operator;\r\n    this.value = value;\r\n  }\r\n\r\n  includes(v) {\r\n    const { operator, value } = this;\r\n    if (operator === 'all') {\r\n      return true;\r\n    }\r\n    if (operator === 'in') {\r\n      return value.includes(v);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  vlength() {\r\n    const { operator, value } = this;\r\n    if (operator === 'in') {\r\n      return value.length;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  getData() {\r\n    const { ci, operator, value } = this;\r\n    return { ci, operator, value };\r\n  }\r\n}\r\n\r\nclass Sort {\r\n  constructor(ci, order) {\r\n    this.ci = ci;\r\n    this.order = order;\r\n  }\r\n\r\n  asc() {\r\n    return this.order === 'asc';\r\n  }\r\n\r\n  desc() {\r\n    return this.order === 'desc';\r\n  }\r\n}\r\n\r\nexport default class AutoFilter {\r\n  constructor() {\r\n    this.ref = null;\r\n    this.filters = [];\r\n    this.sort = null;\r\n  }\r\n\r\n  setData({ ref, filters, sort }) {\r\n    if (ref != null) {\r\n      this.ref = ref;\r\n      this.filters = filters.map(it => new Filter(it.ci, it.operator, it.value));\r\n      if (sort) {\r\n        this.sort = new Sort(sort.ci, sort.order);\r\n      }\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    if (this.active()) {\r\n      const { ref, filters, sort } = this;\r\n      return { ref, filters: filters.map(it => it.getData()), sort };\r\n    }\r\n    return {};\r\n  }\r\n\r\n  addFilter(ci, operator, value) {\r\n    const filter = this.getFilter(ci);\r\n    if (filter == null) {\r\n      this.filters.push(new Filter(ci, operator, value));\r\n    } else {\r\n      filter.set(operator, value);\r\n    }\r\n  }\r\n\r\n  setSort(ci, order) {\r\n    this.sort = order ? new Sort(ci, order) : null;\r\n  }\r\n\r\n  includes(ri, ci) {\r\n    if (this.active()) {\r\n      return this.hrange().includes(ri, ci);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  getSort(ci) {\r\n    const { sort } = this;\r\n    if (sort && sort.ci === ci) {\r\n      return sort;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getFilter(ci) {\r\n    const { filters } = this;\r\n    for (let i = 0; i < filters.length; i += 1) {\r\n      if (filters[i].ci === ci) {\r\n        return filters[i];\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  filteredRows(getCell) {\r\n    // const ary = [];\r\n    // let lastri = 0;\r\n    const rset = new Set();\r\n    const fset = new Set();\r\n    if (this.active()) {\r\n      const { sri, eri } = this.range();\r\n      const { filters } = this;\r\n      for (let ri = sri + 1; ri <= eri; ri += 1) {\r\n        for (let i = 0; i < filters.length; i += 1) {\r\n          const filter = filters[i];\r\n          const cell = getCell(ri, filter.ci);\r\n          const ctext = cell ? cell.text : '';\r\n          if (!filter.includes(ctext)) {\r\n            rset.add(ri);\r\n            break;\r\n          } else {\r\n            fset.add(ri);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return { rset, fset };\r\n  }\r\n\r\n  items(ci, getCell) {\r\n    const m = {};\r\n    if (this.active()) {\r\n      const { sri, eri } = this.range();\r\n      for (let ri = sri + 1; ri <= eri; ri += 1) {\r\n        const cell = getCell(ri, ci);\r\n        if (cell !== null && !/^\\s*$/.test(cell.text)) {\r\n          const key = cell.text;\r\n          const cnt = (m[key] || 0) + 1;\r\n          m[key] = cnt;\r\n        } else {\r\n          m[''] = (m[''] || 0) + 1;\r\n        }\r\n      }\r\n    }\r\n    return m;\r\n  }\r\n\r\n  range() {\r\n    return CellRange.valueOf(this.ref);\r\n  }\r\n\r\n  hrange() {\r\n    const r = this.range();\r\n    r.eri = r.sri;\r\n    return r;\r\n  }\r\n\r\n  clear() {\r\n    this.ref = null;\r\n    this.filters = [];\r\n    this.sort = null;\r\n  }\r\n\r\n  active() {\r\n    return this.ref !== null;\r\n  }\r\n}\r\n"]}]}