{"remainingRequest":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js!D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\代码\\del_demo\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\core\\merge.js","dependencies":[{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\core\\merge.js","mtime":1614915429362},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596536485880},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1606828682259},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js","mtime":1603719226989}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJEOi9cdTRFRTNcdTc4MDEvZGVsX2RlbW8vVmlzdWFsaXphdGlvbkV4Y2xlX0RlbW8vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJEOi9cdTRFRTNcdTc4MDEvZGVsX2RlbW8vVmlzdWFsaXphdGlvbkV4Y2xlX0RlbW8vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmcuanMiOwppbXBvcnQgeyBDZWxsUmFuZ2UgfSBmcm9tICcuL2NlbGxfcmFuZ2UnOwoKdmFyIE1lcmdlcyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gTWVyZ2VzKCkgewogICAgdmFyIGQgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IFtdOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNZXJnZXMpOwoKICAgIHRoaXMuXyA9IGQ7CiAgfQoKICBfY3JlYXRlQ2xhc3MoTWVyZ2VzLCBbewogICAga2V5OiAiZm9yRWFjaCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZm9yRWFjaChjYikgewogICAgICB0aGlzLl8uZm9yRWFjaChjYik7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGVsZXRlV2l0aGluIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkZWxldGVXaXRoaW4oY3IpIHsKICAgICAgdGhpcy5fID0gdGhpcy5fLmZpbHRlcihmdW5jdGlvbiAoaXQpIHsKICAgICAgICByZXR1cm4gIWl0LndpdGhpbihjcik7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEZpcnN0SW5jbHVkZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEZpcnN0SW5jbHVkZXMocmksIGNpKSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fLmxlbmd0aDsgaSArPSAxKSB7CiAgICAgICAgdmFyIGl0ID0gdGhpcy5fW2ldOwoKICAgICAgICBpZiAoaXQuaW5jbHVkZXMocmksIGNpKSkgewogICAgICAgICAgcmV0dXJuIGl0OwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfSwgewogICAga2V5OiAiZmlsdGVySW50ZXJzZWN0cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZmlsdGVySW50ZXJzZWN0cyhjZWxsUmFuZ2UpIHsKICAgICAgcmV0dXJuIG5ldyBNZXJnZXModGhpcy5fLmZpbHRlcihmdW5jdGlvbiAoaXQpIHsKICAgICAgICByZXR1cm4gaXQuaW50ZXJzZWN0cyhjZWxsUmFuZ2UpOwogICAgICB9KSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaW50ZXJzZWN0cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW50ZXJzZWN0cyhjZWxsUmFuZ2UpIHsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl8ubGVuZ3RoOyBpICs9IDEpIHsKICAgICAgICB2YXIgaXQgPSB0aGlzLl9baV07CgogICAgICAgIGlmIChpdC5pbnRlcnNlY3RzKGNlbGxSYW5nZSkpIHsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdpbnRlcnNlY3RzJyk7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ1bmlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdW5pb24oY2VsbFJhbmdlKSB7CiAgICAgIHZhciBjciA9IGNlbGxSYW5nZTsKCiAgICAgIHRoaXMuXy5mb3JFYWNoKGZ1bmN0aW9uIChpdCkgewogICAgICAgIGlmIChpdC5pbnRlcnNlY3RzKGNyKSkgewogICAgICAgICAgY3IgPSBpdC51bmlvbihjcik7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIHJldHVybiBjcjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhZGQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZChjcikgewogICAgICB0aGlzLmRlbGV0ZVdpdGhpbihjcik7CgogICAgICB0aGlzLl8ucHVzaChjcik7CiAgICB9IC8vIHR5cGU6IHJvdyB8IGNvbHVtbgoKICB9LCB7CiAgICBrZXk6ICJzaGlmdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2hpZnQodHlwZSwgaW5kZXgsIG4sIGNiV2l0aGluKSB7CiAgICAgIHRoaXMuXy5mb3JFYWNoKGZ1bmN0aW9uIChjZWxsUmFuZ2UpIHsKICAgICAgICB2YXIgc3JpID0gY2VsbFJhbmdlLnNyaSwKICAgICAgICAgICAgc2NpID0gY2VsbFJhbmdlLnNjaSwKICAgICAgICAgICAgZXJpID0gY2VsbFJhbmdlLmVyaSwKICAgICAgICAgICAgZWNpID0gY2VsbFJhbmdlLmVjaTsKICAgICAgICB2YXIgcmFuZ2UgPSBjZWxsUmFuZ2U7CgogICAgICAgIGlmICh0eXBlID09PSAncm93JykgewogICAgICAgICAgaWYgKHNyaSA+PSBpbmRleCkgewogICAgICAgICAgICByYW5nZS5zcmkgKz0gbjsKICAgICAgICAgICAgcmFuZ2UuZXJpICs9IG47CiAgICAgICAgICB9IGVsc2UgaWYgKHNyaSA8IGluZGV4ICYmIGluZGV4IDw9IGVyaSkgewogICAgICAgICAgICByYW5nZS5lcmkgKz0gbjsKICAgICAgICAgICAgY2JXaXRoaW4oc3JpLCBzY2ksIG4sIDApOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2NvbHVtbicpIHsKICAgICAgICAgIGlmIChzY2kgPj0gaW5kZXgpIHsKICAgICAgICAgICAgcmFuZ2Uuc2NpICs9IG47CiAgICAgICAgICAgIHJhbmdlLmVjaSArPSBuOwogICAgICAgICAgfSBlbHNlIGlmIChzY2kgPCBpbmRleCAmJiBpbmRleCA8PSBlY2kpIHsKICAgICAgICAgICAgcmFuZ2UuZWNpICs9IG47CiAgICAgICAgICAgIGNiV2l0aGluKHNyaSwgc2NpLCAwLCBuKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogIm1vdmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG1vdmUoY2VsbFJhbmdlLCBybiwgY24pIHsKICAgICAgdGhpcy5fLmZvckVhY2goZnVuY3Rpb24gKGl0MSkgewogICAgICAgIHZhciBpdCA9IGl0MTsKCiAgICAgICAgaWYgKGl0LndpdGhpbihjZWxsUmFuZ2UpKSB7CiAgICAgICAgICBpdC5lcmkgKz0gcm47CiAgICAgICAgICBpdC5zcmkgKz0gcm47CiAgICAgICAgICBpdC5zY2kgKz0gY247CiAgICAgICAgICBpdC5lY2kgKz0gY247CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXREYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXREYXRhKG1lcmdlcykgewogICAgICB0aGlzLl8gPSBtZXJnZXMubWFwKGZ1bmN0aW9uIChtZXJnZSkgewogICAgICAgIHJldHVybiBDZWxsUmFuZ2UudmFsdWVPZihtZXJnZSk7CiAgICAgIH0pOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXREYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXREYXRhKCkgewogICAgICByZXR1cm4gdGhpcy5fLm1hcChmdW5jdGlvbiAobWVyZ2UpIHsKICAgICAgICByZXR1cm4gbWVyZ2UudG9TdHJpbmcoKTsKICAgICAgfSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gTWVyZ2VzOwp9KCk7CgpleHBvcnQgZGVmYXVsdCB7fTsKZXhwb3J0IHsgTWVyZ2VzIH07"},{"version":3,"sources":["D:/代码/del_demo/VisualizationExcle_Demo/src/components/x-spreadsheet/core/merge.js"],"names":["CellRange","Merges","d","_","cb","forEach","cr","filter","it","within","ri","ci","i","length","includes","cellRange","intersects","union","deleteWithin","push","type","index","n","cbWithin","sri","sci","eri","eci","range","rn","cn","it1","merges","map","merge","valueOf","toString"],"mappings":"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","sourcesContent":["import { CellRange } from './cell_range';\r\n\r\nclass Merges {\r\n  constructor(d = []) {\r\n    this._ = d;\r\n  }\r\n\r\n  forEach(cb) {\r\n    this._.forEach(cb);\r\n  }\r\n\r\n  deleteWithin(cr) {\r\n    this._ = this._.filter(it => !it.within(cr));\r\n  }\r\n\r\n  getFirstIncludes(ri, ci) {\r\n    for (let i = 0; i < this._.length; i += 1) {\r\n      const it = this._[i];\r\n      if (it.includes(ri, ci)) {\r\n        return it;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  filterIntersects(cellRange) {\r\n    return new Merges(this._.filter(it => it.intersects(cellRange)));\r\n  }\r\n\r\n  intersects(cellRange) {\r\n    for (let i = 0; i < this._.length; i += 1) {\r\n      const it = this._[i];\r\n      if (it.intersects(cellRange)) {\r\n        // console.log('intersects');\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  union(cellRange) {\r\n    let cr = cellRange;\r\n    this._.forEach((it) => {\r\n      if (it.intersects(cr)) {\r\n        cr = it.union(cr);\r\n      }\r\n    });\r\n    return cr;\r\n  }\r\n\r\n  add(cr) {\r\n    this.deleteWithin(cr);\r\n    this._.push(cr);\r\n  }\r\n\r\n  // type: row | column\r\n  shift(type, index, n, cbWithin) {\r\n    this._.forEach((cellRange) => {\r\n      const {\r\n        sri, sci, eri, eci,\r\n      } = cellRange;\r\n      const range = cellRange;\r\n      if (type === 'row') {\r\n        if (sri >= index) {\r\n          range.sri += n;\r\n          range.eri += n;\r\n        } else if (sri < index && index <= eri) {\r\n          range.eri += n;\r\n          cbWithin(sri, sci, n, 0);\r\n        }\r\n      } else if (type === 'column') {\r\n        if (sci >= index) {\r\n          range.sci += n;\r\n          range.eci += n;\r\n        } else if (sci < index && index <= eci) {\r\n          range.eci += n;\r\n          cbWithin(sri, sci, 0, n);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  move(cellRange, rn, cn) {\r\n    this._.forEach((it1) => {\r\n      const it = it1;\r\n      if (it.within(cellRange)) {\r\n        it.eri += rn;\r\n        it.sri += rn;\r\n        it.sci += cn;\r\n        it.eci += cn;\r\n      }\r\n    });\r\n  }\r\n\r\n  setData(merges) {\r\n    this._ = merges.map(merge => CellRange.valueOf(merge));\r\n    return this;\r\n  }\r\n\r\n  getData() {\r\n    return this._.map(merge => merge.toString());\r\n  }\r\n}\r\n\r\nexport default {};\r\nexport {\r\n  Merges,\r\n};\r\n"]}]}