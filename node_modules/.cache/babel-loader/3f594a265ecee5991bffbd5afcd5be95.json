{"remainingRequest":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\core\\row.js","dependencies":[{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\core\\row.js","mtime":1616639586839},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616639573358},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1616639572994},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js","mtime":1616639576682}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIkM6L1VzZXJzL1x1NTQzNFx1NUVGQVx1NjYwRS9EZXNrdG9wL1Zpc3VhbGl6YXRpb25FeGNsZV9EZW1vL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9zbGljZWRUb0FycmF5IjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJDOi9Vc2Vycy9cdTU0MzRcdTVFRkFcdTY2MEUvRGVza3RvcC9WaXN1YWxpemF0aW9uRXhjbGVfRGVtby9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkM6L1VzZXJzL1x1NTQzNFx1NUVGQVx1NjYwRS9EZXNrdG9wL1Zpc3VhbGl6YXRpb25FeGNsZV9EZW1vL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuY29uc3RydWN0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5lbnRyaWVzLmpzIjsKaW1wb3J0IGhlbHBlciBmcm9tICcuL2hlbHBlcic7CmltcG9ydCB7IGV4cHIyZXhwciB9IGZyb20gJy4vYWxwaGFiZXQnOwoKdmFyIFJvd3MgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFJvd3MoX3JlZikgewogICAgdmFyIGxlbiA9IF9yZWYubGVuLAogICAgICAgIGhlaWdodCA9IF9yZWYuaGVpZ2h0OwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBSb3dzKTsKCiAgICB0aGlzLl8gPSB7fTsKICAgIHRoaXMubGVuID0gbGVuOyAvLyBkZWZhdWx0IHJvdyBoZWlnaHQKCiAgICB0aGlzLmhlaWdodCA9IGhlaWdodDsKICB9CgogIF9jcmVhdGVDbGFzcyhSb3dzLCBbewogICAga2V5OiAiZ2V0SGVpZ2h0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRIZWlnaHQocmkpIHsKICAgICAgaWYgKHRoaXMuaXNIaWRlKHJpKSkgcmV0dXJuIDA7CiAgICAgIHZhciByb3cgPSB0aGlzLmdldChyaSk7CgogICAgICBpZiAocm93ICYmIHJvdy5oZWlnaHQpIHsKICAgICAgICByZXR1cm4gcm93LmhlaWdodDsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuaGVpZ2h0OwogICAgfQogIH0sIHsKICAgIGtleTogInNldEhlaWdodCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0SGVpZ2h0KHJpLCB2KSB7CiAgICAgIHZhciByb3cgPSB0aGlzLmdldE9yTmV3KHJpKTsKICAgICAgcm93LmhlaWdodCA9IHY7CiAgICB9CiAgfSwgewogICAga2V5OiAidW5oaWRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1bmhpZGUoaWR4KSB7CiAgICAgIHZhciBpbmRleCA9IGlkeDsKCiAgICAgIHdoaWxlIChpbmRleCA+IDApIHsKICAgICAgICBpbmRleCAtPSAxOwoKICAgICAgICBpZiAodGhpcy5pc0hpZGUoaW5kZXgpKSB7CiAgICAgICAgICB0aGlzLnNldEhpZGUoaW5kZXgsIGZhbHNlKTsKICAgICAgICB9IGVsc2UgYnJlYWs7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc0hpZGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzSGlkZShyaSkgewogICAgICB2YXIgcm93ID0gdGhpcy5nZXQocmkpOwogICAgICByZXR1cm4gcm93ICYmIHJvdy5oaWRlOwogICAgfQogIH0sIHsKICAgIGtleTogInNldEhpZGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEhpZGUocmksIHYpIHsKICAgICAgdmFyIHJvdyA9IHRoaXMuZ2V0T3JOZXcocmkpOwogICAgICBpZiAodiA9PT0gdHJ1ZSkgcm93LmhpZGUgPSB0cnVlO2Vsc2UgZGVsZXRlIHJvdy5oaWRlOwogICAgfQogIH0sIHsKICAgIGtleTogInNldFN0eWxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRTdHlsZShyaSwgc3R5bGUpIHsKICAgICAgdmFyIHJvdyA9IHRoaXMuZ2V0T3JOZXcocmkpOwogICAgICByb3cuc3R5bGUgPSBzdHlsZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzdW1IZWlnaHQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHN1bUhlaWdodChtaW4sIG1heCwgZXhjZXB0U2V0KSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gaGVscGVyLnJhbmdlU3VtKG1pbiwgbWF4LCBmdW5jdGlvbiAoaSkgewogICAgICAgIGlmIChleGNlcHRTZXQgJiYgZXhjZXB0U2V0LmhhcyhpKSkgcmV0dXJuIDA7CiAgICAgICAgcmV0dXJuIF90aGlzLmdldEhlaWdodChpKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAidG90YWxIZWlnaHQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRvdGFsSGVpZ2h0KCkgewogICAgICByZXR1cm4gdGhpcy5zdW1IZWlnaHQoMCwgdGhpcy5sZW4pOwogICAgfQogIH0sIHsKICAgIGtleTogImdldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0KHJpKSB7CiAgICAgIHJldHVybiB0aGlzLl9bcmldOwogICAgfQogIH0sIHsKICAgIGtleTogImdldE9yTmV3IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRPck5ldyhyaSkgewogICAgICB0aGlzLl9bcmldID0gdGhpcy5fW3JpXSB8fCB7CiAgICAgICAgY2VsbHM6IHt9CiAgICAgIH07CiAgICAgIHJldHVybiB0aGlzLl9bcmldOwogICAgfQogIH0sIHsKICAgIGtleTogImdldENlbGwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldENlbGwocmksIGNpKSB7CiAgICAgIHZhciByb3cgPSB0aGlzLmdldChyaSk7CgogICAgICBpZiAocm93ICE9PSB1bmRlZmluZWQgJiYgcm93LmNlbGxzICE9PSB1bmRlZmluZWQgJiYgcm93LmNlbGxzW2NpXSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHJvdy5jZWxsc1tjaV07CiAgICAgIH0KCiAgICAgIHJldHVybiBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogImdldENlbGxNZXJnZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2VsbE1lcmdlKHJpLCBjaSkgewogICAgICB2YXIgY2VsbCA9IHRoaXMuZ2V0Q2VsbChyaSwgY2kpOwogICAgICBpZiAoY2VsbCAmJiBjZWxsLm1lcmdlKSByZXR1cm4gY2VsbC5tZXJnZTsKICAgICAgcmV0dXJuIFswLCAwXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRDZWxsT3JOZXciLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldENlbGxPck5ldyhyaSwgY2kpIHsKICAgICAgdmFyIHJvdyA9IHRoaXMuZ2V0T3JOZXcocmkpOwogICAgICByb3cuY2VsbHNbY2ldID0gcm93LmNlbGxzW2NpXSB8fCB7fTsKICAgICAgcmV0dXJuIHJvdy5jZWxsc1tjaV07CiAgICB9IC8vIHdoYXQ6IGFsbCB8IHRleHQgfCBmb3JtYXQKCiAgfSwgewogICAga2V5OiAic2V0Q2VsbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Q2VsbChyaSwgY2ksIGNlbGwpIHsKICAgICAgdmFyIHdoYXQgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6ICdhbGwnOwogICAgICB2YXIgcm93ID0gdGhpcy5nZXRPck5ldyhyaSk7CgogICAgICBpZiAod2hhdCA9PT0gJ2FsbCcpIHsKICAgICAgICByb3cuY2VsbHNbY2ldID0gY2VsbDsKICAgICAgfSBlbHNlIGlmICh3aGF0ID09PSAndGV4dCcpIHsKICAgICAgICByb3cuY2VsbHNbY2ldID0gcm93LmNlbGxzW2NpXSB8fCB7fTsKICAgICAgICByb3cuY2VsbHNbY2ldLnRleHQgPSBjZWxsLnRleHQ7CiAgICAgIH0gZWxzZSBpZiAod2hhdCA9PT0gJ2Zvcm1hdCcpIHsKICAgICAgICByb3cuY2VsbHNbY2ldID0gcm93LmNlbGxzW2NpXSB8fCB7fTsKICAgICAgICByb3cuY2VsbHNbY2ldLnN0eWxlID0gY2VsbC5zdHlsZTsKICAgICAgICBpZiAoY2VsbC5tZXJnZSkgcm93LmNlbGxzW2NpXS5tZXJnZSA9IGNlbGwubWVyZ2U7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRDZWxsVGV4dCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Q2VsbFRleHQocmksIGNpLCB0ZXh0KSB7CiAgICAgIHZhciBjZWxsID0gdGhpcy5nZXRDZWxsT3JOZXcocmksIGNpKTsKICAgICAgY2VsbC50ZXh0ID0gdGV4dDsKICAgIH0gLy8gd2hhdDogYWxsIHwgZm9ybWF0IHwgdGV4dAoKICB9LCB7CiAgICBrZXk6ICJjb3B5UGFzdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvcHlQYXN0ZShzcmNDZWxsUmFuZ2UsIGRzdENlbGxSYW5nZSwgd2hhdCkgewogICAgICB2YXIgYXV0b2ZpbGwgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlOwogICAgICB2YXIgY2IgPSBhcmd1bWVudHMubGVuZ3RoID4gNCAmJiBhcmd1bWVudHNbNF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s0XSA6IGZ1bmN0aW9uICgpIHt9OwogICAgICB2YXIgc3JpID0gc3JjQ2VsbFJhbmdlLnNyaSwKICAgICAgICAgIHNjaSA9IHNyY0NlbGxSYW5nZS5zY2ksCiAgICAgICAgICBlcmkgPSBzcmNDZWxsUmFuZ2UuZXJpLAogICAgICAgICAgZWNpID0gc3JjQ2VsbFJhbmdlLmVjaTsKICAgICAgdmFyIGRzcmkgPSBkc3RDZWxsUmFuZ2Uuc3JpOwogICAgICB2YXIgZHNjaSA9IGRzdENlbGxSYW5nZS5zY2k7CiAgICAgIHZhciBkZXJpID0gZHN0Q2VsbFJhbmdlLmVyaTsKICAgICAgdmFyIGRlY2kgPSBkc3RDZWxsUmFuZ2UuZWNpOwoKICAgICAgdmFyIF9zcmNDZWxsUmFuZ2Ukc2l6ZSA9IHNyY0NlbGxSYW5nZS5zaXplKCksCiAgICAgICAgICBfc3JjQ2VsbFJhbmdlJHNpemUyID0gX3NsaWNlZFRvQXJyYXkoX3NyY0NlbGxSYW5nZSRzaXplLCAyKSwKICAgICAgICAgIHJuID0gX3NyY0NlbGxSYW5nZSRzaXplMlswXSwKICAgICAgICAgIGNuID0gX3NyY0NlbGxSYW5nZSRzaXplMlsxXTsKCiAgICAgIHZhciBfZHN0Q2VsbFJhbmdlJHNpemUgPSBkc3RDZWxsUmFuZ2Uuc2l6ZSgpLAogICAgICAgICAgX2RzdENlbGxSYW5nZSRzaXplMiA9IF9zbGljZWRUb0FycmF5KF9kc3RDZWxsUmFuZ2Ukc2l6ZSwgMiksCiAgICAgICAgICBkcm4gPSBfZHN0Q2VsbFJhbmdlJHNpemUyWzBdLAogICAgICAgICAgZGNuID0gX2RzdENlbGxSYW5nZSRzaXplMlsxXTsgLy8gY29uc29sZS5sb2coc3JjSW5kZXhlcywgZHN0SW5kZXhlcyk7CgoKICAgICAgdmFyIGlzQWRkID0gdHJ1ZTsKICAgICAgdmFyIGRuID0gMDsKCiAgICAgIGlmIChkZXJpIDwgc3JpIHx8IGRlY2kgPCBzY2kpIHsKICAgICAgICBpc0FkZCA9IGZhbHNlOwogICAgICAgIGlmIChkZXJpIDwgc3JpKSBkbiA9IGRybjtlbHNlIGRuID0gZGNuOwogICAgICB9CgogICAgICBmb3IgKHZhciBpID0gc3JpOyBpIDw9IGVyaTsgaSArPSAxKSB7CiAgICAgICAgaWYgKHRoaXMuX1tpXSkgewogICAgICAgICAgZm9yICh2YXIgaiA9IHNjaTsgaiA8PSBlY2k7IGogKz0gMSkgewogICAgICAgICAgICBpZiAodGhpcy5fW2ldLmNlbGxzICYmIHRoaXMuX1tpXS5jZWxsc1tqXSkgewogICAgICAgICAgICAgIGZvciAodmFyIGlpID0gZHNyaTsgaWkgPD0gZGVyaTsgaWkgKz0gcm4pIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGpqID0gZHNjaTsgamogPD0gZGVjaTsgamogKz0gY24pIHsKICAgICAgICAgICAgICAgICAgdmFyIG5yaSA9IGlpICsgKGkgLSBzcmkpOwogICAgICAgICAgICAgICAgICB2YXIgbmNpID0gamogKyAoaiAtIHNjaSk7CiAgICAgICAgICAgICAgICAgIHZhciBuY2VsbCA9IGhlbHBlci5jbG9uZURlZXAodGhpcy5fW2ldLmNlbGxzW2pdKTsgLy8gbmNlbGwudGV4dAoKICAgICAgICAgICAgICAgICAgaWYgKGF1dG9maWxsICYmIG5jZWxsICYmIG5jZWxsLnRleHQgJiYgbmNlbGwudGV4dC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gbmNlbGwudGV4dDsKICAgICAgICAgICAgICAgICAgICAgIHZhciBuID0gamogLSBkc2NpICsgKGlpIC0gZHNyaSkgKyAyOwoKICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNBZGQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbiAtPSBkbiArIDE7CiAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgaWYgKHRleHRbMF0gPT09ICc9JykgewogICAgICAgICAgICAgICAgICAgICAgICBuY2VsbC50ZXh0ID0gdGV4dC5yZXBsYWNlKC9bYS16QS1aXXsxLDN9XGQrL2csIGZ1bmN0aW9uICh3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhuID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeW4gPSAwOwoKICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3JpID09PSBkc3JpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4biA9IG4gLSAxOyAvLyBpZiAoaXNBZGQpIHhuIC09IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHluID0gbiAtIDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoL15cZCskLy50ZXN0KHdvcmQpKSByZXR1cm4gd29yZDsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXhwcjJleHByKHdvcmQsIHhuLCB5bik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChybiA8PSAxICYmIGNuID4gMSAmJiAoZHNyaSA+IGVyaSB8fCBkZXJpIDwgc3JpKSB8fCBjbiA8PSAxICYmIHJuID4gMSAmJiAoZHNjaSA+IGVjaSB8fCBkZWNpIDwgc2NpKSB8fCBybiA8PSAxICYmIGNuIDw9IDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IC9bXFwuXGRdKyQvLmV4ZWModGV4dCk7IC8vIGNvbnNvbGUubG9nKCdyZXN1bHQ6JywgcmVzdWx0KTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgIT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBOdW1iZXIocmVzdWx0WzBdKSArIG4gLSAxOwogICAgICAgICAgICAgICAgICAgICAgICAgIG5jZWxsLnRleHQgPSB0ZXh0LnN1YnN0cmluZygwLCByZXN1bHQuaW5kZXgpICsgaW5kZXg7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KSgpOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICB0aGlzLnNldENlbGwobnJpLCBuY2ksIG5jZWxsLCB3aGF0KTsKICAgICAgICAgICAgICAgICAgY2IobnJpLCBuY2ksIG5jZWxsKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJjdXRQYXN0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3V0UGFzdGUoc3JjQ2VsbFJhbmdlLCBkc3RDZWxsUmFuZ2UpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgbmNlbGxtbSA9IHt9OwogICAgICB0aGlzLmVhY2goZnVuY3Rpb24gKHJpKSB7CiAgICAgICAgX3RoaXMyLmVhY2hDZWxscyhyaSwgZnVuY3Rpb24gKGNpKSB7CiAgICAgICAgICB2YXIgbnJpID0gcGFyc2VJbnQocmksIDEwKTsKICAgICAgICAgIHZhciBuY2kgPSBwYXJzZUludChjaSwgMTApOwoKICAgICAgICAgIGlmIChzcmNDZWxsUmFuZ2UuaW5jbHVkZXMocmksIGNpKSkgewogICAgICAgICAgICBucmkgPSBkc3RDZWxsUmFuZ2Uuc3JpICsgKG5yaSAtIHNyY0NlbGxSYW5nZS5zcmkpOwogICAgICAgICAgICBuY2kgPSBkc3RDZWxsUmFuZ2Uuc2NpICsgKG5jaSAtIHNyY0NlbGxSYW5nZS5zY2kpOwogICAgICAgICAgfQoKICAgICAgICAgIG5jZWxsbW1bbnJpXSA9IG5jZWxsbW1bbnJpXSB8fCB7CiAgICAgICAgICAgIGNlbGxzOiB7fQogICAgICAgICAgfTsKICAgICAgICAgIG5jZWxsbW1bbnJpXS5jZWxsc1tuY2ldID0gX3RoaXMyLl9bcmldLmNlbGxzW2NpXTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICAgIHRoaXMuXyA9IG5jZWxsbW07CiAgICB9IC8vIHNyYzogQXJyYXk8QXJyYXk8U3RyaW5nPj4KCiAgfSwgewogICAga2V5OiAicGFzdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHBhc3RlKHNyYywgZHN0Q2VsbFJhbmdlKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgaWYgKHNyYy5sZW5ndGggPD0gMCkgcmV0dXJuOwogICAgICB2YXIgc3JpID0gZHN0Q2VsbFJhbmdlLnNyaSwKICAgICAgICAgIHNjaSA9IGRzdENlbGxSYW5nZS5zY2k7CiAgICAgIHNyYy5mb3JFYWNoKGZ1bmN0aW9uIChyb3csIGkpIHsKICAgICAgICB2YXIgcmkgPSBzcmkgKyBpOwogICAgICAgIHJvdy5mb3JFYWNoKGZ1bmN0aW9uIChjZWxsLCBqKSB7CiAgICAgICAgICB2YXIgY2kgPSBzY2kgKyBqOwoKICAgICAgICAgIF90aGlzMy5zZXRDZWxsVGV4dChyaSwgY2ksIGNlbGwpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpbnNlcnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGluc2VydChzcmkpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB2YXIgbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogMTsKICAgICAgdmFyIG5kYXRhID0ge307CiAgICAgIHRoaXMuZWFjaChmdW5jdGlvbiAocmksIHJvdykgewogICAgICAgIHZhciBucmkgPSBwYXJzZUludChyaSwgMTApOwoKICAgICAgICBpZiAobnJpID49IHNyaSkgewogICAgICAgICAgbnJpICs9IG47CgogICAgICAgICAgX3RoaXM0LmVhY2hDZWxscyhyaSwgZnVuY3Rpb24gKGNpLCBjZWxsKSB7CiAgICAgICAgICAgIGlmIChjZWxsLnRleHQgJiYgY2VsbC50ZXh0WzBdID09PSAnPScpIHsKICAgICAgICAgICAgICBjZWxsLnRleHQgPSBjZWxsLnRleHQucmVwbGFjZSgvW2EtekEtWl17MSwzfVxkKy9nLCBmdW5jdGlvbiAod29yZCkgewogICAgICAgICAgICAgICAgcmV0dXJuIGV4cHIyZXhwcih3b3JkLCAwLCBuLCBmdW5jdGlvbiAoeCwgeSkgewogICAgICAgICAgICAgICAgICByZXR1cm4geSA+PSBzcmk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBuZGF0YVtucmldID0gcm93OwogICAgICB9KTsKICAgICAgdGhpcy5fID0gbmRhdGE7CiAgICAgIHRoaXMubGVuICs9IG47CiAgICB9CiAgfSwgewogICAga2V5OiAiZGVsZXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKHNyaSwgZXJpKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgdmFyIG4gPSBlcmkgLSBzcmkgKyAxOwogICAgICB2YXIgbmRhdGEgPSB7fTsKICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uIChyaSwgcm93KSB7CiAgICAgICAgdmFyIG5yaSA9IHBhcnNlSW50KHJpLCAxMCk7CgogICAgICAgIGlmIChucmkgPCBzcmkpIHsKICAgICAgICAgIG5kYXRhW25yaV0gPSByb3c7CiAgICAgICAgfSBlbHNlIGlmIChyaSA+IGVyaSkgewogICAgICAgICAgbmRhdGFbbnJpIC0gbl0gPSByb3c7CgogICAgICAgICAgX3RoaXM1LmVhY2hDZWxscyhyaSwgZnVuY3Rpb24gKGNpLCBjZWxsKSB7CiAgICAgICAgICAgIGlmIChjZWxsLnRleHQgJiYgY2VsbC50ZXh0WzBdID09PSAnPScpIHsKICAgICAgICAgICAgICBjZWxsLnRleHQgPSBjZWxsLnRleHQucmVwbGFjZSgvW2EtekEtWl17MSwzfVxkKy9nLCBmdW5jdGlvbiAod29yZCkgewogICAgICAgICAgICAgICAgcmV0dXJuIGV4cHIyZXhwcih3b3JkLCAwLCAtbiwgZnVuY3Rpb24gKHgsIHkpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHkgPiBlcmk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgdGhpcy5fID0gbmRhdGE7CiAgICAgIHRoaXMubGVuIC09IG47CiAgICB9CiAgfSwgewogICAga2V5OiAiaW5zZXJ0Q29sdW1uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbnNlcnRDb2x1bW4oc2NpKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgdmFyIG4gPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IDE7CiAgICAgIHRoaXMuZWFjaChmdW5jdGlvbiAocmksIHJvdykgewogICAgICAgIHZhciBybmRhdGEgPSB7fTsKCiAgICAgICAgX3RoaXM2LmVhY2hDZWxscyhyaSwgZnVuY3Rpb24gKGNpLCBjZWxsKSB7CiAgICAgICAgICB2YXIgbmNpID0gcGFyc2VJbnQoY2ksIDEwKTsKCiAgICAgICAgICBpZiAobmNpID49IHNjaSkgewogICAgICAgICAgICBuY2kgKz0gbjsKCiAgICAgICAgICAgIGlmIChjZWxsLnRleHQgJiYgY2VsbC50ZXh0WzBdID09PSAnPScpIHsKICAgICAgICAgICAgICBjZWxsLnRleHQgPSBjZWxsLnRleHQucmVwbGFjZSgvW2EtekEtWl17MSwzfVxkKy9nLCBmdW5jdGlvbiAod29yZCkgewogICAgICAgICAgICAgICAgcmV0dXJuIGV4cHIyZXhwcih3b3JkLCBuLCAwLCBmdW5jdGlvbiAoeCkgewogICAgICAgICAgICAgICAgICByZXR1cm4geCA+PSBzY2k7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHJuZGF0YVtuY2ldID0gY2VsbDsKICAgICAgICB9KTsKCiAgICAgICAgcm93LmNlbGxzID0gcm5kYXRhOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkZWxldGVDb2x1bW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRlbGV0ZUNvbHVtbihzY2ksIGVjaSkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKCiAgICAgIHZhciBuID0gZWNpIC0gc2NpICsgMTsKICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uIChyaSwgcm93KSB7CiAgICAgICAgdmFyIHJuZGF0YSA9IHt9OwoKICAgICAgICBfdGhpczcuZWFjaENlbGxzKHJpLCBmdW5jdGlvbiAoY2ksIGNlbGwpIHsKICAgICAgICAgIHZhciBuY2kgPSBwYXJzZUludChjaSwgMTApOwoKICAgICAgICAgIGlmIChuY2kgPCBzY2kpIHsKICAgICAgICAgICAgcm5kYXRhW25jaV0gPSBjZWxsOwogICAgICAgICAgfSBlbHNlIGlmIChuY2kgPiBlY2kpIHsKICAgICAgICAgICAgcm5kYXRhW25jaSAtIG5dID0gY2VsbDsKCiAgICAgICAgICAgIGlmIChjZWxsLnRleHQgJiYgY2VsbC50ZXh0WzBdID09PSAnPScpIHsKICAgICAgICAgICAgICBjZWxsLnRleHQgPSBjZWxsLnRleHQucmVwbGFjZSgvW2EtekEtWl17MSwzfVxkKy9nLCBmdW5jdGlvbiAod29yZCkgewogICAgICAgICAgICAgICAgcmV0dXJuIGV4cHIyZXhwcih3b3JkLCAtbiwgMCwgZnVuY3Rpb24gKHgpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHggPiBlY2k7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICByb3cuY2VsbHMgPSBybmRhdGE7CiAgICAgIH0pOwogICAgfSAvLyB3aGF0OiBhbGwgfCB0ZXh0IHwgZm9ybWF0IHwgbWVyZ2UKCiAgfSwgewogICAga2V5OiAiZGVsZXRlQ2VsbHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRlbGV0ZUNlbGxzKGNlbGxSYW5nZSkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICAgIHZhciB3aGF0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAnYWxsJzsKICAgICAgY2VsbFJhbmdlLmVhY2goZnVuY3Rpb24gKGksIGopIHsKICAgICAgICBfdGhpczguZGVsZXRlQ2VsbChpLCBqLCB3aGF0KTsKICAgICAgfSk7CiAgICB9IC8vIHdoYXQ6IGFsbCB8IHRleHQgfCBmb3JtYXQgfCBtZXJnZQoKICB9LCB7CiAgICBrZXk6ICJkZWxldGVDZWxsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkZWxldGVDZWxsKHJpLCBjaSkgewogICAgICB2YXIgd2hhdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogJ2FsbCc7CiAgICAgIHZhciByb3cgPSB0aGlzLmdldChyaSk7CgogICAgICBpZiAocm93ICE9PSBudWxsKSB7CiAgICAgICAgdmFyIGNlbGwgPSB0aGlzLmdldENlbGwocmksIGNpKTsKCiAgICAgICAgaWYgKGNlbGwgIT09IG51bGwpIHsKICAgICAgICAgIGlmICh3aGF0ID09PSAnYWxsJykgewogICAgICAgICAgICBkZWxldGUgcm93LmNlbGxzW2NpXTsKICAgICAgICAgIH0gZWxzZSBpZiAod2hhdCA9PT0gJ3RleHQnKSB7CiAgICAgICAgICAgIGlmIChjZWxsLnRleHQpIGRlbGV0ZSBjZWxsLnRleHQ7CiAgICAgICAgICAgIGlmIChjZWxsLnZhbHVlKSBkZWxldGUgY2VsbC52YWx1ZTsKICAgICAgICAgIH0gZWxzZSBpZiAod2hhdCA9PT0gJ2Zvcm1hdCcpIHsKICAgICAgICAgICAgaWYgKGNlbGwuc3R5bGUgIT09IHVuZGVmaW5lZCkgZGVsZXRlIGNlbGwuc3R5bGU7CiAgICAgICAgICAgIGlmIChjZWxsLm1lcmdlKSBkZWxldGUgY2VsbC5tZXJnZTsKICAgICAgICAgIH0gZWxzZSBpZiAod2hhdCA9PT0gJ21lcmdlJykgewogICAgICAgICAgICBpZiAoY2VsbC5tZXJnZSkgZGVsZXRlIGNlbGwubWVyZ2U7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAibWF4Q2VsbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWF4Q2VsbCgpIHsKICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyh0aGlzLl8pOwogICAgICB2YXIgcmkgPSBrZXlzW2tleXMubGVuZ3RoIC0gMV07CiAgICAgIHZhciBjb2wgPSB0aGlzLl9bcmldOwoKICAgICAgaWYgKGNvbCkgewogICAgICAgIHZhciBjZWxscyA9IGNvbC5jZWxsczsKICAgICAgICB2YXIga3MgPSBPYmplY3Qua2V5cyhjZWxscyk7CiAgICAgICAgdmFyIGNpID0ga3Nba3MubGVuZ3RoIC0gMV07CiAgICAgICAgcmV0dXJuIFtwYXJzZUludChyaSwgMTApLCBwYXJzZUludChjaSwgMTApXTsKICAgICAgfQoKICAgICAgcmV0dXJuIFswLCAwXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJlYWNoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBlYWNoKGNiKSB7CiAgICAgIE9iamVjdC5lbnRyaWVzKHRoaXMuXykuZm9yRWFjaChmdW5jdGlvbiAoX3JlZjIpIHsKICAgICAgICB2YXIgX3JlZjMgPSBfc2xpY2VkVG9BcnJheShfcmVmMiwgMiksCiAgICAgICAgICAgIHJpID0gX3JlZjNbMF0sCiAgICAgICAgICAgIHJvdyA9IF9yZWYzWzFdOwoKICAgICAgICBjYihyaSwgcm93KTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZWFjaENlbGxzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBlYWNoQ2VsbHMocmksIGNiKSB7CiAgICAgIGlmICh0aGlzLl9bcmldICYmIHRoaXMuX1tyaV0uY2VsbHMpIHsKICAgICAgICBPYmplY3QuZW50cmllcyh0aGlzLl9bcmldLmNlbGxzKS5mb3JFYWNoKGZ1bmN0aW9uIChfcmVmNCkgewogICAgICAgICAgdmFyIF9yZWY1ID0gX3NsaWNlZFRvQXJyYXkoX3JlZjQsIDIpLAogICAgICAgICAgICAgIGNpID0gX3JlZjVbMF0sCiAgICAgICAgICAgICAgY2VsbCA9IF9yZWY1WzFdOwoKICAgICAgICAgIGNiKGNpLCBjZWxsKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInNldERhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldERhdGEoZCkgewogICAgICBpZiAoZC5sZW4pIHsKICAgICAgICB0aGlzLmxlbiA9IGQubGVuOwogICAgICAgIGRlbGV0ZSBkLmxlbjsKICAgICAgfQoKICAgICAgdGhpcy5fID0gZDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXREYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXREYXRhKCkgewogICAgICB2YXIgbGVuID0gdGhpcy5sZW47CiAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHsKICAgICAgICBsZW46IGxlbgogICAgICB9LCB0aGlzLl8pOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFJvd3M7Cn0oKTsKCmV4cG9ydCBkZWZhdWx0IHt9OwpleHBvcnQgeyBSb3dzIH07"},{"version":3,"sources":["C:/Users/吴建明/Desktop/VisualizationExcle_Demo/src/components/x-spreadsheet/core/row.js"],"names":["helper","expr2expr","Rows","len","height","_","ri","isHide","row","get","v","getOrNew","idx","index","setHide","hide","style","min","max","exceptSet","rangeSum","i","has","getHeight","sumHeight","cells","ci","undefined","cell","getCell","merge","what","text","getCellOrNew","srcCellRange","dstCellRange","autofill","cb","sri","sci","eri","eci","dsri","dsci","deri","deci","size","rn","cn","drn","dcn","isAdd","dn","j","ii","jj","nri","nci","ncell","cloneDeep","length","n","replace","word","xn","yn","test","result","exec","Number","substring","setCell","ncellmm","each","eachCells","parseInt","includes","src","forEach","setCellText","ndata","x","y","rndata","cellRange","deleteCell","value","keys","Object","col","ks","entries","d","assign"],"mappings":";;;;;;;;;;;AAAA,OAAOA,MAAP,MAAmB,UAAnB;AACA,SAASC,SAAT,QAA0B,YAA1B;;IAEMC,I;AACJ,sBAA6B;AAAA,QAAfC,GAAe,QAAfA,GAAe;AAAA,QAAVC,MAAU,QAAVA,MAAU;;AAAA;;AAC3B,SAAKC,CAAL,GAAS,EAAT;AACA,SAAKF,GAAL,GAAWA,GAAX,CAF2B,CAG3B;;AACA,SAAKC,MAAL,GAAcA,MAAd;AACD;;;;WAED,mBAAUE,EAAV,EAAc;AACZ,UAAI,KAAKC,MAAL,CAAYD,EAAZ,CAAJ,EAAqB,OAAO,CAAP;AACrB,UAAME,GAAG,GAAG,KAAKC,GAAL,CAASH,EAAT,CAAZ;;AACA,UAAIE,GAAG,IAAIA,GAAG,CAACJ,MAAf,EAAuB;AACrB,eAAOI,GAAG,CAACJ,MAAX;AACD;;AACD,aAAO,KAAKA,MAAZ;AACD;;;WAED,mBAAUE,EAAV,EAAcI,CAAd,EAAiB;AACf,UAAMF,GAAG,GAAG,KAAKG,QAAL,CAAcL,EAAd,CAAZ;AACAE,MAAAA,GAAG,CAACJ,MAAJ,GAAaM,CAAb;AACD;;;WAED,gBAAOE,GAAP,EAAY;AACV,UAAIC,KAAK,GAAGD,GAAZ;;AACA,aAAOC,KAAK,GAAG,CAAf,EAAkB;AAChBA,QAAAA,KAAK,IAAI,CAAT;;AACA,YAAI,KAAKN,MAAL,CAAYM,KAAZ,CAAJ,EAAwB;AACtB,eAAKC,OAAL,CAAaD,KAAb,EAAoB,KAApB;AACD,SAFD,MAEO;AACR;AACF;;;WAED,gBAAOP,EAAP,EAAW;AACT,UAAME,GAAG,GAAG,KAAKC,GAAL,CAASH,EAAT,CAAZ;AACA,aAAOE,GAAG,IAAIA,GAAG,CAACO,IAAlB;AACD;;;WAED,iBAAQT,EAAR,EAAYI,CAAZ,EAAe;AACb,UAAMF,GAAG,GAAG,KAAKG,QAAL,CAAcL,EAAd,CAAZ;AACA,UAAII,CAAC,KAAK,IAAV,EAAgBF,GAAG,CAACO,IAAJ,GAAW,IAAX,CAAhB,KACK,OAAOP,GAAG,CAACO,IAAX;AACN;;;WAED,kBAAST,EAAT,EAAaU,KAAb,EAAoB;AAClB,UAAMR,GAAG,GAAG,KAAKG,QAAL,CAAcL,EAAd,CAAZ;AACAE,MAAAA,GAAG,CAACQ,KAAJ,GAAYA,KAAZ;AACD;;;WAED,mBAAUC,GAAV,EAAeC,GAAf,EAAoBC,SAApB,EAA+B;AAAA;;AAC7B,aAAOnB,MAAM,CAACoB,QAAP,CAAgBH,GAAhB,EAAqBC,GAArB,EAA0B,UAACG,CAAD,EAAO;AACtC,YAAIF,SAAS,IAAIA,SAAS,CAACG,GAAV,CAAcD,CAAd,CAAjB,EAAmC,OAAO,CAAP;AACnC,eAAO,KAAI,CAACE,SAAL,CAAeF,CAAf,CAAP;AACD,OAHM,CAAP;AAID;;;WAED,uBAAc;AACZ,aAAO,KAAKG,SAAL,CAAe,CAAf,EAAkB,KAAKrB,GAAvB,CAAP;AACD;;;WAED,aAAIG,EAAJ,EAAQ;AACN,aAAO,KAAKD,CAAL,CAAOC,EAAP,CAAP;AACD;;;WAED,kBAASA,EAAT,EAAa;AACX,WAAKD,CAAL,CAAOC,EAAP,IAAa,KAAKD,CAAL,CAAOC,EAAP,KAAc;AAAEmB,QAAAA,KAAK,EAAE;AAAT,OAA3B;AACA,aAAO,KAAKpB,CAAL,CAAOC,EAAP,CAAP;AACD;;;WAED,iBAAQA,EAAR,EAAYoB,EAAZ,EAAgB;AACd,UAAMlB,GAAG,GAAG,KAAKC,GAAL,CAASH,EAAT,CAAZ;;AACA,UAAIE,GAAG,KAAKmB,SAAR,IAAqBnB,GAAG,CAACiB,KAAJ,KAAcE,SAAnC,IAAgDnB,GAAG,CAACiB,KAAJ,CAAUC,EAAV,MAAkBC,SAAtE,EAAiF;AAC/E,eAAOnB,GAAG,CAACiB,KAAJ,CAAUC,EAAV,CAAP;AACD;;AACD,aAAO,IAAP;AACD;;;WAED,sBAAapB,EAAb,EAAiBoB,EAAjB,EAAqB;AACnB,UAAME,IAAI,GAAG,KAAKC,OAAL,CAAavB,EAAb,EAAiBoB,EAAjB,CAAb;AACA,UAAIE,IAAI,IAAIA,IAAI,CAACE,KAAjB,EAAwB,OAAOF,IAAI,CAACE,KAAZ;AACxB,aAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;AACD;;;WAED,sBAAaxB,EAAb,EAAiBoB,EAAjB,EAAqB;AACnB,UAAMlB,GAAG,GAAG,KAAKG,QAAL,CAAcL,EAAd,CAAZ;AACAE,MAAAA,GAAG,CAACiB,KAAJ,CAAUC,EAAV,IAAgBlB,GAAG,CAACiB,KAAJ,CAAUC,EAAV,KAAiB,EAAjC;AACA,aAAOlB,GAAG,CAACiB,KAAJ,CAAUC,EAAV,CAAP;AACD,K,CAED;;;;WACA,iBAAQpB,EAAR,EAAYoB,EAAZ,EAAgBE,IAAhB,EAAoC;AAAA,UAAdG,IAAc,uEAAP,KAAO;AAClC,UAAMvB,GAAG,GAAG,KAAKG,QAAL,CAAcL,EAAd,CAAZ;;AACA,UAAIyB,IAAI,KAAK,KAAb,EAAoB;AAClBvB,QAAAA,GAAG,CAACiB,KAAJ,CAAUC,EAAV,IAAgBE,IAAhB;AACD,OAFD,MAEO,IAAIG,IAAI,KAAK,MAAb,EAAqB;AAC1BvB,QAAAA,GAAG,CAACiB,KAAJ,CAAUC,EAAV,IAAgBlB,GAAG,CAACiB,KAAJ,CAAUC,EAAV,KAAiB,EAAjC;AACAlB,QAAAA,GAAG,CAACiB,KAAJ,CAAUC,EAAV,EAAcM,IAAd,GAAqBJ,IAAI,CAACI,IAA1B;AACD,OAHM,MAGA,IAAID,IAAI,KAAK,QAAb,EAAuB;AAC5BvB,QAAAA,GAAG,CAACiB,KAAJ,CAAUC,EAAV,IAAgBlB,GAAG,CAACiB,KAAJ,CAAUC,EAAV,KAAiB,EAAjC;AACAlB,QAAAA,GAAG,CAACiB,KAAJ,CAAUC,EAAV,EAAcV,KAAd,GAAsBY,IAAI,CAACZ,KAA3B;AACA,YAAIY,IAAI,CAACE,KAAT,EAAgBtB,GAAG,CAACiB,KAAJ,CAAUC,EAAV,EAAcI,KAAd,GAAsBF,IAAI,CAACE,KAA3B;AACjB;AACF;;;WAED,qBAAYxB,EAAZ,EAAgBoB,EAAhB,EAAoBM,IAApB,EAA0B;AACxB,UAAMJ,IAAI,GAAG,KAAKK,YAAL,CAAkB3B,EAAlB,EAAsBoB,EAAtB,CAAb;AACAE,MAAAA,IAAI,CAACI,IAAL,GAAYA,IAAZ;AACD,K,CAED;;;;WACA,mBAAUE,YAAV,EAAwBC,YAAxB,EAAsCJ,IAAtC,EAA6E;AAAA,UAAjCK,QAAiC,uEAAtB,KAAsB;AAAA,UAAfC,EAAe,uEAAV,YAAM,CAAE,CAAE;AAAA,UAEzEC,GAFyE,GAGvEJ,YAHuE,CAEzEI,GAFyE;AAAA,UAEpEC,GAFoE,GAGvEL,YAHuE,CAEpEK,GAFoE;AAAA,UAE/DC,GAF+D,GAGvEN,YAHuE,CAE/DM,GAF+D;AAAA,UAE1DC,GAF0D,GAGvEP,YAHuE,CAE1DO,GAF0D;AAI3E,UAAMC,IAAI,GAAGP,YAAY,CAACG,GAA1B;AACA,UAAMK,IAAI,GAAGR,YAAY,CAACI,GAA1B;AACA,UAAMK,IAAI,GAAGT,YAAY,CAACK,GAA1B;AACA,UAAMK,IAAI,GAAGV,YAAY,CAACM,GAA1B;;AAP2E,+BAQ1DP,YAAY,CAACY,IAAb,EAR0D;AAAA;AAAA,UAQpEC,EARoE;AAAA,UAQhEC,EARgE;;AAAA,+BASxDb,YAAY,CAACW,IAAb,EATwD;AAAA;AAAA,UASpEG,GAToE;AAAA,UAS/DC,GAT+D,2BAU3E;;;AACA,UAAIC,KAAK,GAAG,IAAZ;AACA,UAAIC,EAAE,GAAG,CAAT;;AACA,UAAIR,IAAI,GAAGN,GAAP,IAAcO,IAAI,GAAGN,GAAzB,EAA8B;AAC5BY,QAAAA,KAAK,GAAG,KAAR;AACA,YAAIP,IAAI,GAAGN,GAAX,EAAgBc,EAAE,GAAGH,GAAL,CAAhB,KACKG,EAAE,GAAGF,GAAL;AACN;;AACD,WAAK,IAAI7B,CAAC,GAAGiB,GAAb,EAAkBjB,CAAC,IAAImB,GAAvB,EAA4BnB,CAAC,IAAI,CAAjC,EAAoC;AAClC,YAAI,KAAKhB,CAAL,CAAOgB,CAAP,CAAJ,EAAe;AACb,eAAK,IAAIgC,CAAC,GAAGd,GAAb,EAAkBc,CAAC,IAAIZ,GAAvB,EAA4BY,CAAC,IAAI,CAAjC,EAAoC;AAClC,gBAAI,KAAKhD,CAAL,CAAOgB,CAAP,EAAUI,KAAV,IAAmB,KAAKpB,CAAL,CAAOgB,CAAP,EAAUI,KAAV,CAAgB4B,CAAhB,CAAvB,EAA2C;AACzC,mBAAK,IAAIC,EAAE,GAAGZ,IAAd,EAAoBY,EAAE,IAAIV,IAA1B,EAAgCU,EAAE,IAAIP,EAAtC,EAA0C;AACxC,qBAAK,IAAIQ,EAAE,GAAGZ,IAAd,EAAoBY,EAAE,IAAIV,IAA1B,EAAgCU,EAAE,IAAIP,EAAtC,EAA0C;AACxC,sBAAMQ,GAAG,GAAGF,EAAE,IAAIjC,CAAC,GAAGiB,GAAR,CAAd;AACA,sBAAMmB,GAAG,GAAGF,EAAE,IAAIF,CAAC,GAAGd,GAAR,CAAd;AACA,sBAAMmB,KAAK,GAAG1D,MAAM,CAAC2D,SAAP,CAAiB,KAAKtD,CAAL,CAAOgB,CAAP,EAAUI,KAAV,CAAgB4B,CAAhB,CAAjB,CAAd,CAHwC,CAIxC;;AACA,sBAAIjB,QAAQ,IAAIsB,KAAZ,IAAqBA,KAAK,CAAC1B,IAA3B,IAAmC0B,KAAK,CAAC1B,IAAN,CAAW4B,MAAX,GAAoB,CAA3D,EAA8D;AAAA;AAAA,0BACpD5B,IADoD,GAC3C0B,KAD2C,CACpD1B,IADoD;AAE5D,0BAAI6B,CAAC,GAAIN,EAAE,GAAGZ,IAAN,IAAeW,EAAE,GAAGZ,IAApB,IAA4B,CAApC;;AACA,0BAAI,CAACS,KAAL,EAAY;AACVU,wBAAAA,CAAC,IAAIT,EAAE,GAAG,CAAV;AACD;;AACD,0BAAIpB,IAAI,CAAC,CAAD,CAAJ,KAAY,GAAhB,EAAqB;AACnB0B,wBAAAA,KAAK,CAAC1B,IAAN,GAAaA,IAAI,CAAC8B,OAAL,CAAa,mBAAb,EAAkC,UAACC,IAAD,EAAU;AAAA,8BAClDC,EADkD,GACvC,CADuC;AAAA,8BAC9CC,EAD8C,GACpC,CADoC;;AAEvD,8BAAI3B,GAAG,KAAKI,IAAZ,EAAkB;AAChBsB,4BAAAA,EAAE,GAAGH,CAAC,GAAG,CAAT,CADgB,CAEhB;AACD,2BAHD,MAGO;AACLI,4BAAAA,EAAE,GAAGJ,CAAC,GAAG,CAAT;AACD;;AACD,8BAAI,QAAQK,IAAR,CAAaH,IAAb,CAAJ,EAAwB,OAAOA,IAAP;AACxB,iCAAO9D,SAAS,CAAC8D,IAAD,EAAOC,EAAP,EAAWC,EAAX,CAAhB;AACD,yBAVY,CAAb;AAWD,uBAZD,MAYO,IAAKlB,EAAE,IAAI,CAAN,IAAWC,EAAE,GAAG,CAAhB,KAAsBN,IAAI,GAAGF,GAAP,IAAcI,IAAI,GAAGN,GAA3C,CAAD,IACLU,EAAE,IAAI,CAAN,IAAWD,EAAE,GAAG,CAAhB,KAAsBJ,IAAI,GAAGF,GAAP,IAAcI,IAAI,GAAGN,GAA3C,CADK,IAELQ,EAAE,IAAI,CAAN,IAAWC,EAAE,IAAI,CAFhB,EAEoB;AACzB,4BAAMmB,MAAM,GAAG,YAAYC,IAAZ,CAAiBpC,IAAjB,CAAf,CADyB,CAEzB;;AACA,4BAAImC,MAAM,KAAK,IAAf,EAAqB;AACnB,8BAAMtD,KAAK,GAAGwD,MAAM,CAACF,MAAM,CAAC,CAAD,CAAP,CAAN,GAAoBN,CAApB,GAAwB,CAAtC;AACAH,0BAAAA,KAAK,CAAC1B,IAAN,GAAaA,IAAI,CAACsC,SAAL,CAAe,CAAf,EAAkBH,MAAM,CAACtD,KAAzB,IAAkCA,KAA/C;AACD;AACF;AA3B2D;AA4B7D;;AACD,uBAAK0D,OAAL,CAAaf,GAAb,EAAkBC,GAAlB,EAAuBC,KAAvB,EAA8B3B,IAA9B;AACAM,kBAAAA,EAAE,CAACmB,GAAD,EAAMC,GAAN,EAAWC,KAAX,CAAF;AACD;AACF;AACF;AACF;AACF;AACF;AACF;;;WAED,kBAASxB,YAAT,EAAuBC,YAAvB,EAAqC;AAAA;;AACnC,UAAMqC,OAAO,GAAG,EAAhB;AACA,WAAKC,IAAL,CAAU,UAACnE,EAAD,EAAQ;AAChB,QAAA,MAAI,CAACoE,SAAL,CAAepE,EAAf,EAAmB,UAACoB,EAAD,EAAQ;AACzB,cAAI8B,GAAG,GAAGmB,QAAQ,CAACrE,EAAD,EAAK,EAAL,CAAlB;AACA,cAAImD,GAAG,GAAGkB,QAAQ,CAACjD,EAAD,EAAK,EAAL,CAAlB;;AACA,cAAIQ,YAAY,CAAC0C,QAAb,CAAsBtE,EAAtB,EAA0BoB,EAA1B,CAAJ,EAAmC;AACjC8B,YAAAA,GAAG,GAAGrB,YAAY,CAACG,GAAb,IAAoBkB,GAAG,GAAGtB,YAAY,CAACI,GAAvC,CAAN;AACAmB,YAAAA,GAAG,GAAGtB,YAAY,CAACI,GAAb,IAAoBkB,GAAG,GAAGvB,YAAY,CAACK,GAAvC,CAAN;AACD;;AACDiC,UAAAA,OAAO,CAAChB,GAAD,CAAP,GAAegB,OAAO,CAAChB,GAAD,CAAP,IAAgB;AAAE/B,YAAAA,KAAK,EAAE;AAAT,WAA/B;AACA+C,UAAAA,OAAO,CAAChB,GAAD,CAAP,CAAa/B,KAAb,CAAmBgC,GAAnB,IAA0B,MAAI,CAACpD,CAAL,CAAOC,EAAP,EAAWmB,KAAX,CAAiBC,EAAjB,CAA1B;AACD,SATD;AAUD,OAXD;AAYA,WAAKrB,CAAL,GAASmE,OAAT;AACD,K,CAED;;;;WACA,eAAMK,GAAN,EAAW1C,YAAX,EAAyB;AAAA;;AACvB,UAAI0C,GAAG,CAACjB,MAAJ,IAAc,CAAlB,EAAqB;AADE,UAEftB,GAFe,GAEFH,YAFE,CAEfG,GAFe;AAAA,UAEVC,GAFU,GAEFJ,YAFE,CAEVI,GAFU;AAGvBsC,MAAAA,GAAG,CAACC,OAAJ,CAAY,UAACtE,GAAD,EAAMa,CAAN,EAAY;AACtB,YAAMf,EAAE,GAAGgC,GAAG,GAAGjB,CAAjB;AACAb,QAAAA,GAAG,CAACsE,OAAJ,CAAY,UAAClD,IAAD,EAAOyB,CAAP,EAAa;AACvB,cAAM3B,EAAE,GAAGa,GAAG,GAAGc,CAAjB;;AACA,UAAA,MAAI,CAAC0B,WAAL,CAAiBzE,EAAjB,EAAqBoB,EAArB,EAAyBE,IAAzB;AACD,SAHD;AAID,OAND;AAOD;;;WAED,gBAAOU,GAAP,EAAmB;AAAA;;AAAA,UAAPuB,CAAO,uEAAH,CAAG;AACjB,UAAMmB,KAAK,GAAG,EAAd;AACA,WAAKP,IAAL,CAAU,UAACnE,EAAD,EAAKE,GAAL,EAAa;AACrB,YAAIgD,GAAG,GAAGmB,QAAQ,CAACrE,EAAD,EAAK,EAAL,CAAlB;;AACA,YAAIkD,GAAG,IAAIlB,GAAX,EAAgB;AACdkB,UAAAA,GAAG,IAAIK,CAAP;;AACA,UAAA,MAAI,CAACa,SAAL,CAAepE,EAAf,EAAmB,UAACoB,EAAD,EAAKE,IAAL,EAAc;AAC/B,gBAAIA,IAAI,CAACI,IAAL,IAAaJ,IAAI,CAACI,IAAL,CAAU,CAAV,MAAiB,GAAlC,EAAuC;AACrCJ,cAAAA,IAAI,CAACI,IAAL,GAAYJ,IAAI,CAACI,IAAL,CAAU8B,OAAV,CAAkB,mBAAlB,EAAuC,UAAAC,IAAI;AAAA,uBAAI9D,SAAS,CAAC8D,IAAD,EAAO,CAAP,EAAUF,CAAV,EAAa,UAACoB,CAAD,EAAIC,CAAJ;AAAA,yBAAUA,CAAC,IAAI5C,GAAf;AAAA,iBAAb,CAAb;AAAA,eAA3C,CAAZ;AACD;AACF,WAJD;AAKD;;AACD0C,QAAAA,KAAK,CAACxB,GAAD,CAAL,GAAahD,GAAb;AACD,OAXD;AAYA,WAAKH,CAAL,GAAS2E,KAAT;AACA,WAAK7E,GAAL,IAAY0D,CAAZ;AACD;;;WAED,iBAAOvB,GAAP,EAAYE,GAAZ,EAAiB;AAAA;;AACf,UAAMqB,CAAC,GAAGrB,GAAG,GAAGF,GAAN,GAAY,CAAtB;AACA,UAAM0C,KAAK,GAAG,EAAd;AACA,WAAKP,IAAL,CAAU,UAACnE,EAAD,EAAKE,GAAL,EAAa;AACrB,YAAMgD,GAAG,GAAGmB,QAAQ,CAACrE,EAAD,EAAK,EAAL,CAApB;;AACA,YAAIkD,GAAG,GAAGlB,GAAV,EAAe;AACb0C,UAAAA,KAAK,CAACxB,GAAD,CAAL,GAAahD,GAAb;AACD,SAFD,MAEO,IAAIF,EAAE,GAAGkC,GAAT,EAAc;AACnBwC,UAAAA,KAAK,CAACxB,GAAG,GAAGK,CAAP,CAAL,GAAiBrD,GAAjB;;AACA,UAAA,MAAI,CAACkE,SAAL,CAAepE,EAAf,EAAmB,UAACoB,EAAD,EAAKE,IAAL,EAAc;AAC/B,gBAAIA,IAAI,CAACI,IAAL,IAAaJ,IAAI,CAACI,IAAL,CAAU,CAAV,MAAiB,GAAlC,EAAuC;AACrCJ,cAAAA,IAAI,CAACI,IAAL,GAAYJ,IAAI,CAACI,IAAL,CAAU8B,OAAV,CAAkB,mBAAlB,EAAuC,UAAAC,IAAI;AAAA,uBAAI9D,SAAS,CAAC8D,IAAD,EAAO,CAAP,EAAU,CAACF,CAAX,EAAc,UAACoB,CAAD,EAAIC,CAAJ;AAAA,yBAAUA,CAAC,GAAG1C,GAAd;AAAA,iBAAd,CAAb;AAAA,eAA3C,CAAZ;AACD;AACF,WAJD;AAKD;AACF,OAZD;AAaA,WAAKnC,CAAL,GAAS2E,KAAT;AACA,WAAK7E,GAAL,IAAY0D,CAAZ;AACD;;;WAED,sBAAatB,GAAb,EAAyB;AAAA;;AAAA,UAAPsB,CAAO,uEAAH,CAAG;AACvB,WAAKY,IAAL,CAAU,UAACnE,EAAD,EAAKE,GAAL,EAAa;AACrB,YAAM2E,MAAM,GAAG,EAAf;;AACA,QAAA,MAAI,CAACT,SAAL,CAAepE,EAAf,EAAmB,UAACoB,EAAD,EAAKE,IAAL,EAAc;AAC/B,cAAI6B,GAAG,GAAGkB,QAAQ,CAACjD,EAAD,EAAK,EAAL,CAAlB;;AACA,cAAI+B,GAAG,IAAIlB,GAAX,EAAgB;AACdkB,YAAAA,GAAG,IAAII,CAAP;;AACA,gBAAIjC,IAAI,CAACI,IAAL,IAAaJ,IAAI,CAACI,IAAL,CAAU,CAAV,MAAiB,GAAlC,EAAuC;AACrCJ,cAAAA,IAAI,CAACI,IAAL,GAAYJ,IAAI,CAACI,IAAL,CAAU8B,OAAV,CAAkB,mBAAlB,EAAuC,UAAAC,IAAI;AAAA,uBAAI9D,SAAS,CAAC8D,IAAD,EAAOF,CAAP,EAAU,CAAV,EAAa,UAAAoB,CAAC;AAAA,yBAAIA,CAAC,IAAI1C,GAAT;AAAA,iBAAd,CAAb;AAAA,eAA3C,CAAZ;AACD;AACF;;AACD4C,UAAAA,MAAM,CAAC1B,GAAD,CAAN,GAAc7B,IAAd;AACD,SATD;;AAUApB,QAAAA,GAAG,CAACiB,KAAJ,GAAY0D,MAAZ;AACD,OAbD;AAcD;;;WAED,sBAAa5C,GAAb,EAAkBE,GAAlB,EAAuB;AAAA;;AACrB,UAAMoB,CAAC,GAAGpB,GAAG,GAAGF,GAAN,GAAY,CAAtB;AACA,WAAKkC,IAAL,CAAU,UAACnE,EAAD,EAAKE,GAAL,EAAa;AACrB,YAAM2E,MAAM,GAAG,EAAf;;AACA,QAAA,MAAI,CAACT,SAAL,CAAepE,EAAf,EAAmB,UAACoB,EAAD,EAAKE,IAAL,EAAc;AAC/B,cAAM6B,GAAG,GAAGkB,QAAQ,CAACjD,EAAD,EAAK,EAAL,CAApB;;AACA,cAAI+B,GAAG,GAAGlB,GAAV,EAAe;AACb4C,YAAAA,MAAM,CAAC1B,GAAD,CAAN,GAAc7B,IAAd;AACD,WAFD,MAEO,IAAI6B,GAAG,GAAGhB,GAAV,EAAe;AACpB0C,YAAAA,MAAM,CAAC1B,GAAG,GAAGI,CAAP,CAAN,GAAkBjC,IAAlB;;AACA,gBAAIA,IAAI,CAACI,IAAL,IAAaJ,IAAI,CAACI,IAAL,CAAU,CAAV,MAAiB,GAAlC,EAAuC;AACrCJ,cAAAA,IAAI,CAACI,IAAL,GAAYJ,IAAI,CAACI,IAAL,CAAU8B,OAAV,CAAkB,mBAAlB,EAAuC,UAAAC,IAAI;AAAA,uBAAI9D,SAAS,CAAC8D,IAAD,EAAO,CAACF,CAAR,EAAW,CAAX,EAAc,UAAAoB,CAAC;AAAA,yBAAIA,CAAC,GAAGxC,GAAR;AAAA,iBAAf,CAAb;AAAA,eAA3C,CAAZ;AACD;AACF;AACF,SAVD;;AAWAjC,QAAAA,GAAG,CAACiB,KAAJ,GAAY0D,MAAZ;AACD,OAdD;AAeD,K,CAED;;;;WACA,qBAAYC,SAAZ,EAAqC;AAAA;;AAAA,UAAdrD,IAAc,uEAAP,KAAO;AACnCqD,MAAAA,SAAS,CAACX,IAAV,CAAe,UAACpD,CAAD,EAAIgC,CAAJ,EAAU;AACvB,QAAA,MAAI,CAACgC,UAAL,CAAgBhE,CAAhB,EAAmBgC,CAAnB,EAAsBtB,IAAtB;AACD,OAFD;AAGD,K,CAED;;;;WACA,oBAAWzB,EAAX,EAAeoB,EAAf,EAAiC;AAAA,UAAdK,IAAc,uEAAP,KAAO;AAC/B,UAAMvB,GAAG,GAAG,KAAKC,GAAL,CAASH,EAAT,CAAZ;;AACA,UAAIE,GAAG,KAAK,IAAZ,EAAkB;AAChB,YAAMoB,IAAI,GAAG,KAAKC,OAAL,CAAavB,EAAb,EAAiBoB,EAAjB,CAAb;;AACA,YAAIE,IAAI,KAAK,IAAb,EAAmB;AACjB,cAAIG,IAAI,KAAK,KAAb,EAAoB;AAClB,mBAAOvB,GAAG,CAACiB,KAAJ,CAAUC,EAAV,CAAP;AACD,WAFD,MAEO,IAAIK,IAAI,KAAK,MAAb,EAAqB;AAC1B,gBAAIH,IAAI,CAACI,IAAT,EAAe,OAAOJ,IAAI,CAACI,IAAZ;AACf,gBAAIJ,IAAI,CAAC0D,KAAT,EAAgB,OAAO1D,IAAI,CAAC0D,KAAZ;AACjB,WAHM,MAGA,IAAIvD,IAAI,KAAK,QAAb,EAAuB;AAC5B,gBAAIH,IAAI,CAACZ,KAAL,KAAeW,SAAnB,EAA8B,OAAOC,IAAI,CAACZ,KAAZ;AAC9B,gBAAIY,IAAI,CAACE,KAAT,EAAgB,OAAOF,IAAI,CAACE,KAAZ;AACjB,WAHM,MAGA,IAAIC,IAAI,KAAK,OAAb,EAAsB;AAC3B,gBAAIH,IAAI,CAACE,KAAT,EAAgB,OAAOF,IAAI,CAACE,KAAZ;AACjB;AACF;AACF;AACF;;;WAED,mBAAU;AACR,UAAMyD,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAY,KAAKlF,CAAjB,CAAb;AACA,UAAMC,EAAE,GAAGiF,IAAI,CAACA,IAAI,CAAC3B,MAAL,GAAc,CAAf,CAAf;AACA,UAAM6B,GAAG,GAAG,KAAKpF,CAAL,CAAOC,EAAP,CAAZ;;AACA,UAAImF,GAAJ,EAAS;AAAA,YACChE,KADD,GACWgE,GADX,CACChE,KADD;AAEP,YAAMiE,EAAE,GAAGF,MAAM,CAACD,IAAP,CAAY9D,KAAZ,CAAX;AACA,YAAMC,EAAE,GAAGgE,EAAE,CAACA,EAAE,CAAC9B,MAAH,GAAY,CAAb,CAAb;AACA,eAAO,CAACe,QAAQ,CAACrE,EAAD,EAAK,EAAL,CAAT,EAAmBqE,QAAQ,CAACjD,EAAD,EAAK,EAAL,CAA3B,CAAP;AACD;;AACD,aAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;AACD;;;WAED,cAAKW,EAAL,EAAS;AACPmD,MAAAA,MAAM,CAACG,OAAP,CAAe,KAAKtF,CAApB,EAAuByE,OAAvB,CAA+B,iBAAe;AAAA;AAAA,YAAbxE,EAAa;AAAA,YAATE,GAAS;;AAC5C6B,QAAAA,EAAE,CAAC/B,EAAD,EAAKE,GAAL,CAAF;AACD,OAFD;AAGD;;;WAED,mBAAUF,EAAV,EAAc+B,EAAd,EAAkB;AAChB,UAAI,KAAKhC,CAAL,CAAOC,EAAP,KAAc,KAAKD,CAAL,CAAOC,EAAP,EAAWmB,KAA7B,EAAoC;AAClC+D,QAAAA,MAAM,CAACG,OAAP,CAAe,KAAKtF,CAAL,CAAOC,EAAP,EAAWmB,KAA1B,EAAiCqD,OAAjC,CAAyC,iBAAgB;AAAA;AAAA,cAAdpD,EAAc;AAAA,cAAVE,IAAU;;AACvDS,UAAAA,EAAE,CAACX,EAAD,EAAKE,IAAL,CAAF;AACD,SAFD;AAGD;AACF;;;WAED,iBAAQgE,CAAR,EAAW;AACT,UAAIA,CAAC,CAACzF,GAAN,EAAW;AACT,aAAKA,GAAL,GAAWyF,CAAC,CAACzF,GAAb;AACA,eAAOyF,CAAC,CAACzF,GAAT;AACD;;AACD,WAAKE,CAAL,GAASuF,CAAT;AACD;;;WAED,mBAAU;AAAA,UACAzF,GADA,GACQ,IADR,CACAA,GADA;AAER,aAAOqF,MAAM,CAACK,MAAP,CAAc;AAAE1F,QAAAA,GAAG,EAAHA;AAAF,OAAd,EAAuB,KAAKE,CAA5B,CAAP;AACD;;;;;;AAGH,eAAe,EAAf;AACA,SACEH,IADF","sourcesContent":["import helper from './helper';\r\nimport { expr2expr } from './alphabet';\r\n\r\nclass Rows {\r\n  constructor({ len, height }) {\r\n    this._ = {};\r\n    this.len = len;\r\n    // default row height\r\n    this.height = height;\r\n  }\r\n\r\n  getHeight(ri) {\r\n    if (this.isHide(ri)) return 0;\r\n    const row = this.get(ri);\r\n    if (row && row.height) {\r\n      return row.height;\r\n    }\r\n    return this.height;\r\n  }\r\n\r\n  setHeight(ri, v) {\r\n    const row = this.getOrNew(ri);\r\n    row.height = v;\r\n  }\r\n\r\n  unhide(idx) {\r\n    let index = idx;\r\n    while (index > 0) {\r\n      index -= 1;\r\n      if (this.isHide(index)) {\r\n        this.setHide(index, false);\r\n      } else break;\r\n    }\r\n  }\r\n\r\n  isHide(ri) {\r\n    const row = this.get(ri);\r\n    return row && row.hide;\r\n  }\r\n\r\n  setHide(ri, v) {\r\n    const row = this.getOrNew(ri);\r\n    if (v === true) row.hide = true;\r\n    else delete row.hide;\r\n  }\r\n\r\n  setStyle(ri, style) {\r\n    const row = this.getOrNew(ri);\r\n    row.style = style;\r\n  }\r\n\r\n  sumHeight(min, max, exceptSet) {\r\n    return helper.rangeSum(min, max, (i) => {\r\n      if (exceptSet && exceptSet.has(i)) return 0;\r\n      return this.getHeight(i);\r\n    });\r\n  }\r\n\r\n  totalHeight() {\r\n    return this.sumHeight(0, this.len);\r\n  }\r\n\r\n  get(ri) {\r\n    return this._[ri];\r\n  }\r\n\r\n  getOrNew(ri) {\r\n    this._[ri] = this._[ri] || { cells: {} };\r\n    return this._[ri];\r\n  }\r\n\r\n  getCell(ri, ci) {\r\n    const row = this.get(ri);\r\n    if (row !== undefined && row.cells !== undefined && row.cells[ci] !== undefined) {\r\n      return row.cells[ci];\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getCellMerge(ri, ci) {\r\n    const cell = this.getCell(ri, ci);\r\n    if (cell && cell.merge) return cell.merge;\r\n    return [0, 0];\r\n  }\r\n\r\n  getCellOrNew(ri, ci) {\r\n    const row = this.getOrNew(ri);\r\n    row.cells[ci] = row.cells[ci] || {};\r\n    return row.cells[ci];\r\n  }\r\n\r\n  // what: all | text | format\r\n  setCell(ri, ci, cell, what = 'all') {\r\n    const row = this.getOrNew(ri);\r\n    if (what === 'all') {\r\n      row.cells[ci] = cell;\r\n    } else if (what === 'text') {\r\n      row.cells[ci] = row.cells[ci] || {};\r\n      row.cells[ci].text = cell.text;\r\n    } else if (what === 'format') {\r\n      row.cells[ci] = row.cells[ci] || {};\r\n      row.cells[ci].style = cell.style;\r\n      if (cell.merge) row.cells[ci].merge = cell.merge;\r\n    }\r\n  }\r\n\r\n  setCellText(ri, ci, text) {\r\n    const cell = this.getCellOrNew(ri, ci);\r\n    cell.text = text;\r\n  }\r\n\r\n  // what: all | format | text\r\n  copyPaste(srcCellRange, dstCellRange, what, autofill = false, cb = () => {}) {\r\n    const {\r\n      sri, sci, eri, eci,\r\n    } = srcCellRange;\r\n    const dsri = dstCellRange.sri;\r\n    const dsci = dstCellRange.sci;\r\n    const deri = dstCellRange.eri;\r\n    const deci = dstCellRange.eci;\r\n    const [rn, cn] = srcCellRange.size();\r\n    const [drn, dcn] = dstCellRange.size();\r\n    // console.log(srcIndexes, dstIndexes);\r\n    let isAdd = true;\r\n    let dn = 0;\r\n    if (deri < sri || deci < sci) {\r\n      isAdd = false;\r\n      if (deri < sri) dn = drn;\r\n      else dn = dcn;\r\n    }\r\n    for (let i = sri; i <= eri; i += 1) {\r\n      if (this._[i]) {\r\n        for (let j = sci; j <= eci; j += 1) {\r\n          if (this._[i].cells && this._[i].cells[j]) {\r\n            for (let ii = dsri; ii <= deri; ii += rn) {\r\n              for (let jj = dsci; jj <= deci; jj += cn) {\r\n                const nri = ii + (i - sri);\r\n                const nci = jj + (j - sci);\r\n                const ncell = helper.cloneDeep(this._[i].cells[j]);\r\n                // ncell.text\r\n                if (autofill && ncell && ncell.text && ncell.text.length > 0) {\r\n                  const { text } = ncell;\r\n                  let n = (jj - dsci) + (ii - dsri) + 2;\r\n                  if (!isAdd) {\r\n                    n -= dn + 1;\r\n                  }\r\n                  if (text[0] === '=') {\r\n                    ncell.text = text.replace(/[a-zA-Z]{1,3}\\d+/g, (word) => {\r\n                      let [xn, yn] = [0, 0];\r\n                      if (sri === dsri) {\r\n                        xn = n - 1;\r\n                        // if (isAdd) xn -= 1;\r\n                      } else {\r\n                        yn = n - 1;\r\n                      }\r\n                      if (/^\\d+$/.test(word)) return word;\r\n                      return expr2expr(word, xn, yn);\r\n                    });\r\n                  } else if ((rn <= 1 && cn > 1 && (dsri > eri || deri < sri))\r\n                    || (cn <= 1 && rn > 1 && (dsci > eci || deci < sci))\r\n                    || (rn <= 1 && cn <= 1)) {\r\n                    const result = /[\\\\.\\d]+$/.exec(text);\r\n                    // console.log('result:', result);\r\n                    if (result !== null) {\r\n                      const index = Number(result[0]) + n - 1;\r\n                      ncell.text = text.substring(0, result.index) + index;\r\n                    }\r\n                  }\r\n                }\r\n                this.setCell(nri, nci, ncell, what);\r\n                cb(nri, nci, ncell);\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  cutPaste(srcCellRange, dstCellRange) {\r\n    const ncellmm = {};\r\n    this.each((ri) => {\r\n      this.eachCells(ri, (ci) => {\r\n        let nri = parseInt(ri, 10);\r\n        let nci = parseInt(ci, 10);\r\n        if (srcCellRange.includes(ri, ci)) {\r\n          nri = dstCellRange.sri + (nri - srcCellRange.sri);\r\n          nci = dstCellRange.sci + (nci - srcCellRange.sci);\r\n        }\r\n        ncellmm[nri] = ncellmm[nri] || { cells: {} };\r\n        ncellmm[nri].cells[nci] = this._[ri].cells[ci];\r\n      });\r\n    });\r\n    this._ = ncellmm;\r\n  }\r\n\r\n  // src: Array<Array<String>>\r\n  paste(src, dstCellRange) {\r\n    if (src.length <= 0) return;\r\n    const { sri, sci } = dstCellRange;\r\n    src.forEach((row, i) => {\r\n      const ri = sri + i;\r\n      row.forEach((cell, j) => {\r\n        const ci = sci + j;\r\n        this.setCellText(ri, ci, cell);\r\n      });\r\n    });\r\n  }\r\n\r\n  insert(sri, n = 1) {\r\n    const ndata = {};\r\n    this.each((ri, row) => {\r\n      let nri = parseInt(ri, 10);\r\n      if (nri >= sri) {\r\n        nri += n;\r\n        this.eachCells(ri, (ci, cell) => {\r\n          if (cell.text && cell.text[0] === '=') {\r\n            cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => expr2expr(word, 0, n, (x, y) => y >= sri));\r\n          }\r\n        });\r\n      }\r\n      ndata[nri] = row;\r\n    });\r\n    this._ = ndata;\r\n    this.len += n;\r\n  }\r\n\r\n  delete(sri, eri) {\r\n    const n = eri - sri + 1;\r\n    const ndata = {};\r\n    this.each((ri, row) => {\r\n      const nri = parseInt(ri, 10);\r\n      if (nri < sri) {\r\n        ndata[nri] = row;\r\n      } else if (ri > eri) {\r\n        ndata[nri - n] = row;\r\n        this.eachCells(ri, (ci, cell) => {\r\n          if (cell.text && cell.text[0] === '=') {\r\n            cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => expr2expr(word, 0, -n, (x, y) => y > eri));\r\n          }\r\n        });\r\n      }\r\n    });\r\n    this._ = ndata;\r\n    this.len -= n;\r\n  }\r\n\r\n  insertColumn(sci, n = 1) {\r\n    this.each((ri, row) => {\r\n      const rndata = {};\r\n      this.eachCells(ri, (ci, cell) => {\r\n        let nci = parseInt(ci, 10);\r\n        if (nci >= sci) {\r\n          nci += n;\r\n          if (cell.text && cell.text[0] === '=') {\r\n            cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => expr2expr(word, n, 0, x => x >= sci));\r\n          }\r\n        }\r\n        rndata[nci] = cell;\r\n      });\r\n      row.cells = rndata;\r\n    });\r\n  }\r\n\r\n  deleteColumn(sci, eci) {\r\n    const n = eci - sci + 1;\r\n    this.each((ri, row) => {\r\n      const rndata = {};\r\n      this.eachCells(ri, (ci, cell) => {\r\n        const nci = parseInt(ci, 10);\r\n        if (nci < sci) {\r\n          rndata[nci] = cell;\r\n        } else if (nci > eci) {\r\n          rndata[nci - n] = cell;\r\n          if (cell.text && cell.text[0] === '=') {\r\n            cell.text = cell.text.replace(/[a-zA-Z]{1,3}\\d+/g, word => expr2expr(word, -n, 0, x => x > eci));\r\n          }\r\n        }\r\n      });\r\n      row.cells = rndata;\r\n    });\r\n  }\r\n\r\n  // what: all | text | format | merge\r\n  deleteCells(cellRange, what = 'all') {\r\n    cellRange.each((i, j) => {\r\n      this.deleteCell(i, j, what);\r\n    });\r\n  }\r\n\r\n  // what: all | text | format | merge\r\n  deleteCell(ri, ci, what = 'all') {\r\n    const row = this.get(ri);\r\n    if (row !== null) {\r\n      const cell = this.getCell(ri, ci);\r\n      if (cell !== null) {\r\n        if (what === 'all') {\r\n          delete row.cells[ci];\r\n        } else if (what === 'text') {\r\n          if (cell.text) delete cell.text;\r\n          if (cell.value) delete cell.value;\r\n        } else if (what === 'format') {\r\n          if (cell.style !== undefined) delete cell.style;\r\n          if (cell.merge) delete cell.merge;\r\n        } else if (what === 'merge') {\r\n          if (cell.merge) delete cell.merge;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  maxCell() {\r\n    const keys = Object.keys(this._);\r\n    const ri = keys[keys.length - 1];\r\n    const col = this._[ri];\r\n    if (col) {\r\n      const { cells } = col;\r\n      const ks = Object.keys(cells);\r\n      const ci = ks[ks.length - 1];\r\n      return [parseInt(ri, 10), parseInt(ci, 10)];\r\n    }\r\n    return [0, 0];\r\n  }\r\n\r\n  each(cb) {\r\n    Object.entries(this._).forEach(([ri, row]) => {\r\n      cb(ri, row);\r\n    });\r\n  }\r\n\r\n  eachCells(ri, cb) {\r\n    if (this._[ri] && this._[ri].cells) {\r\n      Object.entries(this._[ri].cells).forEach(([ci, cell]) => {\r\n        cb(ci, cell);\r\n      });\r\n    }\r\n  }\r\n\r\n  setData(d) {\r\n    if (d.len) {\r\n      this.len = d.len;\r\n      delete d.len;\r\n    }\r\n    this._ = d;\r\n  }\r\n\r\n  getData() {\r\n    const { len } = this;\r\n    return Object.assign({ len }, this._);\r\n  }\r\n}\r\n\r\nexport default {};\r\nexport {\r\n  Rows,\r\n};\r\n"]}]}