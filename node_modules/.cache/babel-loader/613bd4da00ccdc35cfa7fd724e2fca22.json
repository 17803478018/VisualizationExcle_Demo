{"remainingRequest":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js!D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\代码\\del_demo\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\component\\table.js","dependencies":[{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\component\\table.js","mtime":1614915429343},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596536485880},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1606828682259},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js","mtime":1603719226989}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIkQ6L1x1NEVFM1x1NzgwMS9kZWxfZGVtby9WaXN1YWxpemF0aW9uRXhjbGVfRGVtby9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheSI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiRDovXHU0RUUzXHU3ODAxL2RlbF9kZW1vL1Zpc3VhbGl6YXRpb25FeGNsZV9EZW1vL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiRDovXHU0RUUzXHU3ODAxL2RlbF9kZW1vL1Zpc3VhbGl6YXRpb25FeGNsZV9EZW1vL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zdHJpa2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zZXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCB7IHN0cmluZ0F0IH0gZnJvbSAnLi4vY29yZS9hbHBoYWJldCc7CmltcG9ydCB7IGdldEZvbnRTaXplUHhCeVB0IH0gZnJvbSAnLi4vY29yZS9mb250JzsKaW1wb3J0IF9jZWxsIGZyb20gJy4uL2NvcmUvY2VsbCc7CmltcG9ydCB7IGZvcm11bGFtIH0gZnJvbSAnLi4vY29yZS9mb3JtdWxhJzsKaW1wb3J0IHsgZm9ybWF0bSB9IGZyb20gJy4uL2NvcmUvZm9ybWF0JzsKaW1wb3J0IHsgRHJhdywgRHJhd0JveCwgdGhpbkxpbmVXaWR0aCwgbnB4IH0gZnJvbSAnLi4vY2FudmFzL2RyYXcnOyAvLyBnb2JhbCB2YXIKCnZhciBjZWxsUGFkZGluZ1dpZHRoID0gNTsKdmFyIHRhYmxlRml4ZWRIZWFkZXJDbGVhblN0eWxlID0gewogIGZpbGxTdHlsZTogJyNmNGY1ZjgnCn07CnZhciB0YWJsZUdyaWRTdHlsZSA9IHsKICBmaWxsU3R5bGU6ICcjZmZmJywKICBsaW5lV2lkdGg6IHRoaW5MaW5lV2lkdGgsCiAgc3Ryb2tlU3R5bGU6ICcjZTZlNmU2Jwp9OwoKZnVuY3Rpb24gdGFibGVGaXhlZEhlYWRlclN0eWxlKCkgewogIHJldHVybiB7CiAgICB0ZXh0QWxpZ246ICdjZW50ZXInLAogICAgdGV4dEJhc2VsaW5lOiAnbWlkZGxlJywKICAgIGZvbnQ6ICI1MDAgIi5jb25jYXQobnB4KDEyKSwgInB4IFNvdXJjZSBTYW5zIFBybyIpLAogICAgZmlsbFN0eWxlOiAnIzU4NTc1NycsCiAgICBsaW5lV2lkdGg6IHRoaW5MaW5lV2lkdGgoKSwKICAgIHN0cm9rZVN0eWxlOiAnI2U2ZTZlNicKICB9Owp9CgpmdW5jdGlvbiBnZXREcmF3Qm94KGRhdGEsIHJpbmRleCwgY2luZGV4KSB7CiAgdmFyIHlvZmZzZXQgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IDA7CgogIHZhciBfZGF0YSRjZWxsUmVjdCA9IGRhdGEuY2VsbFJlY3QocmluZGV4LCBjaW5kZXgpLAogICAgICBsZWZ0ID0gX2RhdGEkY2VsbFJlY3QubGVmdCwKICAgICAgdG9wID0gX2RhdGEkY2VsbFJlY3QudG9wLAogICAgICB3aWR0aCA9IF9kYXRhJGNlbGxSZWN0LndpZHRoLAogICAgICBoZWlnaHQgPSBfZGF0YSRjZWxsUmVjdC5oZWlnaHQ7CgogIHJldHVybiBuZXcgRHJhd0JveChsZWZ0LCB0b3AgKyB5b2Zmc2V0LCB3aWR0aCwgaGVpZ2h0LCBjZWxsUGFkZGluZ1dpZHRoKTsKfQovKg0KZnVuY3Rpb24gcmVuZGVyQ2VsbEJvcmRlcnMoYmJveGVzLCB0cmFuc2xhdGVGdW5jKSB7DQogIGNvbnN0IHsgZHJhdyB9ID0gdGhpczsNCiAgaWYgKGJib3hlcykgew0KICAgIGNvbnN0IHJzZXQgPSBuZXcgU2V0KCk7DQogICAgLy8gY29uc29sZS5sb2coJ2Jib3hlczonLCBiYm94ZXMpOw0KICAgIGJib3hlcy5mb3JFYWNoKCh7IHJpLCBjaSwgYm94IH0pID0+IHsNCiAgICAgIGlmICghcnNldC5oYXMocmkpKSB7DQogICAgICAgIHJzZXQuYWRkKHJpKTsNCiAgICAgICAgdHJhbnNsYXRlRnVuYyhyaSk7DQogICAgICB9DQogICAgICBkcmF3LnN0cm9rZUJvcmRlcnMoYm94KTsNCiAgICB9KTsNCiAgfQ0KfQ0KKi8KCgpleHBvcnQgZnVuY3Rpb24gcmVuZGVyQ2VsbChkcmF3LCBkYXRhLCByaW5kZXgsIGNpbmRleCkgewogIHZhciB5b2Zmc2V0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiAwOwogIHZhciBzb3J0ZWRSb3dNYXAgPSBkYXRhLnNvcnRlZFJvd01hcCwKICAgICAgcm93cyA9IGRhdGEucm93cywKICAgICAgY29scyA9IGRhdGEuY29sczsKICBpZiAocm93cy5pc0hpZGUocmluZGV4KSB8fCBjb2xzLmlzSGlkZShjaW5kZXgpKSByZXR1cm47CiAgdmFyIG5yaW5kZXggPSByaW5kZXg7CgogIGlmIChzb3J0ZWRSb3dNYXAuaGFzKHJpbmRleCkpIHsKICAgIG5yaW5kZXggPSBzb3J0ZWRSb3dNYXAuZ2V0KHJpbmRleCk7CiAgfQoKICB2YXIgY2VsbCA9IGRhdGEuZ2V0Q2VsbChucmluZGV4LCBjaW5kZXgpOwogIGlmIChjZWxsID09PSBudWxsKSByZXR1cm47CiAgdmFyIGZyb3plbiA9IGZhbHNlOwoKICBpZiAoJ2VkaXRhYmxlJyBpbiBjZWxsICYmIGNlbGwuZWRpdGFibGUgPT09IGZhbHNlKSB7CiAgICBmcm96ZW4gPSB0cnVlOwogIH0KCiAgdmFyIHN0eWxlID0gZGF0YS5nZXRDZWxsU3R5bGVPckRlZmF1bHQobnJpbmRleCwgY2luZGV4KTsKICB2YXIgZGJveCA9IGdldERyYXdCb3goZGF0YSwgcmluZGV4LCBjaW5kZXgsIHlvZmZzZXQpOwogIGRib3guYmdjb2xvciA9IHN0eWxlLmJnY29sb3I7CgogIGlmIChzdHlsZS5ib3JkZXIgIT09IHVuZGVmaW5lZCkgewogICAgZGJveC5zZXRCb3JkZXJzKHN0eWxlLmJvcmRlcik7IC8vIGJib3hlcy5wdXNoKHsgcmk6IHJpbmRleCwgY2k6IGNpbmRleCwgYm94OiBkYm94IH0pOwoKICAgIGRyYXcuc3Ryb2tlQm9yZGVycyhkYm94KTsKICB9CgogIGRyYXcucmVjdChkYm94LCBmdW5jdGlvbiAoKSB7CiAgICAvLyByZW5kZXIgdGV4dAogICAgdmFyIGNlbGxUZXh0ID0gIiI7CgogICAgaWYgKCFkYXRhLnNldHRpbmdzLmV2YWxQYXVzZWQpIHsKICAgICAgY2VsbFRleHQgPSBfY2VsbC5yZW5kZXIoY2VsbC50ZXh0IHx8ICcnLCBmb3JtdWxhbSwgZnVuY3Rpb24gKHksIHgpIHsKICAgICAgICByZXR1cm4gZGF0YS5nZXRDZWxsVGV4dE9yRGVmYXVsdCh4LCB5KTsKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBjZWxsVGV4dCA9IGNlbGwudGV4dCB8fCAnJzsKICAgIH0KCiAgICBpZiAoc3R5bGUuZm9ybWF0KSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKGRhdGEuZm9ybWF0bSwgJz4+JywgY2VsbC5mb3JtYXQpOwogICAgICBjZWxsVGV4dCA9IGZvcm1hdG1bc3R5bGUuZm9ybWF0XS5yZW5kZXIoY2VsbFRleHQpOwogICAgfQoKICAgIHZhciBmb250ID0gT2JqZWN0LmFzc2lnbih7fSwgc3R5bGUuZm9udCk7CiAgICBmb250LnNpemUgPSBnZXRGb250U2l6ZVB4QnlQdChmb250LnNpemUpOyAvLyBjb25zb2xlLmxvZygnc3R5bGU6Jywgc3R5bGUpOwoKICAgIGRyYXcudGV4dChjZWxsVGV4dCwgZGJveCwgewogICAgICBhbGlnbjogc3R5bGUuYWxpZ24sCiAgICAgIHZhbGlnbjogc3R5bGUudmFsaWduLAogICAgICBmb250OiBmb250LAogICAgICBjb2xvcjogc3R5bGUuY29sb3IsCiAgICAgIHN0cmlrZTogc3R5bGUuc3RyaWtlLAogICAgICB1bmRlcmxpbmU6IHN0eWxlLnVuZGVybGluZQogICAgfSwgc3R5bGUudGV4dHdyYXApOyAvLyBlcnJvcgoKICAgIHZhciBlcnJvciA9IGRhdGEudmFsaWRhdGlvbnMuZ2V0RXJyb3IocmluZGV4LCBjaW5kZXgpOwoKICAgIGlmIChlcnJvcikgewogICAgICAvLyBjb25zb2xlLmxvZygnZXJyb3I6JywgcmluZGV4LCBjaW5kZXgsIGVycm9yKTsKICAgICAgZHJhdy5lcnJvcihkYm94KTsKICAgIH0KCiAgICBpZiAoZnJvemVuKSB7CiAgICAgIGRyYXcuZnJvemVuKGRib3gpOwogICAgfQogIH0pOwp9CgpmdW5jdGlvbiByZW5kZXJBdXRvZmlsdGVyKHZpZXdSYW5nZSkgewogIHZhciBkYXRhID0gdGhpcy5kYXRhLAogICAgICBkcmF3ID0gdGhpcy5kcmF3OwoKICBpZiAodmlld1JhbmdlKSB7CiAgICB2YXIgYXV0b0ZpbHRlciA9IGRhdGEuYXV0b0ZpbHRlcjsKICAgIGlmICghYXV0b0ZpbHRlci5hY3RpdmUoKSkgcmV0dXJuOwogICAgdmFyIGFmUmFuZ2UgPSBhdXRvRmlsdGVyLmhyYW5nZSgpOwoKICAgIGlmICh2aWV3UmFuZ2UuaW50ZXJzZWN0cyhhZlJhbmdlKSkgewogICAgICBhZlJhbmdlLmVhY2goZnVuY3Rpb24gKHJpLCBjaSkgewogICAgICAgIHZhciBkYm94ID0gZ2V0RHJhd0JveChkYXRhLCByaSwgY2kpOwogICAgICAgIGRyYXcuZHJvcGRvd24oZGJveCk7CiAgICAgIH0pOwogICAgfQogIH0KfQoKZnVuY3Rpb24gcmVuZGVyQ29udGVudCh2aWV3UmFuZ2UsIGZ3LCBmaCwgdHgsIHR5KSB7CiAgdmFyIGRyYXcgPSB0aGlzLmRyYXcsCiAgICAgIGRhdGEgPSB0aGlzLmRhdGE7CiAgZHJhdy5zYXZlKCk7CiAgZHJhdy50cmFuc2xhdGUoZncsIGZoKS50cmFuc2xhdGUodHgsIHR5KTsKICB2YXIgZXhjZXB0Um93U2V0ID0gZGF0YS5leGNlcHRSb3dTZXQ7IC8vIGNvbnN0IGV4Y2VwdFJvd3MgPSBBcnJheS5mcm9tKGV4Y2VwdFJvd1NldCk7CgogIHZhciBmaWx0ZXJlZFRyYW5zbGF0ZUZ1bmMgPSBmdW5jdGlvbiBmaWx0ZXJlZFRyYW5zbGF0ZUZ1bmMocmkpIHsKICAgIHZhciByZXQgPSBleGNlcHRSb3dTZXQuaGFzKHJpKTsKCiAgICBpZiAocmV0KSB7CiAgICAgIHZhciBoZWlnaHQgPSBkYXRhLnJvd3MuZ2V0SGVpZ2h0KHJpKTsKICAgICAgZHJhdy50cmFuc2xhdGUoMCwgLWhlaWdodCk7CiAgICB9CgogICAgcmV0dXJuICFyZXQ7CiAgfTsKCiAgdmFyIGV4Y2VwdFJvd1RvdGFsSGVpZ2h0ID0gZGF0YS5leGNlcHRSb3dUb3RhbEhlaWdodCh2aWV3UmFuZ2Uuc3JpLCB2aWV3UmFuZ2UuZXJpKTsgLy8gMSByZW5kZXIgY2VsbAoKICBkcmF3LnNhdmUoKTsKICBkcmF3LnRyYW5zbGF0ZSgwLCAtZXhjZXB0Um93VG90YWxIZWlnaHQpOwogIHZpZXdSYW5nZS5lYWNoKGZ1bmN0aW9uIChyaSwgY2kpIHsKICAgIHJlbmRlckNlbGwoZHJhdywgZGF0YSwgcmksIGNpKTsKICB9LCBmdW5jdGlvbiAocmkpIHsKICAgIHJldHVybiBmaWx0ZXJlZFRyYW5zbGF0ZUZ1bmMocmkpOwogIH0pOwogIGRyYXcucmVzdG9yZSgpOyAvLyAyIHJlbmRlciBtZXJnZUNlbGwKCiAgdmFyIHJzZXQgPSBuZXcgU2V0KCk7CiAgZHJhdy5zYXZlKCk7CiAgZHJhdy50cmFuc2xhdGUoMCwgLWV4Y2VwdFJvd1RvdGFsSGVpZ2h0KTsKICBkYXRhLmVhY2hNZXJnZXNJblZpZXcodmlld1JhbmdlLCBmdW5jdGlvbiAoX3JlZikgewogICAgdmFyIHNyaSA9IF9yZWYuc3JpLAogICAgICAgIHNjaSA9IF9yZWYuc2NpLAogICAgICAgIGVyaSA9IF9yZWYuZXJpOwoKICAgIGlmICghZXhjZXB0Um93U2V0LmhhcyhzcmkpKSB7CiAgICAgIHJlbmRlckNlbGwoZHJhdywgZGF0YSwgc3JpLCBzY2kpOwogICAgfSBlbHNlIGlmICghcnNldC5oYXMoc3JpKSkgewogICAgICByc2V0LmFkZChzcmkpOwogICAgICB2YXIgaGVpZ2h0ID0gZGF0YS5yb3dzLnN1bUhlaWdodChzcmksIGVyaSArIDEpOwogICAgICBkcmF3LnRyYW5zbGF0ZSgwLCAtaGVpZ2h0KTsKICAgIH0KICB9KTsKICBkcmF3LnJlc3RvcmUoKTsgLy8gMyByZW5kZXIgYXV0b2ZpbHRlcgoKICByZW5kZXJBdXRvZmlsdGVyLmNhbGwodGhpcywgdmlld1JhbmdlKTsKICBkcmF3LnJlc3RvcmUoKTsKfQoKZnVuY3Rpb24gcmVuZGVyU2VsZWN0ZWRIZWFkZXJDZWxsKHgsIHksIHcsIGgpIHsKICB2YXIgZHJhdyA9IHRoaXMuZHJhdzsKICBkcmF3LnNhdmUoKTsKICBkcmF3LmF0dHIoewogICAgZmlsbFN0eWxlOiAncmdiYSg3NSwgMTM3LCAyNTUsIDAuMDgpJwogIH0pLmZpbGxSZWN0KHgsIHksIHcsIGgpOwogIGRyYXcucmVzdG9yZSgpOwp9IC8vIHZpZXdSYW5nZQovLyB0eXBlOiBhbGwgfCBsZWZ0IHwgdG9wCi8vIHc6IHRoZSBmaXhlZCB3aWR0aCBvZiBoZWFkZXIKLy8gaDogdGhlIGZpeGVkIGhlaWdodCBvZiBoZWFkZXIKLy8gdHg6IG1vdmluZyBkaXN0YW5jZSBvbiB4LWF4aXMKLy8gdHk6IG1vdmluZyBkaXN0YW5jZSBvbiB5LWF4aXMKCgpmdW5jdGlvbiByZW5kZXJGaXhlZEhlYWRlcnModHlwZSwgdmlld1JhbmdlLCB3LCBoLCB0eCwgdHkpIHsKICB2YXIgX3RoaXMgPSB0aGlzOwoKICB2YXIgZHJhdyA9IHRoaXMuZHJhdywKICAgICAgZGF0YSA9IHRoaXMuZGF0YTsKICB2YXIgc3VtSGVpZ2h0ID0gdmlld1JhbmdlLmg7IC8vIHJvd3Muc3VtSGVpZ2h0KHZpZXdSYW5nZS5zcmksIHZpZXdSYW5nZS5lcmkgKyAxKTsKCiAgdmFyIHN1bVdpZHRoID0gdmlld1JhbmdlLnc7IC8vIGNvbHMuc3VtV2lkdGgodmlld1JhbmdlLnNjaSwgdmlld1JhbmdlLmVjaSArIDEpOwoKICB2YXIgbnR5ID0gdHkgKyBoOwogIHZhciBudHggPSB0eCArIHc7CiAgZHJhdy5zYXZlKCk7IC8vIGRyYXcgcmVjdCBiYWNrZ3JvdW5kCgogIGRyYXcuYXR0cih0YWJsZUZpeGVkSGVhZGVyQ2xlYW5TdHlsZSk7CiAgaWYgKHR5cGUgPT09ICdhbGwnIHx8IHR5cGUgPT09ICdsZWZ0JykgZHJhdy5maWxsUmVjdCgwLCBudHksIHcsIHN1bUhlaWdodCk7CiAgaWYgKHR5cGUgPT09ICdhbGwnIHx8IHR5cGUgPT09ICd0b3AnKSBkcmF3LmZpbGxSZWN0KG50eCwgMCwgc3VtV2lkdGgsIGgpOwogIHZhciBfZGF0YSRzZWxlY3RvciRyYW5nZSA9IGRhdGEuc2VsZWN0b3IucmFuZ2UsCiAgICAgIHNyaSA9IF9kYXRhJHNlbGVjdG9yJHJhbmdlLnNyaSwKICAgICAgc2NpID0gX2RhdGEkc2VsZWN0b3IkcmFuZ2Uuc2NpLAogICAgICBlcmkgPSBfZGF0YSRzZWxlY3RvciRyYW5nZS5lcmksCiAgICAgIGVjaSA9IF9kYXRhJHNlbGVjdG9yJHJhbmdlLmVjaTsgLy8gY29uc29sZS5sb2coZGF0YS5zZWxlY3RJbmRleGVzKTsKICAvLyBkcmF3IHRleHQKICAvLyB0ZXh0IGZvbnQsIGFsaWduLi4uCgogIGRyYXcuYXR0cih0YWJsZUZpeGVkSGVhZGVyU3R5bGUoKSk7IC8vIHktaGVhZGVyLXRleHQKCiAgaWYgKHR5cGUgPT09ICdhbGwnIHx8IHR5cGUgPT09ICdsZWZ0JykgewogICAgZGF0YS5yb3dFYWNoKHZpZXdSYW5nZS5zcmksIHZpZXdSYW5nZS5lcmksIGZ1bmN0aW9uIChpLCB5MSwgcm93SGVpZ2h0KSB7CiAgICAgIHZhciB5ID0gbnR5ICsgeTE7CiAgICAgIHZhciBpaSA9IGk7CiAgICAgIGRyYXcubGluZShbMCwgeV0sIFt3LCB5XSk7CgogICAgICBpZiAoc3JpIDw9IGlpICYmIGlpIDwgZXJpICsgMSkgewogICAgICAgIHJlbmRlclNlbGVjdGVkSGVhZGVyQ2VsbC5jYWxsKF90aGlzLCAwLCB5LCB3LCByb3dIZWlnaHQpOwogICAgICB9CgogICAgICBkcmF3LmZpbGxUZXh0KGlpICsgMSwgdyAvIDIsIHkgKyByb3dIZWlnaHQgLyAyKTsKCiAgICAgIGlmIChpID4gMCAmJiBkYXRhLnJvd3MuaXNIaWRlKGkgLSAxKSkgewogICAgICAgIGRyYXcuc2F2ZSgpOwogICAgICAgIGRyYXcuYXR0cih7CiAgICAgICAgICBzdHJva2VTdHlsZTogJyNjNmM2YzYnCiAgICAgICAgfSk7CiAgICAgICAgZHJhdy5saW5lKFs1LCB5ICsgNV0sIFt3IC0gNSwgeSArIDVdKTsKICAgICAgICBkcmF3LnJlc3RvcmUoKTsKICAgICAgfQogICAgfSk7CiAgICBkcmF3LmxpbmUoWzAsIHN1bUhlaWdodCArIG50eV0sIFt3LCBzdW1IZWlnaHQgKyBudHldKTsKICAgIGRyYXcubGluZShbdywgbnR5XSwgW3csIHN1bUhlaWdodCArIG50eV0pOwogIH0gLy8geC1oZWFkZXItdGV4dAoKCiAgaWYgKHR5cGUgPT09ICdhbGwnIHx8IHR5cGUgPT09ICd0b3AnKSB7CiAgICBkYXRhLmNvbEVhY2godmlld1JhbmdlLnNjaSwgdmlld1JhbmdlLmVjaSwgZnVuY3Rpb24gKGksIHgxLCBjb2xXaWR0aCkgewogICAgICB2YXIgeCA9IG50eCArIHgxOwogICAgICB2YXIgaWkgPSBpOwogICAgICBkcmF3LmxpbmUoW3gsIDBdLCBbeCwgaF0pOwoKICAgICAgaWYgKHNjaSA8PSBpaSAmJiBpaSA8IGVjaSArIDEpIHsKICAgICAgICByZW5kZXJTZWxlY3RlZEhlYWRlckNlbGwuY2FsbChfdGhpcywgeCwgMCwgY29sV2lkdGgsIGgpOwogICAgICB9CgogICAgICBkcmF3LmZpbGxUZXh0KHN0cmluZ0F0KGlpKSwgeCArIGNvbFdpZHRoIC8gMiwgaCAvIDIpOwoKICAgICAgaWYgKGkgPiAwICYmIGRhdGEuY29scy5pc0hpZGUoaSAtIDEpKSB7CiAgICAgICAgZHJhdy5zYXZlKCk7CiAgICAgICAgZHJhdy5hdHRyKHsKICAgICAgICAgIHN0cm9rZVN0eWxlOiAnI2M2YzZjNicKICAgICAgICB9KTsKICAgICAgICBkcmF3LmxpbmUoW3ggKyA1LCA1XSwgW3ggKyA1LCBoIC0gNV0pOwogICAgICAgIGRyYXcucmVzdG9yZSgpOwogICAgICB9CiAgICB9KTsKICAgIGRyYXcubGluZShbc3VtV2lkdGggKyBudHgsIDBdLCBbc3VtV2lkdGggKyBudHgsIGhdKTsKICAgIGRyYXcubGluZShbMCwgaF0sIFtzdW1XaWR0aCArIG50eCwgaF0pOwogIH0KCiAgZHJhdy5yZXN0b3JlKCk7Cn0KCmZ1bmN0aW9uIHJlbmRlckZpeGVkTGVmdFRvcENlbGwoZncsIGZoKSB7CiAgdmFyIGRyYXcgPSB0aGlzLmRyYXc7CiAgZHJhdy5zYXZlKCk7IC8vIGxlZnQtdG9wLWNlbGwKCiAgZHJhdy5hdHRyKHsKICAgIGZpbGxTdHlsZTogJyNmNGY1ZjgnCiAgfSkuZmlsbFJlY3QoMCwgMCwgZncsIGZoKTsKICBkcmF3LnJlc3RvcmUoKTsKfQoKZnVuY3Rpb24gcmVuZGVyQ29udGVudEdyaWQoX3JlZjIsIGZ3LCBmaCwgdHgsIHR5KSB7CiAgdmFyIHNyaSA9IF9yZWYyLnNyaSwKICAgICAgc2NpID0gX3JlZjIuc2NpLAogICAgICBlcmkgPSBfcmVmMi5lcmksCiAgICAgIGVjaSA9IF9yZWYyLmVjaSwKICAgICAgdyA9IF9yZWYyLncsCiAgICAgIGggPSBfcmVmMi5oOwogIHZhciBkcmF3ID0gdGhpcy5kcmF3LAogICAgICBkYXRhID0gdGhpcy5kYXRhOwogIHZhciBzZXR0aW5ncyA9IGRhdGEuc2V0dGluZ3M7CiAgZHJhdy5zYXZlKCk7CiAgZHJhdy5hdHRyKHRhYmxlR3JpZFN0eWxlKS50cmFuc2xhdGUoZncgKyB0eCwgZmggKyB0eSk7IC8vIGNvbnN0IHN1bVdpZHRoID0gY29scy5zdW1XaWR0aChzY2ksIGVjaSArIDEpOwogIC8vIGNvbnN0IHN1bUhlaWdodCA9IHJvd3Muc3VtSGVpZ2h0KHNyaSwgZXJpICsgMSk7CiAgLy8gY29uc29sZS5sb2coJ3N1bVdpZHRoOicsIHN1bVdpZHRoKTsKCiAgZHJhdy5jbGVhclJlY3QoMCwgMCwgdywgaCk7CgogIGlmICghc2V0dGluZ3Muc2hvd0dyaWQpIHsKICAgIGRyYXcucmVzdG9yZSgpOwogICAgcmV0dXJuOwogIH0gLy8gY29uc29sZS5sb2coJ3Jvd1N0YXJ0OicsIHJvd1N0YXJ0LCAnLCByb3dMZW46Jywgcm93TGVuKTsKCgogIGRhdGEucm93RWFjaChzcmksIGVyaSwgZnVuY3Rpb24gKGksIHksIGNoKSB7CiAgICAvLyBjb25zb2xlLmxvZygneTonLCB5KTsKICAgIGlmIChpICE9PSBzcmkpIGRyYXcubGluZShbMCwgeV0sIFt3LCB5XSk7CiAgICBpZiAoaSA9PT0gZXJpKSBkcmF3LmxpbmUoWzAsIHkgKyBjaF0sIFt3LCB5ICsgY2hdKTsKICB9KTsKICBkYXRhLmNvbEVhY2goc2NpLCBlY2ksIGZ1bmN0aW9uIChpLCB4LCBjdykgewogICAgaWYgKGkgIT09IHNjaSkgZHJhdy5saW5lKFt4LCAwXSwgW3gsIGhdKTsKICAgIGlmIChpID09PSBlY2kpIGRyYXcubGluZShbeCArIGN3LCAwXSwgW3ggKyBjdywgaF0pOwogIH0pOwogIGRyYXcucmVzdG9yZSgpOwp9CgpmdW5jdGlvbiByZW5kZXJGcmVlemVIaWdobGlnaHRMaW5lKGZ3LCBmaCwgZnR3LCBmdGgpIHsKICB2YXIgZHJhdyA9IHRoaXMuZHJhdywKICAgICAgZGF0YSA9IHRoaXMuZGF0YTsKICB2YXIgdHdpZHRoID0gZGF0YS52aWV3V2lkdGgoKSAtIGZ3OwogIHZhciB0aGVpZ2h0ID0gZGF0YS52aWV3SGVpZ2h0KCkgLSBmaDsKICBkcmF3LnNhdmUoKS50cmFuc2xhdGUoZncsIGZoKS5hdHRyKHsKICAgIHN0cm9rZVN0eWxlOiAncmdiYSg3NSwgMTM3LCAyNTUsIC42KScKICB9KTsKICBkcmF3LmxpbmUoWzAsIGZ0aF0sIFt0d2lkdGgsIGZ0aF0pOwogIGRyYXcubGluZShbZnR3LCAwXSwgW2Z0dywgdGhlaWdodF0pOwogIGRyYXcucmVzdG9yZSgpOwp9Ci8qKiBlbmQgKi8KCgp2YXIgVGFibGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFRhYmxlKGVsLCBkYXRhKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVGFibGUpOwoKICAgIHRoaXMuZWwgPSBlbDsKICAgIHRoaXMuZHJhdyA9IG5ldyBEcmF3KGVsLCBkYXRhLnZpZXdXaWR0aCgpLCBkYXRhLnZpZXdIZWlnaHQoKSk7CiAgICB0aGlzLmRhdGEgPSBkYXRhOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFRhYmxlLCBbewogICAga2V5OiAicmVzZXREYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZXNldERhdGEoZGF0YSkgewogICAgICB0aGlzLmRhdGEgPSBkYXRhOwogICAgICB0aGlzLnJlbmRlcigpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkgewogICAgICAvLyByZXNpemUgY2FudmFzCiAgICAgIHZhciBkYXRhID0gdGhpcy5kYXRhOwogICAgICB2YXIgcm93cyA9IGRhdGEucm93cywKICAgICAgICAgIGNvbHMgPSBkYXRhLmNvbHM7IC8vIGZpeGVkIHdpZHRoIG9mIGhlYWRlcgoKICAgICAgdmFyIGZ3ID0gY29scy5pbmRleFdpZHRoOyAvLyBmaXhlZCBoZWlnaHQgb2YgaGVhZGVyCgogICAgICB2YXIgZmggPSByb3dzLmhlaWdodDsKICAgICAgdGhpcy5kcmF3LnJlc2l6ZShkYXRhLnZpZXdXaWR0aCgpLCBkYXRhLnZpZXdIZWlnaHQoKSk7CiAgICAgIHRoaXMuY2xlYXIoKTsKICAgICAgdmFyIHZpZXdSYW5nZSA9IGRhdGEudmlld1JhbmdlKCk7IC8vIHJlbmRlckFsbC5jYWxsKHRoaXMsIHZpZXdSYW5nZSwgZGF0YS5zY3JvbGwpOwoKICAgICAgdmFyIHR4ID0gZGF0YS5mcmVlemVUb3RhbFdpZHRoKCk7CiAgICAgIHZhciB0eSA9IGRhdGEuZnJlZXplVG90YWxIZWlnaHQoKTsKICAgICAgdmFyIF9kYXRhJHNjcm9sbCA9IGRhdGEuc2Nyb2xsLAogICAgICAgICAgeCA9IF9kYXRhJHNjcm9sbC54LAogICAgICAgICAgeSA9IF9kYXRhJHNjcm9sbC55OyAvLyAxCgogICAgICByZW5kZXJDb250ZW50R3JpZC5jYWxsKHRoaXMsIHZpZXdSYW5nZSwgZncsIGZoLCB0eCwgdHkpOwogICAgICByZW5kZXJDb250ZW50LmNhbGwodGhpcywgdmlld1JhbmdlLCBmdywgZmgsIC14LCAteSk7CiAgICAgIHJlbmRlckZpeGVkSGVhZGVycy5jYWxsKHRoaXMsICdhbGwnLCB2aWV3UmFuZ2UsIGZ3LCBmaCwgdHgsIHR5KTsKICAgICAgcmVuZGVyRml4ZWRMZWZ0VG9wQ2VsbC5jYWxsKHRoaXMsIGZ3LCBmaCk7CgogICAgICB2YXIgX2RhdGEkZnJlZXplID0gX3NsaWNlZFRvQXJyYXkoZGF0YS5mcmVlemUsIDIpLAogICAgICAgICAgZnJpID0gX2RhdGEkZnJlZXplWzBdLAogICAgICAgICAgZmNpID0gX2RhdGEkZnJlZXplWzFdOwoKICAgICAgaWYgKGZyaSA+IDAgfHwgZmNpID4gMCkgewogICAgICAgIC8vIDIKICAgICAgICBpZiAoZnJpID4gMCkgewogICAgICAgICAgdmFyIHZyID0gdmlld1JhbmdlLmNsb25lKCk7CiAgICAgICAgICB2ci5zcmkgPSAwOwogICAgICAgICAgdnIuZXJpID0gZnJpIC0gMTsKICAgICAgICAgIHZyLmggPSB0eTsKICAgICAgICAgIHJlbmRlckNvbnRlbnRHcmlkLmNhbGwodGhpcywgdnIsIGZ3LCBmaCwgdHgsIDApOwogICAgICAgICAgcmVuZGVyQ29udGVudC5jYWxsKHRoaXMsIHZyLCBmdywgZmgsIC14LCAwKTsKICAgICAgICAgIHJlbmRlckZpeGVkSGVhZGVycy5jYWxsKHRoaXMsICd0b3AnLCB2ciwgZncsIGZoLCB0eCwgMCk7CiAgICAgICAgfSAvLyAzCgoKICAgICAgICBpZiAoZmNpID4gMCkgewogICAgICAgICAgdmFyIF92ciA9IHZpZXdSYW5nZS5jbG9uZSgpOwoKICAgICAgICAgIF92ci5zY2kgPSAwOwogICAgICAgICAgX3ZyLmVjaSA9IGZjaSAtIDE7CiAgICAgICAgICBfdnIudyA9IHR4OwogICAgICAgICAgcmVuZGVyQ29udGVudEdyaWQuY2FsbCh0aGlzLCBfdnIsIGZ3LCBmaCwgMCwgdHkpOwogICAgICAgICAgcmVuZGVyRml4ZWRIZWFkZXJzLmNhbGwodGhpcywgJ2xlZnQnLCBfdnIsIGZ3LCBmaCwgMCwgdHkpOwogICAgICAgICAgcmVuZGVyQ29udGVudC5jYWxsKHRoaXMsIF92ciwgZncsIGZoLCAwLCAteSk7CiAgICAgICAgfSAvLyA0CgoKICAgICAgICB2YXIgZnJlZXplVmlld1JhbmdlID0gZGF0YS5mcmVlemVWaWV3UmFuZ2UoKTsKICAgICAgICByZW5kZXJDb250ZW50R3JpZC5jYWxsKHRoaXMsIGZyZWV6ZVZpZXdSYW5nZSwgZncsIGZoLCAwLCAwKTsKICAgICAgICByZW5kZXJGaXhlZEhlYWRlcnMuY2FsbCh0aGlzLCAnYWxsJywgZnJlZXplVmlld1JhbmdlLCBmdywgZmgsIDAsIDApOwogICAgICAgIHJlbmRlckNvbnRlbnQuY2FsbCh0aGlzLCBmcmVlemVWaWV3UmFuZ2UsIGZ3LCBmaCwgMCwgMCk7IC8vIDUKCiAgICAgICAgcmVuZGVyRnJlZXplSGlnaGxpZ2h0TGluZS5jYWxsKHRoaXMsIGZ3LCBmaCwgdHgsIHR5KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImNsZWFyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhcigpIHsKICAgICAgdGhpcy5kcmF3LmNsZWFyKCk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gVGFibGU7Cn0oKTsKCmV4cG9ydCBkZWZhdWx0IFRhYmxlOw=="},{"version":3,"sources":["D:/代码/del_demo/VisualizationExcle_Demo/src/components/x-spreadsheet/component/table.js"],"names":["stringAt","getFontSizePxByPt","_cell","formulam","formatm","Draw","DrawBox","thinLineWidth","npx","cellPaddingWidth","tableFixedHeaderCleanStyle","fillStyle","tableGridStyle","lineWidth","strokeStyle","tableFixedHeaderStyle","textAlign","textBaseline","font","getDrawBox","data","rindex","cindex","yoffset","cellRect","left","top","width","height","renderCell","draw","sortedRowMap","rows","cols","isHide","nrindex","has","get","cell","getCell","frozen","editable","style","getCellStyleOrDefault","dbox","bgcolor","border","undefined","setBorders","strokeBorders","rect","cellText","settings","evalPaused","render","text","y","x","getCellTextOrDefault","format","Object","assign","size","align","valign","color","strike","underline","textwrap","error","validations","getError","renderAutofilter","viewRange","autoFilter","active","afRange","hrange","intersects","each","ri","ci","dropdown","renderContent","fw","fh","tx","ty","save","translate","exceptRowSet","filteredTranslateFunc","ret","getHeight","exceptRowTotalHeight","sri","eri","restore","rset","Set","eachMergesInView","sci","add","sumHeight","call","renderSelectedHeaderCell","w","h","attr","fillRect","renderFixedHeaders","type","sumWidth","nty","ntx","selector","range","eci","rowEach","i","y1","rowHeight","ii","line","fillText","colEach","x1","colWidth","renderFixedLeftTopCell","renderContentGrid","clearRect","showGrid","ch","cw","renderFreezeHighlightLine","ftw","fth","twidth","viewWidth","theight","viewHeight","Table","el","indexWidth","resize","clear","freezeTotalWidth","freezeTotalHeight","scroll","freeze","fri","fci","vr","clone","freezeViewRange"],"mappings":"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","sourcesContent":["import { stringAt } from '../core/alphabet';\r\nimport { getFontSizePxByPt } from '../core/font';\r\nimport _cell from '../core/cell';\r\nimport { formulam } from '../core/formula';\r\nimport { formatm } from '../core/format';\r\n\r\nimport {\r\n  Draw, DrawBox, thinLineWidth, npx,\r\n} from '../canvas/draw';\r\n// gobal var\r\nconst cellPaddingWidth = 5;\r\nconst tableFixedHeaderCleanStyle = { fillStyle: '#f4f5f8' };\r\nconst tableGridStyle = {\r\n  fillStyle: '#fff',\r\n  lineWidth: thinLineWidth,\r\n  strokeStyle: '#e6e6e6',\r\n};\r\nfunction tableFixedHeaderStyle() {\r\n  return {\r\n    textAlign: 'center',\r\n    textBaseline: 'middle',\r\n    font: `500 ${npx(12)}px Source Sans Pro`,\r\n    fillStyle: '#585757',\r\n    lineWidth: thinLineWidth(),\r\n    strokeStyle: '#e6e6e6',\r\n  };\r\n}\r\n\r\nfunction getDrawBox(data, rindex, cindex, yoffset = 0) {\r\n  const {\r\n    left, top, width, height,\r\n  } = data.cellRect(rindex, cindex);\r\n  return new DrawBox(left, top + yoffset, width, height, cellPaddingWidth);\r\n}\r\n/*\r\nfunction renderCellBorders(bboxes, translateFunc) {\r\n  const { draw } = this;\r\n  if (bboxes) {\r\n    const rset = new Set();\r\n    // console.log('bboxes:', bboxes);\r\n    bboxes.forEach(({ ri, ci, box }) => {\r\n      if (!rset.has(ri)) {\r\n        rset.add(ri);\r\n        translateFunc(ri);\r\n      }\r\n      draw.strokeBorders(box);\r\n    });\r\n  }\r\n}\r\n*/\r\n\r\nexport function renderCell(draw, data, rindex, cindex, yoffset = 0) {\r\n  const { sortedRowMap, rows, cols } = data;\r\n  if (rows.isHide(rindex) || cols.isHide(cindex)) return;\r\n  let nrindex = rindex;\r\n  if (sortedRowMap.has(rindex)) {\r\n    nrindex = sortedRowMap.get(rindex);\r\n  }\r\n\r\n  const cell = data.getCell(nrindex, cindex);\r\n  if (cell === null) return;\r\n  let frozen = false;\r\n  if ('editable' in cell && cell.editable === false) {\r\n    frozen = true;\r\n  }\r\n\r\n  const style = data.getCellStyleOrDefault(nrindex, cindex);\r\n  const dbox = getDrawBox(data, rindex, cindex, yoffset);\r\n  dbox.bgcolor = style.bgcolor;\r\n  if (style.border !== undefined) {\r\n    dbox.setBorders(style.border);\r\n    // bboxes.push({ ri: rindex, ci: cindex, box: dbox });\r\n    draw.strokeBorders(dbox);\r\n  }\r\n  draw.rect(dbox, () => {\r\n    // render text\r\n    let cellText = \"\";\r\n    if(!data.settings.evalPaused) {\r\n      cellText = _cell.render(cell.text || '', formulam, (y, x) => (data.getCellTextOrDefault(x, y)));\r\n    } else {\r\n      cellText = cell.text || '';\r\n    }\r\n    if (style.format) {\r\n      // console.log(data.formatm, '>>', cell.format);\r\n      cellText = formatm[style.format].render(cellText);\r\n    }\r\n    const font = Object.assign({}, style.font);\r\n    font.size = getFontSizePxByPt(font.size);\r\n    // console.log('style:', style);\r\n    draw.text(cellText, dbox, {\r\n      align: style.align,\r\n      valign: style.valign,\r\n      font,\r\n      color: style.color,\r\n      strike: style.strike,\r\n      underline: style.underline,\r\n    }, style.textwrap);\r\n    // error\r\n    const error = data.validations.getError(rindex, cindex);\r\n    if (error) {\r\n      // console.log('error:', rindex, cindex, error);\r\n      draw.error(dbox);\r\n    }\r\n    if (frozen) {\r\n      draw.frozen(dbox);\r\n    }\r\n  });\r\n}\r\n\r\nfunction renderAutofilter(viewRange) {\r\n  const { data, draw } = this;\r\n  if (viewRange) {\r\n    const { autoFilter } = data;\r\n    if (!autoFilter.active()) return;\r\n    const afRange = autoFilter.hrange();\r\n    if (viewRange.intersects(afRange)) {\r\n      afRange.each((ri, ci) => {\r\n        const dbox = getDrawBox(data, ri, ci);\r\n        draw.dropdown(dbox);\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nfunction renderContent(viewRange, fw, fh, tx, ty) {\r\n  const { draw, data } = this;\r\n  draw.save();\r\n  draw.translate(fw, fh)\r\n    .translate(tx, ty);\r\n\r\n  const { exceptRowSet } = data;\r\n  // const exceptRows = Array.from(exceptRowSet);\r\n  const filteredTranslateFunc = (ri) => {\r\n    const ret = exceptRowSet.has(ri);\r\n    if (ret) {\r\n      const height = data.rows.getHeight(ri);\r\n      draw.translate(0, -height);\r\n    }\r\n    return !ret;\r\n  };\r\n\r\n  const exceptRowTotalHeight = data.exceptRowTotalHeight(viewRange.sri, viewRange.eri);\r\n  // 1 render cell\r\n  draw.save();\r\n  draw.translate(0, -exceptRowTotalHeight);\r\n  viewRange.each((ri, ci) => {\r\n    renderCell(draw, data, ri, ci);\r\n  }, ri => filteredTranslateFunc(ri));\r\n  draw.restore();\r\n\r\n\r\n  // 2 render mergeCell\r\n  const rset = new Set();\r\n  draw.save();\r\n  draw.translate(0, -exceptRowTotalHeight);\r\n  data.eachMergesInView(viewRange, ({ sri, sci, eri }) => {\r\n    if (!exceptRowSet.has(sri)) {\r\n      renderCell(draw, data, sri, sci);\r\n    } else if (!rset.has(sri)) {\r\n      rset.add(sri);\r\n      const height = data.rows.sumHeight(sri, eri + 1);\r\n      draw.translate(0, -height);\r\n    }\r\n  });\r\n  draw.restore();\r\n\r\n  // 3 render autofilter\r\n  renderAutofilter.call(this, viewRange);\r\n\r\n  draw.restore();\r\n}\r\n\r\nfunction renderSelectedHeaderCell(x, y, w, h) {\r\n  const { draw } = this;\r\n  draw.save();\r\n  draw.attr({ fillStyle: 'rgba(75, 137, 255, 0.08)' })\r\n    .fillRect(x, y, w, h);\r\n  draw.restore();\r\n}\r\n\r\n// viewRange\r\n// type: all | left | top\r\n// w: the fixed width of header\r\n// h: the fixed height of header\r\n// tx: moving distance on x-axis\r\n// ty: moving distance on y-axis\r\nfunction renderFixedHeaders(type, viewRange, w, h, tx, ty) {\r\n  const { draw, data } = this;\r\n  const sumHeight = viewRange.h; // rows.sumHeight(viewRange.sri, viewRange.eri + 1);\r\n  const sumWidth = viewRange.w; // cols.sumWidth(viewRange.sci, viewRange.eci + 1);\r\n  const nty = ty + h;\r\n  const ntx = tx + w;\r\n\r\n  draw.save();\r\n  // draw rect background\r\n  draw.attr(tableFixedHeaderCleanStyle);\r\n  if (type === 'all' || type === 'left') draw.fillRect(0, nty, w, sumHeight);\r\n  if (type === 'all' || type === 'top') draw.fillRect(ntx, 0, sumWidth, h);\r\n\r\n  const {\r\n    sri, sci, eri, eci,\r\n  } = data.selector.range;\r\n  // console.log(data.selectIndexes);\r\n  // draw text\r\n  // text font, align...\r\n  draw.attr(tableFixedHeaderStyle());\r\n  // y-header-text\r\n  if (type === 'all' || type === 'left') {\r\n    data.rowEach(viewRange.sri, viewRange.eri, (i, y1, rowHeight) => {\r\n      const y = nty + y1;\r\n      const ii = i;\r\n      draw.line([0, y], [w, y]);\r\n      if (sri <= ii && ii < eri + 1) {\r\n        renderSelectedHeaderCell.call(this, 0, y, w, rowHeight);\r\n      }\r\n      draw.fillText(ii + 1, w / 2, y + (rowHeight / 2));\r\n      if (i > 0 && data.rows.isHide(i - 1)) {\r\n        draw.save();\r\n        draw.attr({ strokeStyle: '#c6c6c6' });\r\n        draw.line([5, y + 5], [w - 5, y + 5]);\r\n        draw.restore();\r\n      }\r\n    });\r\n    draw.line([0, sumHeight + nty], [w, sumHeight + nty]);\r\n    draw.line([w, nty], [w, sumHeight + nty]);\r\n  }\r\n  // x-header-text\r\n  if (type === 'all' || type === 'top') {\r\n    data.colEach(viewRange.sci, viewRange.eci, (i, x1, colWidth) => {\r\n      const x = ntx + x1;\r\n      const ii = i;\r\n      draw.line([x, 0], [x, h]);\r\n      if (sci <= ii && ii < eci + 1) {\r\n        renderSelectedHeaderCell.call(this, x, 0, colWidth, h);\r\n      }\r\n      draw.fillText(stringAt(ii), x + (colWidth / 2), h / 2);\r\n      if (i > 0 && data.cols.isHide(i - 1)) {\r\n        draw.save();\r\n        draw.attr({ strokeStyle: '#c6c6c6' });\r\n        draw.line([x + 5, 5], [x + 5, h - 5]);\r\n        draw.restore();\r\n      }\r\n    });\r\n    draw.line([sumWidth + ntx, 0], [sumWidth + ntx, h]);\r\n    draw.line([0, h], [sumWidth + ntx, h]);\r\n  }\r\n  draw.restore();\r\n}\r\n\r\nfunction renderFixedLeftTopCell(fw, fh) {\r\n  const { draw } = this;\r\n  draw.save();\r\n  // left-top-cell\r\n  draw.attr({ fillStyle: '#f4f5f8' })\r\n    .fillRect(0, 0, fw, fh);\r\n  draw.restore();\r\n}\r\n\r\nfunction renderContentGrid({\r\n  sri, sci, eri, eci, w, h,\r\n}, fw, fh, tx, ty) {\r\n  const { draw, data } = this;\r\n  const { settings } = data;\r\n\r\n  draw.save();\r\n  draw.attr(tableGridStyle)\r\n    .translate(fw + tx, fh + ty);\r\n  // const sumWidth = cols.sumWidth(sci, eci + 1);\r\n  // const sumHeight = rows.sumHeight(sri, eri + 1);\r\n  // console.log('sumWidth:', sumWidth);\r\n  draw.clearRect(0, 0, w, h);\r\n  if (!settings.showGrid) {\r\n    draw.restore();\r\n    return;\r\n  }\r\n  // console.log('rowStart:', rowStart, ', rowLen:', rowLen);\r\n  data.rowEach(sri, eri, (i, y, ch) => {\r\n    // console.log('y:', y);\r\n    if (i !== sri) draw.line([0, y], [w, y]);\r\n    if (i === eri) draw.line([0, y + ch], [w, y + ch]);\r\n  });\r\n  data.colEach(sci, eci, (i, x, cw) => {\r\n    if (i !== sci) draw.line([x, 0], [x, h]);\r\n    if (i === eci) draw.line([x + cw, 0], [x + cw, h]);\r\n  });\r\n  draw.restore();\r\n}\r\n\r\nfunction renderFreezeHighlightLine(fw, fh, ftw, fth) {\r\n  const { draw, data } = this;\r\n  const twidth = data.viewWidth() - fw;\r\n  const theight = data.viewHeight() - fh;\r\n  draw.save()\r\n    .translate(fw, fh)\r\n    .attr({ strokeStyle: 'rgba(75, 137, 255, .6)' });\r\n  draw.line([0, fth], [twidth, fth]);\r\n  draw.line([ftw, 0], [ftw, theight]);\r\n  draw.restore();\r\n}\r\n\r\n/** end */\r\nclass Table {\r\n  constructor(el, data) {\r\n    this.el = el;\r\n    this.draw = new Draw(el, data.viewWidth(), data.viewHeight());\r\n    this.data = data;\r\n  }\r\n\r\n  resetData(data) {\r\n    this.data = data;\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    // resize canvas\r\n    const { data } = this;\r\n    const { rows, cols } = data;\r\n    // fixed width of header\r\n    const fw = cols.indexWidth;\r\n    // fixed height of header\r\n    const fh = rows.height;\r\n\r\n    this.draw.resize(data.viewWidth(), data.viewHeight());\r\n    this.clear();\r\n\r\n    const viewRange = data.viewRange();\r\n    // renderAll.call(this, viewRange, data.scroll);\r\n    const tx = data.freezeTotalWidth();\r\n    const ty = data.freezeTotalHeight();\r\n    const { x, y } = data.scroll;\r\n    // 1\r\n    renderContentGrid.call(this, viewRange, fw, fh, tx, ty);\r\n    renderContent.call(this, viewRange, fw, fh, -x, -y);\r\n    renderFixedHeaders.call(this, 'all', viewRange, fw, fh, tx, ty);\r\n    renderFixedLeftTopCell.call(this, fw, fh);\r\n    const [fri, fci] = data.freeze;\r\n    if (fri > 0 || fci > 0) {\r\n      // 2\r\n      if (fri > 0) {\r\n        const vr = viewRange.clone();\r\n        vr.sri = 0;\r\n        vr.eri = fri - 1;\r\n        vr.h = ty;\r\n        renderContentGrid.call(this, vr, fw, fh, tx, 0);\r\n        renderContent.call(this, vr, fw, fh, -x, 0);\r\n        renderFixedHeaders.call(this, 'top', vr, fw, fh, tx, 0);\r\n      }\r\n      // 3\r\n      if (fci > 0) {\r\n        const vr = viewRange.clone();\r\n        vr.sci = 0;\r\n        vr.eci = fci - 1;\r\n        vr.w = tx;\r\n        renderContentGrid.call(this, vr, fw, fh, 0, ty);\r\n        renderFixedHeaders.call(this, 'left', vr, fw, fh, 0, ty);\r\n        renderContent.call(this, vr, fw, fh, 0, -y);\r\n      }\r\n      // 4\r\n      const freezeViewRange = data.freezeViewRange();\r\n      renderContentGrid.call(this, freezeViewRange, fw, fh, 0, 0);\r\n      renderFixedHeaders.call(this, 'all', freezeViewRange, fw, fh, 0, 0);\r\n      renderContent.call(this, freezeViewRange, fw, fh, 0, 0);\r\n      // 5\r\n      renderFreezeHighlightLine.call(this, fw, fh, tx, ty);\r\n    }\r\n  }\r\n\r\n  clear() {\r\n    this.draw.clear();\r\n  }\r\n}\r\n\r\nexport default Table;\r\n"]}]}