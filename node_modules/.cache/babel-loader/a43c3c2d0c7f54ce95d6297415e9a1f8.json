{"remainingRequest":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js!D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\代码\\del_demo\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\core\\auto_filter.js","dependencies":[{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\core\\auto_filter.js","mtime":1614915429357},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1596536485880},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1606828682259},{"path":"D:\\代码\\del_demo\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js","mtime":1603719226989}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJEOi9cdTRFRTNcdTc4MDEvZGVsX2RlbW8vVmlzdWFsaXphdGlvbkV4Y2xlX0RlbW8vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJEOi9cdTRFRTNcdTc4MDEvZGVsX2RlbW8vVmlzdWFsaXphdGlvbkV4Y2xlX0RlbW8vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zZXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCB7IENlbGxSYW5nZSB9IGZyb20gJy4vY2VsbF9yYW5nZSc7IC8vIG9wZXJhdG9yOiBhbGx8ZXF8bmVxfGd0fGd0ZXxsdHxsdGV8aW58YmUKLy8gdmFsdWU6Ci8vICAgaW4gPT4gW10KLy8gICBiZSA9PiBbbWluLCBtYXhdCgp2YXIgRmlsdGVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBGaWx0ZXIoY2ksIG9wZXJhdG9yLCB2YWx1ZSkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZpbHRlcik7CgogICAgdGhpcy5jaSA9IGNpOwogICAgdGhpcy5vcGVyYXRvciA9IG9wZXJhdG9yOwogICAgdGhpcy52YWx1ZSA9IHZhbHVlOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEZpbHRlciwgW3sKICAgIGtleTogInNldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0KG9wZXJhdG9yLCB2YWx1ZSkgewogICAgICB0aGlzLm9wZXJhdG9yID0gb3BlcmF0b3I7CiAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpbmNsdWRlcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW5jbHVkZXModikgewogICAgICB2YXIgb3BlcmF0b3IgPSB0aGlzLm9wZXJhdG9yLAogICAgICAgICAgdmFsdWUgPSB0aGlzLnZhbHVlOwoKICAgICAgaWYgKG9wZXJhdG9yID09PSAnYWxsJykgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICBpZiAob3BlcmF0b3IgPT09ICdpbicpIHsKICAgICAgICByZXR1cm4gdmFsdWUuaW5jbHVkZXModik7CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ2bGVuZ3RoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB2bGVuZ3RoKCkgewogICAgICB2YXIgb3BlcmF0b3IgPSB0aGlzLm9wZXJhdG9yLAogICAgICAgICAgdmFsdWUgPSB0aGlzLnZhbHVlOwoKICAgICAgaWYgKG9wZXJhdG9yID09PSAnaW4nKSB7CiAgICAgICAgcmV0dXJuIHZhbHVlLmxlbmd0aDsKICAgICAgfQoKICAgICAgcmV0dXJuIDA7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0RGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGF0YSgpIHsKICAgICAgdmFyIGNpID0gdGhpcy5jaSwKICAgICAgICAgIG9wZXJhdG9yID0gdGhpcy5vcGVyYXRvciwKICAgICAgICAgIHZhbHVlID0gdGhpcy52YWx1ZTsKICAgICAgcmV0dXJuIHsKICAgICAgICBjaTogY2ksCiAgICAgICAgb3BlcmF0b3I6IG9wZXJhdG9yLAogICAgICAgIHZhbHVlOiB2YWx1ZQogICAgICB9OwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEZpbHRlcjsKfSgpOwoKdmFyIFNvcnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFNvcnQoY2ksIG9yZGVyKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU29ydCk7CgogICAgdGhpcy5jaSA9IGNpOwogICAgdGhpcy5vcmRlciA9IG9yZGVyOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFNvcnQsIFt7CiAgICBrZXk6ICJhc2MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFzYygpIHsKICAgICAgcmV0dXJuIHRoaXMub3JkZXIgPT09ICdhc2MnOwogICAgfQogIH0sIHsKICAgIGtleTogImRlc2MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRlc2MoKSB7CiAgICAgIHJldHVybiB0aGlzLm9yZGVyID09PSAnZGVzYyc7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gU29ydDsKfSgpOwoKdmFyIEF1dG9GaWx0ZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEF1dG9GaWx0ZXIoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQXV0b0ZpbHRlcik7CgogICAgdGhpcy5yZWYgPSBudWxsOwogICAgdGhpcy5maWx0ZXJzID0gW107CiAgICB0aGlzLnNvcnQgPSBudWxsOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEF1dG9GaWx0ZXIsIFt7CiAgICBrZXk6ICJzZXREYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXREYXRhKF9yZWYpIHsKICAgICAgdmFyIHJlZiA9IF9yZWYucmVmLAogICAgICAgICAgZmlsdGVycyA9IF9yZWYuZmlsdGVycywKICAgICAgICAgIHNvcnQgPSBfcmVmLnNvcnQ7CgogICAgICBpZiAocmVmICE9IG51bGwpIHsKICAgICAgICB0aGlzLnJlZiA9IHJlZjsKICAgICAgICB0aGlzLmZpbHRlcnMgPSBmaWx0ZXJzLm1hcChmdW5jdGlvbiAoaXQpIHsKICAgICAgICAgIHJldHVybiBuZXcgRmlsdGVyKGl0LmNpLCBpdC5vcGVyYXRvciwgaXQudmFsdWUpOwogICAgICAgIH0pOwoKICAgICAgICBpZiAoc29ydCkgewogICAgICAgICAgdGhpcy5zb3J0ID0gbmV3IFNvcnQoc29ydC5jaSwgc29ydC5vcmRlcik7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0RGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGF0YSgpIHsKICAgICAgaWYgKHRoaXMuYWN0aXZlKCkpIHsKICAgICAgICB2YXIgcmVmID0gdGhpcy5yZWYsCiAgICAgICAgICAgIGZpbHRlcnMgPSB0aGlzLmZpbHRlcnMsCiAgICAgICAgICAgIHNvcnQgPSB0aGlzLnNvcnQ7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHJlZjogcmVmLAogICAgICAgICAgZmlsdGVyczogZmlsdGVycy5tYXAoZnVuY3Rpb24gKGl0KSB7CiAgICAgICAgICAgIHJldHVybiBpdC5nZXREYXRhKCk7CiAgICAgICAgICB9KSwKICAgICAgICAgIHNvcnQ6IHNvcnQKICAgICAgICB9OwogICAgICB9CgogICAgICByZXR1cm4ge307CiAgICB9CiAgfSwgewogICAga2V5OiAiYWRkRmlsdGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRGaWx0ZXIoY2ksIG9wZXJhdG9yLCB2YWx1ZSkgewogICAgICB2YXIgZmlsdGVyID0gdGhpcy5nZXRGaWx0ZXIoY2kpOwoKICAgICAgaWYgKGZpbHRlciA9PSBudWxsKSB7CiAgICAgICAgdGhpcy5maWx0ZXJzLnB1c2gobmV3IEZpbHRlcihjaSwgb3BlcmF0b3IsIHZhbHVlKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZmlsdGVyLnNldChvcGVyYXRvciwgdmFsdWUpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0U29ydCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0U29ydChjaSwgb3JkZXIpIHsKICAgICAgdGhpcy5zb3J0ID0gb3JkZXIgPyBuZXcgU29ydChjaSwgb3JkZXIpIDogbnVsbDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpbmNsdWRlcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW5jbHVkZXMocmksIGNpKSB7CiAgICAgIGlmICh0aGlzLmFjdGl2ZSgpKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuaHJhbmdlKCkuaW5jbHVkZXMocmksIGNpKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFNvcnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFNvcnQoY2kpIHsKICAgICAgdmFyIHNvcnQgPSB0aGlzLnNvcnQ7CgogICAgICBpZiAoc29ydCAmJiBzb3J0LmNpID09PSBjaSkgewogICAgICAgIHJldHVybiBzb3J0OwogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRGaWx0ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEZpbHRlcihjaSkgewogICAgICB2YXIgZmlsdGVycyA9IHRoaXMuZmlsdGVyczsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmlsdGVycy5sZW5ndGg7IGkgKz0gMSkgewogICAgICAgIGlmIChmaWx0ZXJzW2ldLmNpID09PSBjaSkgewogICAgICAgICAgcmV0dXJuIGZpbHRlcnNbaV07CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmaWx0ZXJlZFJvd3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbHRlcmVkUm93cyhnZXRDZWxsKSB7CiAgICAgIC8vIGNvbnN0IGFyeSA9IFtdOwogICAgICAvLyBsZXQgbGFzdHJpID0gMDsKICAgICAgdmFyIHJzZXQgPSBuZXcgU2V0KCk7CiAgICAgIHZhciBmc2V0ID0gbmV3IFNldCgpOwoKICAgICAgaWYgKHRoaXMuYWN0aXZlKCkpIHsKICAgICAgICB2YXIgX3RoaXMkcmFuZ2UgPSB0aGlzLnJhbmdlKCksCiAgICAgICAgICAgIHNyaSA9IF90aGlzJHJhbmdlLnNyaSwKICAgICAgICAgICAgZXJpID0gX3RoaXMkcmFuZ2UuZXJpOwoKICAgICAgICB2YXIgZmlsdGVycyA9IHRoaXMuZmlsdGVyczsKCiAgICAgICAgZm9yICh2YXIgcmkgPSBzcmkgKyAxOyByaSA8PSBlcmk7IHJpICs9IDEpIHsKICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmlsdGVycy5sZW5ndGg7IGkgKz0gMSkgewogICAgICAgICAgICB2YXIgZmlsdGVyID0gZmlsdGVyc1tpXTsKICAgICAgICAgICAgdmFyIGNlbGwgPSBnZXRDZWxsKHJpLCBmaWx0ZXIuY2kpOwogICAgICAgICAgICB2YXIgY3RleHQgPSBjZWxsID8gY2VsbC50ZXh0IDogJyc7CgogICAgICAgICAgICBpZiAoIWZpbHRlci5pbmNsdWRlcyhjdGV4dCkpIHsKICAgICAgICAgICAgICByc2V0LmFkZChyaSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgZnNldC5hZGQocmkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gewogICAgICAgIHJzZXQ6IHJzZXQsCiAgICAgICAgZnNldDogZnNldAogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogIml0ZW1zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpdGVtcyhjaSwgZ2V0Q2VsbCkgewogICAgICB2YXIgbSA9IHt9OwoKICAgICAgaWYgKHRoaXMuYWN0aXZlKCkpIHsKICAgICAgICB2YXIgX3RoaXMkcmFuZ2UyID0gdGhpcy5yYW5nZSgpLAogICAgICAgICAgICBzcmkgPSBfdGhpcyRyYW5nZTIuc3JpLAogICAgICAgICAgICBlcmkgPSBfdGhpcyRyYW5nZTIuZXJpOwoKICAgICAgICBmb3IgKHZhciByaSA9IHNyaSArIDE7IHJpIDw9IGVyaTsgcmkgKz0gMSkgewogICAgICAgICAgdmFyIGNlbGwgPSBnZXRDZWxsKHJpLCBjaSk7CgogICAgICAgICAgaWYgKGNlbGwgIT09IG51bGwgJiYgIS9eXHMqJC8udGVzdChjZWxsLnRleHQpKSB7CiAgICAgICAgICAgIHZhciBrZXkgPSBjZWxsLnRleHQ7CiAgICAgICAgICAgIHZhciBjbnQgPSAobVtrZXldIHx8IDApICsgMTsKICAgICAgICAgICAgbVtrZXldID0gY250OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbVsnJ10gPSAobVsnJ10gfHwgMCkgKyAxOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG07CiAgICB9CiAgfSwgewogICAga2V5OiAicmFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJhbmdlKCkgewogICAgICByZXR1cm4gQ2VsbFJhbmdlLnZhbHVlT2YodGhpcy5yZWYpOwogICAgfQogIH0sIHsKICAgIGtleTogImhyYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaHJhbmdlKCkgewogICAgICB2YXIgciA9IHRoaXMucmFuZ2UoKTsKICAgICAgci5lcmkgPSByLnNyaTsKICAgICAgcmV0dXJuIHI7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2xlYXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNsZWFyKCkgewogICAgICB0aGlzLnJlZiA9IG51bGw7CiAgICAgIHRoaXMuZmlsdGVycyA9IFtdOwogICAgICB0aGlzLnNvcnQgPSBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogImFjdGl2ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWN0aXZlKCkgewogICAgICByZXR1cm4gdGhpcy5yZWYgIT09IG51bGw7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gQXV0b0ZpbHRlcjsKfSgpOwoKZXhwb3J0IHsgQXV0b0ZpbHRlciBhcyBkZWZhdWx0IH07"},{"version":3,"sources":["D:/代码/del_demo/VisualizationExcle_Demo/src/components/x-spreadsheet/core/auto_filter.js"],"names":["CellRange","Filter","ci","operator","value","v","includes","length","Sort","order","AutoFilter","ref","filters","sort","map","it","active","getData","filter","getFilter","push","set","ri","hrange","i","getCell","rset","Set","fset","range","sri","eri","cell","ctext","text","add","m","test","key","cnt","valueOf","r"],"mappings":";;;;;;;;;AAAA,SAASA,SAAT,QAA0B,cAA1B,C,CACA;AACA;AACA;AACA;;IACMC,M;AACJ,kBAAYC,EAAZ,EAAgBC,QAAhB,EAA0BC,KAA1B,EAAiC;AAAA;;AAC/B,SAAKF,EAAL,GAAUA,EAAV;AACA,SAAKC,QAAL,GAAgBA,QAAhB;AACA,SAAKC,KAAL,GAAaA,KAAb;AACD;;;;WAED,aAAID,QAAJ,EAAcC,KAAd,EAAqB;AACnB,WAAKD,QAAL,GAAgBA,QAAhB;AACA,WAAKC,KAAL,GAAaA,KAAb;AACD;;;WAED,kBAASC,CAAT,EAAY;AAAA,UACFF,QADE,GACkB,IADlB,CACFA,QADE;AAAA,UACQC,KADR,GACkB,IADlB,CACQA,KADR;;AAEV,UAAID,QAAQ,KAAK,KAAjB,EAAwB;AACtB,eAAO,IAAP;AACD;;AACD,UAAIA,QAAQ,KAAK,IAAjB,EAAuB;AACrB,eAAOC,KAAK,CAACE,QAAN,CAAeD,CAAf,CAAP;AACD;;AACD,aAAO,KAAP;AACD;;;WAED,mBAAU;AAAA,UACAF,QADA,GACoB,IADpB,CACAA,QADA;AAAA,UACUC,KADV,GACoB,IADpB,CACUA,KADV;;AAER,UAAID,QAAQ,KAAK,IAAjB,EAAuB;AACrB,eAAOC,KAAK,CAACG,MAAb;AACD;;AACD,aAAO,CAAP;AACD;;;WAED,mBAAU;AAAA,UACAL,EADA,GACwB,IADxB,CACAA,EADA;AAAA,UACIC,QADJ,GACwB,IADxB,CACIA,QADJ;AAAA,UACcC,KADd,GACwB,IADxB,CACcA,KADd;AAER,aAAO;AAAEF,QAAAA,EAAE,EAAFA,EAAF;AAAMC,QAAAA,QAAQ,EAARA,QAAN;AAAgBC,QAAAA,KAAK,EAALA;AAAhB,OAAP;AACD;;;;;;IAGGI,I;AACJ,gBAAYN,EAAZ,EAAgBO,KAAhB,EAAuB;AAAA;;AACrB,SAAKP,EAAL,GAAUA,EAAV;AACA,SAAKO,KAAL,GAAaA,KAAb;AACD;;;;WAED,eAAM;AACJ,aAAO,KAAKA,KAAL,KAAe,KAAtB;AACD;;;WAED,gBAAO;AACL,aAAO,KAAKA,KAAL,KAAe,MAAtB;AACD;;;;;;IAGkBC,U;AACnB,wBAAc;AAAA;;AACZ,SAAKC,GAAL,GAAW,IAAX;AACA,SAAKC,OAAL,GAAe,EAAf;AACA,SAAKC,IAAL,GAAY,IAAZ;AACD;;;;WAED,uBAAgC;AAAA,UAAtBF,GAAsB,QAAtBA,GAAsB;AAAA,UAAjBC,OAAiB,QAAjBA,OAAiB;AAAA,UAARC,IAAQ,QAARA,IAAQ;;AAC9B,UAAIF,GAAG,IAAI,IAAX,EAAiB;AACf,aAAKA,GAAL,GAAWA,GAAX;AACA,aAAKC,OAAL,GAAeA,OAAO,CAACE,GAAR,CAAY,UAAAC,EAAE;AAAA,iBAAI,IAAId,MAAJ,CAAWc,EAAE,CAACb,EAAd,EAAkBa,EAAE,CAACZ,QAArB,EAA+BY,EAAE,CAACX,KAAlC,CAAJ;AAAA,SAAd,CAAf;;AACA,YAAIS,IAAJ,EAAU;AACR,eAAKA,IAAL,GAAY,IAAIL,IAAJ,CAASK,IAAI,CAACX,EAAd,EAAkBW,IAAI,CAACJ,KAAvB,CAAZ;AACD;AACF;AACF;;;WAED,mBAAU;AACR,UAAI,KAAKO,MAAL,EAAJ,EAAmB;AAAA,YACTL,GADS,GACc,IADd,CACTA,GADS;AAAA,YACJC,OADI,GACc,IADd,CACJA,OADI;AAAA,YACKC,IADL,GACc,IADd,CACKA,IADL;AAEjB,eAAO;AAAEF,UAAAA,GAAG,EAAHA,GAAF;AAAOC,UAAAA,OAAO,EAAEA,OAAO,CAACE,GAAR,CAAY,UAAAC,EAAE;AAAA,mBAAIA,EAAE,CAACE,OAAH,EAAJ;AAAA,WAAd,CAAhB;AAAiDJ,UAAAA,IAAI,EAAJA;AAAjD,SAAP;AACD;;AACD,aAAO,EAAP;AACD;;;WAED,mBAAUX,EAAV,EAAcC,QAAd,EAAwBC,KAAxB,EAA+B;AAC7B,UAAMc,MAAM,GAAG,KAAKC,SAAL,CAAejB,EAAf,CAAf;;AACA,UAAIgB,MAAM,IAAI,IAAd,EAAoB;AAClB,aAAKN,OAAL,CAAaQ,IAAb,CAAkB,IAAInB,MAAJ,CAAWC,EAAX,EAAeC,QAAf,EAAyBC,KAAzB,CAAlB;AACD,OAFD,MAEO;AACLc,QAAAA,MAAM,CAACG,GAAP,CAAWlB,QAAX,EAAqBC,KAArB;AACD;AACF;;;WAED,iBAAQF,EAAR,EAAYO,KAAZ,EAAmB;AACjB,WAAKI,IAAL,GAAYJ,KAAK,GAAG,IAAID,IAAJ,CAASN,EAAT,EAAaO,KAAb,CAAH,GAAyB,IAA1C;AACD;;;WAED,kBAASa,EAAT,EAAapB,EAAb,EAAiB;AACf,UAAI,KAAKc,MAAL,EAAJ,EAAmB;AACjB,eAAO,KAAKO,MAAL,GAAcjB,QAAd,CAAuBgB,EAAvB,EAA2BpB,EAA3B,CAAP;AACD;;AACD,aAAO,KAAP;AACD;;;WAED,iBAAQA,EAAR,EAAY;AAAA,UACFW,IADE,GACO,IADP,CACFA,IADE;;AAEV,UAAIA,IAAI,IAAIA,IAAI,CAACX,EAAL,KAAYA,EAAxB,EAA4B;AAC1B,eAAOW,IAAP;AACD;;AACD,aAAO,IAAP;AACD;;;WAED,mBAAUX,EAAV,EAAc;AAAA,UACJU,OADI,GACQ,IADR,CACJA,OADI;;AAEZ,WAAK,IAAIY,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGZ,OAAO,CAACL,MAA5B,EAAoCiB,CAAC,IAAI,CAAzC,EAA4C;AAC1C,YAAIZ,OAAO,CAACY,CAAD,CAAP,CAAWtB,EAAX,KAAkBA,EAAtB,EAA0B;AACxB,iBAAOU,OAAO,CAACY,CAAD,CAAd;AACD;AACF;;AACD,aAAO,IAAP;AACD;;;WAED,sBAAaC,OAAb,EAAsB;AACpB;AACA;AACA,UAAMC,IAAI,GAAG,IAAIC,GAAJ,EAAb;AACA,UAAMC,IAAI,GAAG,IAAID,GAAJ,EAAb;;AACA,UAAI,KAAKX,MAAL,EAAJ,EAAmB;AAAA,0BACI,KAAKa,KAAL,EADJ;AAAA,YACTC,GADS,eACTA,GADS;AAAA,YACJC,GADI,eACJA,GADI;;AAAA,YAETnB,OAFS,GAEG,IAFH,CAETA,OAFS;;AAGjB,aAAK,IAAIU,EAAE,GAAGQ,GAAG,GAAG,CAApB,EAAuBR,EAAE,IAAIS,GAA7B,EAAkCT,EAAE,IAAI,CAAxC,EAA2C;AACzC,eAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGZ,OAAO,CAACL,MAA5B,EAAoCiB,CAAC,IAAI,CAAzC,EAA4C;AAC1C,gBAAMN,MAAM,GAAGN,OAAO,CAACY,CAAD,CAAtB;AACA,gBAAMQ,IAAI,GAAGP,OAAO,CAACH,EAAD,EAAKJ,MAAM,CAAChB,EAAZ,CAApB;AACA,gBAAM+B,KAAK,GAAGD,IAAI,GAAGA,IAAI,CAACE,IAAR,GAAe,EAAjC;;AACA,gBAAI,CAAChB,MAAM,CAACZ,QAAP,CAAgB2B,KAAhB,CAAL,EAA6B;AAC3BP,cAAAA,IAAI,CAACS,GAAL,CAASb,EAAT;AACA;AACD,aAHD,MAGO;AACLM,cAAAA,IAAI,CAACO,GAAL,CAASb,EAAT;AACD;AACF;AACF;AACF;;AACD,aAAO;AAAEI,QAAAA,IAAI,EAAJA,IAAF;AAAQE,QAAAA,IAAI,EAAJA;AAAR,OAAP;AACD;;;WAED,eAAM1B,EAAN,EAAUuB,OAAV,EAAmB;AACjB,UAAMW,CAAC,GAAG,EAAV;;AACA,UAAI,KAAKpB,MAAL,EAAJ,EAAmB;AAAA,2BACI,KAAKa,KAAL,EADJ;AAAA,YACTC,GADS,gBACTA,GADS;AAAA,YACJC,GADI,gBACJA,GADI;;AAEjB,aAAK,IAAIT,EAAE,GAAGQ,GAAG,GAAG,CAApB,EAAuBR,EAAE,IAAIS,GAA7B,EAAkCT,EAAE,IAAI,CAAxC,EAA2C;AACzC,cAAMU,IAAI,GAAGP,OAAO,CAACH,EAAD,EAAKpB,EAAL,CAApB;;AACA,cAAI8B,IAAI,KAAK,IAAT,IAAiB,CAAC,QAAQK,IAAR,CAAaL,IAAI,CAACE,IAAlB,CAAtB,EAA+C;AAC7C,gBAAMI,GAAG,GAAGN,IAAI,CAACE,IAAjB;AACA,gBAAMK,GAAG,GAAG,CAACH,CAAC,CAACE,GAAD,CAAD,IAAU,CAAX,IAAgB,CAA5B;AACAF,YAAAA,CAAC,CAACE,GAAD,CAAD,GAASC,GAAT;AACD,WAJD,MAIO;AACLH,YAAAA,CAAC,CAAC,EAAD,CAAD,GAAQ,CAACA,CAAC,CAAC,EAAD,CAAD,IAAS,CAAV,IAAe,CAAvB;AACD;AACF;AACF;;AACD,aAAOA,CAAP;AACD;;;WAED,iBAAQ;AACN,aAAOpC,SAAS,CAACwC,OAAV,CAAkB,KAAK7B,GAAvB,CAAP;AACD;;;WAED,kBAAS;AACP,UAAM8B,CAAC,GAAG,KAAKZ,KAAL,EAAV;AACAY,MAAAA,CAAC,CAACV,GAAF,GAAQU,CAAC,CAACX,GAAV;AACA,aAAOW,CAAP;AACD;;;WAED,iBAAQ;AACN,WAAK9B,GAAL,GAAW,IAAX;AACA,WAAKC,OAAL,GAAe,EAAf;AACA,WAAKC,IAAL,GAAY,IAAZ;AACD;;;WAED,kBAAS;AACP,aAAO,KAAKF,GAAL,KAAa,IAApB;AACD;;;;;;SA5HkBD,U","sourcesContent":["import { CellRange } from './cell_range';\r\n// operator: all|eq|neq|gt|gte|lt|lte|in|be\r\n// value:\r\n//   in => []\r\n//   be => [min, max]\r\nclass Filter {\r\n  constructor(ci, operator, value) {\r\n    this.ci = ci;\r\n    this.operator = operator;\r\n    this.value = value;\r\n  }\r\n\r\n  set(operator, value) {\r\n    this.operator = operator;\r\n    this.value = value;\r\n  }\r\n\r\n  includes(v) {\r\n    const { operator, value } = this;\r\n    if (operator === 'all') {\r\n      return true;\r\n    }\r\n    if (operator === 'in') {\r\n      return value.includes(v);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  vlength() {\r\n    const { operator, value } = this;\r\n    if (operator === 'in') {\r\n      return value.length;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  getData() {\r\n    const { ci, operator, value } = this;\r\n    return { ci, operator, value };\r\n  }\r\n}\r\n\r\nclass Sort {\r\n  constructor(ci, order) {\r\n    this.ci = ci;\r\n    this.order = order;\r\n  }\r\n\r\n  asc() {\r\n    return this.order === 'asc';\r\n  }\r\n\r\n  desc() {\r\n    return this.order === 'desc';\r\n  }\r\n}\r\n\r\nexport default class AutoFilter {\r\n  constructor() {\r\n    this.ref = null;\r\n    this.filters = [];\r\n    this.sort = null;\r\n  }\r\n\r\n  setData({ ref, filters, sort }) {\r\n    if (ref != null) {\r\n      this.ref = ref;\r\n      this.filters = filters.map(it => new Filter(it.ci, it.operator, it.value));\r\n      if (sort) {\r\n        this.sort = new Sort(sort.ci, sort.order);\r\n      }\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    if (this.active()) {\r\n      const { ref, filters, sort } = this;\r\n      return { ref, filters: filters.map(it => it.getData()), sort };\r\n    }\r\n    return {};\r\n  }\r\n\r\n  addFilter(ci, operator, value) {\r\n    const filter = this.getFilter(ci);\r\n    if (filter == null) {\r\n      this.filters.push(new Filter(ci, operator, value));\r\n    } else {\r\n      filter.set(operator, value);\r\n    }\r\n  }\r\n\r\n  setSort(ci, order) {\r\n    this.sort = order ? new Sort(ci, order) : null;\r\n  }\r\n\r\n  includes(ri, ci) {\r\n    if (this.active()) {\r\n      return this.hrange().includes(ri, ci);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  getSort(ci) {\r\n    const { sort } = this;\r\n    if (sort && sort.ci === ci) {\r\n      return sort;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  getFilter(ci) {\r\n    const { filters } = this;\r\n    for (let i = 0; i < filters.length; i += 1) {\r\n      if (filters[i].ci === ci) {\r\n        return filters[i];\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  filteredRows(getCell) {\r\n    // const ary = [];\r\n    // let lastri = 0;\r\n    const rset = new Set();\r\n    const fset = new Set();\r\n    if (this.active()) {\r\n      const { sri, eri } = this.range();\r\n      const { filters } = this;\r\n      for (let ri = sri + 1; ri <= eri; ri += 1) {\r\n        for (let i = 0; i < filters.length; i += 1) {\r\n          const filter = filters[i];\r\n          const cell = getCell(ri, filter.ci);\r\n          const ctext = cell ? cell.text : '';\r\n          if (!filter.includes(ctext)) {\r\n            rset.add(ri);\r\n            break;\r\n          } else {\r\n            fset.add(ri);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return { rset, fset };\r\n  }\r\n\r\n  items(ci, getCell) {\r\n    const m = {};\r\n    if (this.active()) {\r\n      const { sri, eri } = this.range();\r\n      for (let ri = sri + 1; ri <= eri; ri += 1) {\r\n        const cell = getCell(ri, ci);\r\n        if (cell !== null && !/^\\s*$/.test(cell.text)) {\r\n          const key = cell.text;\r\n          const cnt = (m[key] || 0) + 1;\r\n          m[key] = cnt;\r\n        } else {\r\n          m[''] = (m[''] || 0) + 1;\r\n        }\r\n      }\r\n    }\r\n    return m;\r\n  }\r\n\r\n  range() {\r\n    return CellRange.valueOf(this.ref);\r\n  }\r\n\r\n  hrange() {\r\n    const r = this.range();\r\n    r.eri = r.sri;\r\n    return r;\r\n  }\r\n\r\n  clear() {\r\n    this.ref = null;\r\n    this.filters = [];\r\n    this.sort = null;\r\n  }\r\n\r\n  active() {\r\n    return this.ref !== null;\r\n  }\r\n}\r\n"]}]}