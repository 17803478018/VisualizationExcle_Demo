{"remainingRequest":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\core\\formula.js","dependencies":[{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\components\\x-spreadsheet\\core\\formula.js","mtime":1616639586837},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616639573358},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1616639572994},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\eslint-loader\\index.js","mtime":1616639576682}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIkM6L1VzZXJzL1x1NTQzNFx1NUVGQVx1NjYwRS9EZXNrdG9wL1Zpc3VhbGl6YXRpb25FeGNsZV9EZW1vL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9zbGljZWRUb0FycmF5IjsKaW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJDOi9Vc2Vycy9cdTU0MzRcdTVFRkFcdTY2MEUvRGVza3RvcC9WaXN1YWxpemF0aW9uRXhjbGVfRGVtby9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5yZWR1Y2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuY29uc3RydWN0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5qb2luLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CgovKioNCiAgZm9ybXVsYToNCiAgICBrZXkNCiAgICB0aXRsZQ0KICAgIHJlbmRlcg0KKi8KCi8qKg0KICogQHR5cGVkZWYge29iamVjdH0gRm9ybXVsYQ0KICogQHByb3BlcnR5IHtzdHJpbmd9IGtleQ0KICogQHByb3BlcnR5IHtmdW5jdGlvbn0gdGl0bGUNCiAqIEBwcm9wZXJ0eSB7ZnVuY3Rpb259IHJlbmRlcg0KICovCmltcG9ydCB7IHRmIH0gZnJvbSAnLi4vbG9jYWxlL2xvY2FsZSc7CmltcG9ydCB7IG51bWJlckNhbGMgfSBmcm9tICcuL2hlbHBlcic7Ci8qKiBAdHlwZSB7Rm9ybXVsYVtdfSAqLwoKdmFyIGJhc2VGb3JtdWxhcyA9IFt7CiAga2V5OiAnU1VNJywKICB0aXRsZTogdGYoJ2Zvcm11bGEuc3VtJyksCiAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoYXJ5KSB7CiAgICByZXR1cm4gYXJ5LnJlZHVjZShmdW5jdGlvbiAoYSwgYikgewogICAgICByZXR1cm4gbnVtYmVyQ2FsYygnKycsIGEsIGIpOwogICAgfSwgMCk7CiAgfQp9LCB7CiAga2V5OiAnQVZFUkFHRScsCiAgdGl0bGU6IHRmKCdmb3JtdWxhLmF2ZXJhZ2UnKSwKICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihhcnkpIHsKICAgIHJldHVybiBhcnkucmVkdWNlKGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgIHJldHVybiBOdW1iZXIoYSkgKyBOdW1iZXIoYik7CiAgICB9LCAwKSAvIGFyeS5sZW5ndGg7CiAgfQp9LCB7CiAga2V5OiAnTUFYJywKICB0aXRsZTogdGYoJ2Zvcm11bGEubWF4JyksCiAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoYXJ5KSB7CiAgICByZXR1cm4gTWF0aC5tYXguYXBwbHkoTWF0aCwgX3RvQ29uc3VtYWJsZUFycmF5KGFyeS5tYXAoZnVuY3Rpb24gKHYpIHsKICAgICAgcmV0dXJuIE51bWJlcih2KTsKICAgIH0pKSk7CiAgfQp9LCB7CiAga2V5OiAnTUlOJywKICB0aXRsZTogdGYoJ2Zvcm11bGEubWluJyksCiAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoYXJ5KSB7CiAgICByZXR1cm4gTWF0aC5taW4uYXBwbHkoTWF0aCwgX3RvQ29uc3VtYWJsZUFycmF5KGFyeS5tYXAoZnVuY3Rpb24gKHYpIHsKICAgICAgcmV0dXJuIE51bWJlcih2KTsKICAgIH0pKSk7CiAgfQp9LCB7CiAga2V5OiAnSUYnLAogIHRpdGxlOiB0ZignZm9ybXVsYS5faWYnKSwKICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihfcmVmKSB7CiAgICB2YXIgX3JlZjIgPSBfc2xpY2VkVG9BcnJheShfcmVmLCAzKSwKICAgICAgICBiID0gX3JlZjJbMF0sCiAgICAgICAgdCA9IF9yZWYyWzFdLAogICAgICAgIGYgPSBfcmVmMlsyXTsKCiAgICByZXR1cm4gYiA/IHQgOiBmOwogIH0KfSwgewogIGtleTogJ0FORCcsCiAgdGl0bGU6IHRmKCdmb3JtdWxhLmFuZCcpLAogIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKGFyeSkgewogICAgcmV0dXJuIGFyeS5ldmVyeShmdW5jdGlvbiAoaXQpIHsKICAgICAgcmV0dXJuIGl0OwogICAgfSk7CiAgfQp9LCB7CiAga2V5OiAnT1InLAogIHRpdGxlOiB0ZignZm9ybXVsYS5vcicpLAogIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKGFyeSkgewogICAgcmV0dXJuIGFyeS5zb21lKGZ1bmN0aW9uIChpdCkgewogICAgICByZXR1cm4gaXQ7CiAgICB9KTsKICB9Cn0sIHsKICBrZXk6ICdDT05DQVQnLAogIHRpdGxlOiB0ZignZm9ybXVsYS5jb25jYXQnKSwKICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihhcnkpIHsKICAgIHJldHVybiBhcnkuam9pbignJyk7CiAgfQp9Ci8qIHN1cHBvcnQ6ICAxICsgQTEgKyBCMiAqIDMNCnsNCiAga2V5OiAnRElWSURFJywNCiAgdGl0bGU6IHRmKCdmb3JtdWxhLmRpdmlkZScpLA0KICByZW5kZXI6IGFyeSA9PiBhcnkucmVkdWNlKChhLCBiKSA9PiBOdW1iZXIoYSkgLyBOdW1iZXIoYikpLA0KfSwNCnsNCiAga2V5OiAnUFJPRFVDVCcsDQogIHRpdGxlOiB0ZignZm9ybXVsYS5wcm9kdWN0JyksDQogIHJlbmRlcjogYXJ5ID0+IGFyeS5yZWR1Y2UoKGEsIGIpID0+IE51bWJlcihhKSAqIE51bWJlcihiKSwxKSwNCn0sDQp7DQogIGtleTogJ1NVQlRSQUNUJywNCiAgdGl0bGU6IHRmKCdmb3JtdWxhLnN1YnRyYWN0JyksDQogIHJlbmRlcjogYXJ5ID0+IGFyeS5yZWR1Y2UoKGEsIGIpID0+IE51bWJlcihhKSAtIE51bWJlcihiKSksDQp9LA0KKi8KXTsKdmFyIGZvcm11bGFzID0gYmFzZUZvcm11bGFzOyAvLyBjb25zdCBmb3JtdWxhcyA9IChmb3JtdWxhQXJ5ID0gW10pID0+IHsKLy8gICBjb25zdCBmb3JtdWxhTWFwID0ge307Ci8vICAgYmFzZUZvcm11bGFzLmNvbmNhdChmb3JtdWxhQXJ5KS5mb3JFYWNoKChmKSA9PiB7Ci8vICAgICBmb3JtdWxhTWFwW2Yua2V5XSA9IGY7Ci8vICAgfSk7Ci8vICAgcmV0dXJuIGZvcm11bGFNYXA7Ci8vIH07Cgp2YXIgZm9ybXVsYW0gPSB7fTsKYmFzZUZvcm11bGFzLmZvckVhY2goZnVuY3Rpb24gKGYpIHsKICBmb3JtdWxhbVtmLmtleV0gPSBmOwp9KTsKZXhwb3J0IGRlZmF1bHQge307CmV4cG9ydCB7IGZvcm11bGFtLCBmb3JtdWxhcywgYmFzZUZvcm11bGFzIH07"},{"version":3,"sources":["C:/Users/吴建明/Desktop/VisualizationExcle_Demo/src/components/x-spreadsheet/core/formula.js"],"names":["tf","numberCalc","baseFormulas","key","title","render","ary","reduce","a","b","Number","length","Math","max","map","v","min","t","f","every","it","some","join","formulas","formulam","forEach"],"mappings":"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","sourcesContent":["/**\r\n  formula:\r\n    key\r\n    title\r\n    render\r\n*/\r\n/**\r\n * @typedef {object} Formula\r\n * @property {string} key\r\n * @property {function} title\r\n * @property {function} render\r\n */\r\nimport { tf } from '../locale/locale';\r\nimport { numberCalc } from './helper';\r\n\r\n/** @type {Formula[]} */\r\nconst baseFormulas = [\r\n  {\r\n    key: 'SUM',\r\n    title: tf('formula.sum'),\r\n    render: ary => ary.reduce((a, b) => numberCalc('+', a, b), 0),\r\n  },\r\n  {\r\n    key: 'AVERAGE',\r\n    title: tf('formula.average'),\r\n    render: ary => ary.reduce((a, b) => Number(a) + Number(b), 0) / ary.length,\r\n  },\r\n  {\r\n    key: 'MAX',\r\n    title: tf('formula.max'),\r\n    render: ary => Math.max(...ary.map(v => Number(v))),\r\n  },\r\n  {\r\n    key: 'MIN',\r\n    title: tf('formula.min'),\r\n    render: ary => Math.min(...ary.map(v => Number(v))),\r\n  },\r\n  {\r\n    key: 'IF',\r\n    title: tf('formula._if'),\r\n    render: ([b, t, f]) => (b ? t : f),\r\n  },\r\n  {\r\n    key: 'AND',\r\n    title: tf('formula.and'),\r\n    render: ary => ary.every(it => it),\r\n  },\r\n  {\r\n    key: 'OR',\r\n    title: tf('formula.or'),\r\n    render: ary => ary.some(it => it),\r\n  },\r\n  {\r\n    key: 'CONCAT',\r\n    title: tf('formula.concat'),\r\n    render: ary => ary.join(''),\r\n  },\r\n  /* support:  1 + A1 + B2 * 3\r\n  {\r\n    key: 'DIVIDE',\r\n    title: tf('formula.divide'),\r\n    render: ary => ary.reduce((a, b) => Number(a) / Number(b)),\r\n  },\r\n  {\r\n    key: 'PRODUCT',\r\n    title: tf('formula.product'),\r\n    render: ary => ary.reduce((a, b) => Number(a) * Number(b),1),\r\n  },\r\n  {\r\n    key: 'SUBTRACT',\r\n    title: tf('formula.subtract'),\r\n    render: ary => ary.reduce((a, b) => Number(a) - Number(b)),\r\n  },\r\n  */\r\n];\r\n\r\nconst formulas = baseFormulas;\r\n\r\n// const formulas = (formulaAry = []) => {\r\n//   const formulaMap = {};\r\n//   baseFormulas.concat(formulaAry).forEach((f) => {\r\n//     formulaMap[f.key] = f;\r\n//   });\r\n//   return formulaMap;\r\n// };\r\nconst formulam = {};\r\nbaseFormulas.forEach((f) => {\r\n  formulam[f.key] = f;\r\n});\r\n\r\nexport default {\r\n};\r\n\r\nexport {\r\n  formulam,\r\n  formulas,\r\n  baseFormulas,\r\n};\r\n"]}]}