{"remainingRequest":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\components\\TestExcel.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\components\\TestExcel.vue","mtime":1615365285204},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615364186494},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\babel-loader\\lib\\index.js","mtime":1615364186192},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615364186494},{"path":"C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1615364197433}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6L1VzZXJzL1x1NTQzNFx1NUVGQVx1NjYwRS9EZXNrdG9wL1Zpc3VhbGl6YXRpb25FeGNsZV9EZW1vL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCBTcHJlYWRzaGVldCBmcm9tICdAL2NvbXBvbmVudHMveC1zcHJlYWRzaGVldCc7CmltcG9ydCBYU3R5bGUgZnJvbSAneGxzeC1zdHlsZSc7CmltcG9ydCBFeGNoYW5nZSBmcm9tICdAL3V0aWwveGxzeC1leGNoYW5nZSc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiVGVzdEV4Y2VsIiwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX3RoaXMuaW5zdGFudGlhdGVTaGVldCgpOwoKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlKTsKICAgIH0pKSgpOwogIH0sCiAgbWV0aG9kczogewogICAgcmVxdWVzdEV4Y2xlU3RyZWFtOiBmdW5jdGlvbiByZXF1ZXN0RXhjbGVTdHJlYW0oKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgYXhpb3MoewogICAgICAgIG1ldGhvZDogJ2dldCcsCiAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDA2L2V4Y2VsRXhwb3J0JywKICAgICAgICByZXNwb25zZVR5cGU6ICdibG9iJwogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICB2YXIgc2VsZiA9IF90aGlzMjsKICAgICAgICB2YXIgcmVzdWx0ID0gcmVzLmRhdGE7CiAgICAgICAgY29uc29sZS5sb2coJ3Jlc3VsdCcsIHJlc3VsdCk7IC8vIGRlYnVnZ2VyCgogICAgICAgIF90aGlzMi5mbG9iRmlsZVNpemUgPSByZXN1bHQuc2l6ZSB8fCAwOwoKICAgICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgQmxvYikgewogICAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CgogICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHZhciBkYXRhID0gZS50YXJnZXQucmVzdWx0OwogICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTsKCiAgICAgICAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgICAgICAgdmFyIHdvcmtib29rID0gWFN0eWxlLnJlYWQoZGF0YSwgewogICAgICAgICAgICAgICAgdHlwZTogImJpbmFyeSIsCiAgICAgICAgICAgICAgICBjZWxsU3R5bGVzOiB0cnVlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgdmFyIG91dCA9IEV4Y2hhbmdlLnN0b3god29ya2Jvb2spOwogICAgICAgICAgICAgIHNlbGYuc2V0WHNoZWV0RGF0YShvdXQpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHNlbGYuc2V0WHNoZWV0RGF0YShbXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CgogICAgICAgICAgcmVhZGVyLnJlYWRBc0JpbmFyeVN0cmluZyhyZXN1bHQpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzZWxmLnNldFhzaGVldERhdGEoW10pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgLy8g6K6+572ueHNoZWV0IOaVsOaNrgogICAgc2V0WHNoZWV0RGF0YTogZnVuY3Rpb24gc2V0WHNoZWV0RGF0YShvdXQpIHsKICAgICAgdGhpcy5zaGVldC5sb2FkRGF0YShvdXQpOwoKICAgICAgaWYgKG91dC5sZW5ndGgpIHsKICAgICAgICB2YXIgY29sTGVuID0gT2JqZWN0LmtleXMob3V0WzBdLnJvd3NbMF0uY2VsbHMpLmxlbmd0aCB8fCAxMDsgLy8gbGV0IGNvbExlbiA9IHRoaXMuZ2V0VGFibGVDb2xMZW4ob3V0KSB8fCAxMDsKCiAgICAgICAgdmFyIHJvd0xlbiA9IE9iamVjdC5rZXlzKG91dFswXS5yb3dzKS5sZW5ndGggfHwgMTA7CiAgICAgICAgdGhpcy5zaGVldC5zaGVldC5kYXRhLnJvd3MubGVuID0gcm93TGVuOwogICAgICAgIHRoaXMuc2hlZXQuc2hlZXQuZGF0YS5jb2xzLmxlbiA9IGNvbExlbjsKICAgICAgICB0aGlzLnNoZWV0LnJlUmVuZGVyKCk7CiAgICAgIH0KICAgIH0sCiAgICAvLyDlrp7kvovljJYgeHNoZWV0CiAgICBpbnN0YW50aWF0ZVNoZWV0OiBmdW5jdGlvbiBpbnN0YW50aWF0ZVNoZWV0KCkgewogICAgICB2YXIgcXVlcnlMaXN0SGVpZ2h0ID0gMDsKICAgICAgaWYgKHRoaXMuJHJlZnMucXVlcnlMaXN0KSBxdWVyeUxpc3RIZWlnaHQgPSB0aGlzLiRyZWZzLnF1ZXJ5TGlzdC4kZWwub2Zmc2V0SGVpZ2h0IHx8IDA7CiAgICAgIHRoaXMuc2hlZXQgPSBuZXcgU3ByZWFkc2hlZXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInhzcy1kZW1vIiksIHsKICAgICAgICBtb2RlOiAicmVhZCIsCiAgICAgICAgLy8gZWRpdCB8IHJlYWQKICAgICAgICBzaG93VG9vbGJhcjogZmFsc2UsCiAgICAgICAgc2hvd0dyaWQ6IGZhbHNlLAogICAgICAgIHNob3dDb250ZXh0bWVudTogZmFsc2UsCiAgICAgICAgdmlldzogewogICAgICAgICAgaGVpZ2h0OiBmdW5jdGlvbiBoZWlnaHQoKSB7CiAgICAgICAgICAgIHJldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gMTgwIC0gcXVlcnlMaXN0SGVpZ2h0OwogICAgICAgICAgfSwKICAgICAgICAgIHdpZHRoOiBmdW5jdGlvbiB3aWR0aCgpIHsKICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCAtIDMwMDsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHJvdzogewogICAgICAgICAgaGVpZ2h0OiAyNSwKICAgICAgICAgIGxlbjogMTAwCiAgICAgICAgfSwKICAgICAgICBjb2w6IHsKICAgICAgICAgIGxlbjogMTYsCiAgICAgICAgICB3aWR0aDogMTAwLAogICAgICAgICAgaW5kZXhXaWR0aDogNjAsCiAgICAgICAgICBtaW5XaWR0aDogNjAKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"sources":["C:\\Users\\吴建明\\Desktop\\VisualizationExcle_Demo\\src\\components\\TestExcel.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div>\r\n    <button class=\"btn\" @click=\"requestExcleStream\">测试</button>\r\n    <div class=\"content\">\r\n      <div id=\"xss-demo\" />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport Spreadsheet from '@/components/x-spreadsheet';\r\nimport XStyle from 'xlsx-style';\r\nimport Exchange from '@/util/xlsx-exchange';\r\nexport default {\r\n  name: \"TestExcel\",\r\n  async mounted() {\r\n    this.instantiateSheet();\r\n  },\r\n  methods: {\r\n    requestExcleStream() {\r\n      axios({\r\n        method: 'get',\r\n        url: 'http://localhost:3006/excelExport',\r\n        responseType: 'blob'\r\n      }).then((res) => {\r\n        const self = this\r\n        const result = res.data\r\n        console.log('result', result)\r\n        // debugger\r\n        this.flobFileSize = result.size || 0;\r\n        if (result instanceof Blob) {\r\n          var reader = new FileReader();\r\n          reader.onload = function (e) {\r\n            let data = e.target.result;\r\n            console.log(data)\r\n            if (data) {\r\n              let workbook = XStyle.read(data, { type: \"binary\", cellStyles: true });\r\n              let out = Exchange.stox(workbook);\r\n              self.setXsheetData(out)\r\n            } else {\r\n              self.setXsheetData([])\r\n            }\r\n          };\r\n          reader.readAsBinaryString(result);\r\n        } else {\r\n          self.setXsheetData([])\r\n        }\r\n      })\r\n    },\r\n    // 设置xsheet 数据\r\n    setXsheetData(out) {\r\n      this.sheet.loadData(out);\r\n      if (out.length) {\r\n        let colLen = Object.keys(out[0].rows[0].cells).length || 10;\r\n        // let colLen = this.getTableColLen(out) || 10;\r\n        let rowLen = Object.keys(out[0].rows).length || 10;\r\n        this.sheet.sheet.data.rows.len = rowLen;\r\n        this.sheet.sheet.data.cols.len = colLen;\r\n        this.sheet.reRender();\r\n      }\r\n    },\r\n    // 实例化 xsheet\r\n    instantiateSheet() {\r\n      let queryListHeight = 0;\r\n      if (this.$refs.queryList)\r\n        queryListHeight = this.$refs.queryList.$el.offsetHeight || 0;\r\n      this.sheet = new Spreadsheet(document.getElementById(\"xss-demo\"), {\r\n        mode: \"read\", // edit | read\r\n        showToolbar: false,\r\n        showGrid: false,\r\n        showContextmenu: false,\r\n        view: {\r\n          height: () =>\r\n            document.documentElement.clientHeight - 180 - queryListHeight,\r\n          width: () => document.documentElement.clientWidth - 300,\r\n        },\r\n        row: {\r\n          height: 25,\r\n          len: 100,\r\n        },\r\n        col: {\r\n          len: 16,\r\n          width: 100,\r\n          indexWidth: 60,\r\n          minWidth: 60,\r\n        },\r\n      });\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.btn {\r\n  width: 100px;\r\n  height: 36px;\r\n  cursor: pointer;\r\n}\r\n</style>"],"sourceRoot":""}]}